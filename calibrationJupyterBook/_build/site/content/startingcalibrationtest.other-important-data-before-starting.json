{"version":2,"kind":"Notebook","sha256":"0377d8c5d674036f27cad6c655a6a09418158a91633fc71b56ba6f3650c9497c","slug":"startingcalibrationtest.other-important-data-before-starting","location":"/StartingCalibrationTest/5.Other_important_data_before_starting.ipynb","dependencies":[],"frontmatter":{"title":"Other data needed for the calibration process","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Clément Hardy, PhD.","given":"PhD.","family":"Clément Hardy"},"name":"Clément Hardy, PhD.","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/Klemet/Calibration_PnET_DIVERSE","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/Klemet/Calibration_PnET_DIVERSE/blob/main/calibrationJupyterBook_JupyterBookv2/StartingCalibrationTest/5.Other_important_data_before_starting.ipynb","thumbnail":"/Algorithm_GrowthCurv-1fc0881c4e6f16c0991a3c4f2866d3c5.png","exports":[{"format":"ipynb","filename":"5.Other_important_data_before_starting.ipynb","url":"/5.Other_important_da-3096b6b1aff7ea07ce90e6471f8d3ab3.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here, I catalog the other data needed for the calibration process, that is not the initial parameter values we will be using (for this, see ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DsCXUlSONk"},{"type":"link","url":"/startingcalibrationtest/initial-species-parameters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Lem8l2fkm6"}],"urlSource":"./3.Initial_Species_Parameters.ipynb","dataUrl":"/startingcalibrationtest.initial-species-parameters.json","internal":true,"protocol":"file","key":"VkpbjehOfc"},{"type":"text","value":") or the climate and soil data used in the simulations for the calibration (see ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kyE6QphakC"},{"type":"link","url":"/startingcalibrationtest/setting-up-calibration-landscape","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SGSp345Ujb"}],"urlSource":"./4.Setting_up_calibration_Landscape.ipynb","dataUrl":"/startingcalibrationtest.setting-up-calibration-landscape.json","internal":true,"protocol":"file","key":"Ul4SFTCrrt"},{"type":"text","value":").","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TiSSOHuLa3"}],"key":"BKpGAsLOVT"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This other data will be used to :","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cBTKW2pE1J"}],"key":"u6kXngPaKZ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Target values to match during the calibration (e.g. biomass growth curves)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bjMDmta9dC"}],"key":"midXhTrKdC"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Determiner the value of some parameters directly (e.g. maximum longevity)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"yA7FpzpmRT"}],"key":"sEk3Wv7rzA"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Establish ranges of parameter values in which we should remain during the calibration","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"f4rYJzBGJQ"}],"key":"fZ9q4Aq5sB"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Target outcomes of simulations (e.g. competition outcomes, climate change outcomes, etc.)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"iq7b4WY2me"}],"key":"esbDN7T22W"}],"key":"olcSjdNzY4"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"I will write here as much suggestions a possible for future researchers that will want to calibrate for their own research or study area, but I will also indicate what I will be using in these notebooks.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"nC5UYxk7tM"}],"key":"m6Tuu05z3h"}],"visibility":"show","key":"Qz89DRONhf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Empirical data for biomass growth curves.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HDmQciwcpD"}],"identifier":"empirical-data-for-biomass-growth-curves","label":"Empirical data for biomass growth curves.","html_id":"empirical-data-for-biomass-growth-curves","implicit":true,"key":"XCrn01hDiy"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This is an essential part of the calibration process, especially the first step in which we will calibrate each species in “ideal” conditions of growth (mild climate, good soil water retention, etc.). These “ideal” conditions are important to isolate the effect of other parameters and other sources of mortality, so that you can focus on the basic parameters of growth and senescence for your species (see ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"d88LvuqaXF"},{"type":"link","url":"/startingcalibrationtest/monoculture-ideal-conditions","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TNtcEjyTbz"}],"urlSource":"./6.Monoculture_ideal_conditions.ipynb","dataUrl":"/startingcalibrationtest.monoculture-ideal-conditions.json","internal":true,"protocol":"file","key":"LlVrrfoh50"},{"type":"text","value":").","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"p8nAiv3vPT"}],"key":"LCcHA7OMPv"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Basically, what you want is data that allows you to infer a biomass growth curve for each given species, showing the evolution of the biomass of a cohort for the species in conditions that are as ideal as possible.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FIQr65prj7"}],"key":"MUYPHeoxii"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"As of today, I’ve ran accross three different strategies to get this data. I’ll describe them in the following sections.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vsxFMSLnJ1"}],"key":"nct7kjAJG5"},{"type":"heading","depth":4,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Option 1 : Sample plot data.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"P3q1bUmX0a"}],"identifier":"option-1-sample-plot-data","label":"Option 1 : Sample plot data.","html_id":"option-1-sample-plot-data","implicit":true,"key":"RebfIaxHFN"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"By looking at individual tree data from sample plot data, you can infer tree biomass and tree age, making each tree or plot a point on your graph.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"nxcwvVs0rg"}],"key":"txG9YlgZrt"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"By looking at the points that are at the top of the cloud of points that will result, you can get and idea of the maximum biomass a tree can reach for a given age, which should give you good information about the growth curve. This is a method used by many research so far.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"TamajTCKhC"}],"key":"o8eXuViMAk"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The problem is that sample plot data is often messy, full of outliers, biases, needing sharing agrements, etc. As such, it will require important work to clean, and several important assumptions will influence your results enormously. For example, the “tree age” data is often missing, and you’ll have to infer it from DBH; and you’ll also have to choose how to translate your individual tree biomass into biomass/surface (as all LANDIS-II biomass output is interpreted in biomass/surface, not biomass/tree).","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"wg2bUgqHZV"}],"key":"VMUZ3QUNM7"},{"type":"heading","depth":4,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Option 2 : Tree growth models.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"lGXQQj4ITX"}],"identifier":"option-2-tree-growth-models","label":"Option 2 : Tree growth models.","html_id":"option-2-tree-growth-models","implicit":true,"key":"X48jcBTIXv"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"These models are complex equations develloped by foresters, industries or governmental agencies to try and predict growth or yield for different species in different conditions. These are often calibrated based on sample plot data; as such, the work of cleaning/dealing with sample plot data is often done for you. An example is the famous ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"QgDRpjU4XM"},{"type":"link","url":"www.fs.usda.gov/fvs/","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Forest Vegetation Simulator","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"tBWxegCiKd"}],"urlSource":"www.fs.usda.gov/fvs/","key":"lxo4bBvOEe"},{"type":"text","value":" from the USDA. Other such models are simply growth curves published in the litterature, sometimes in books.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"ud5lFi3NnS"}],"key":"QPRRhj5cYz"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"The curves produced by these models are often in biomass/surface, which makes things very easy to compare with LANDIS-II outputs. You can also tweak the parameters of these models so that they predict biomass growth in conditions as ideal as possible, making it close to what you’re looking for.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"BvbxcO0lH8"}],"key":"Qur9YZ2B5u"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"The main issue is that these models can still produce pretty unrealistic curves; might not be available for your study area/region; and might still need parameters derived from sample plot data (e.g. Site index and maximum basal area for FVS). So while they can make your life simpler, they can still be difficult to use.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"a7l4JWggPS"}],"key":"cm8Woslmzp"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"FVS can be compiled into a Dockerfile and use in Python; I’ve tried it at first and will keep the functions that I’ve written in a separate document for you to re-use if necessary.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"T9mPw5L6wn"}],"key":"tuxA2Unuho"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Be warned that the decreasing part of the curves produced by these often often don’t include mortality by senescence, which can make the cruve growth forever, making it difficult to identify the biomass peak which is very important for calibration purposes.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"kA7ICtlQDk"}],"key":"HYgbQ1r8W8"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Tree growth models have been used by several research teams, including Brian Sturtevant’s and Eric Gustafson (the latter being the author of the calibration tips for PnET-Succession that are the basis of these documents).","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"sE3tbXrslT"}],"key":"wGNSFYAb0k"},{"type":"heading","depth":4,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Option 3 : Forest inventory data.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"jfind9Yow3"}],"identifier":"option-3-forest-inventory-data","label":"Option 3 : Forest inventory data.","html_id":"option-3-forest-inventory-data","implicit":true,"key":"fxMTD7wXzN"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"Some forest inventories contain data that allow you to infer tree or stand age and the biomass of your species of interest. For example, the ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"GHz45Xqooh"},{"type":"link","url":"https://nfi.nfis.org/en/","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"National Forest Inventory of Canada","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"h0mrBF7RP8"}],"urlSource":"https://nfi.nfis.org/en/","key":"kwa8hZ2lZp"},{"type":"text","value":" proposes raster maps of several forest attributes Canada-wide, including pixel/stand forest age, and the biomass of each individual species that are considered in the forest inventory.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"Lc0GqDuGMk"}],"key":"R9tMQOXz1F"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"If you use each pixel from the maps of a single year as a point and plot a cloud of points on a biomass/time axis, you might get a very good approximation of a growth curve, with a growth peak and a initial growth (the two most important parts in our case). This is, in essence, a ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"YsxLSEU3Qk"},{"type":"cite","url":"https://link.springer.com/chapter/10.1007/978-1-4615-7358-6_5","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"“space-for-time” substitution","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"DTrFHTwE7r"}],"kind":"narrative","label":"Pickett_1989","identifier":"https://link.springer.com/chapter/10.1007/978-1-4615-7358-6_5","enumerator":"1","key":"JGOKC61X8v"},{"type":"text","value":", where you look at many different points in space that will be forests at different stages of growth, rather than looking at the long-term history of a few forests.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"iZ8M8aS58D"}],"key":"o7oGcyxwAi"},{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"The big limitation of this data is that you often get one “stand age” or “pixel age” value per pixel, rather than a separate age value for the trees of a given species in the pixel. As such, in a pixel of 80 years, you cannot know if the biomass of species X comes from trees that are 80 years old, or if these trees are younger. But you can interpret the upper points of the cloud of points as “the maximum biomass that a species can reach for this stand age”, which is pretty close to the mark of what you’re looking for.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"tYGwgEluTm"}],"key":"A2kEQrEvHx"},{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Another big limitation is that in most pixels (if not all), your species will be mixed with other species. This is especially true if you are calibrating a “companion” species (the type of tree species that is never abundant, but yet found in many forests). You can restrict the points of your data to only the pixels where more than 50% of the biomass comes from your species of interest; but you might not get enough points for some rarer species. In these case, you will probably need to develop a correction of biomass to try and have an estimate of the biomass that your species can reach when it composes 100% of the stand. You might do this by making a statistical model that attempts to predict the biomass of your species in a stand or pixel based on the age of the pixel, and the % of composition of the species. You might want to train your statistic model on only the top percentile of points (as you’re looking out for the most biomass your species can achieve for a given age).","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"lsUGCA1KBO"}],"key":"t1POnNAKq1"},{"type":"paragraph","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"This data is often generated through a combination of forest inventory sampling (aerial photography, etc.) and sample plot data (which are assignated to stand or pixels via assignation algorithms like the kNN method). As such, it often contains information from sample plots, but which has already been cleaned and dealt with.","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"V3YYC3oP6j"}],"key":"ydpCukFakR"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"The biomass data is often expressed in biomass/surface, making it easy to compare to LANDIS-II outputs.","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"Hb0qO9yTI5"}],"key":"FJccm4Q3Tg"},{"type":"paragraph","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"This is the data I will be using here. From what I heard, other teams have been using such data in the past.","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"JebdXLft7G"}],"key":"cubGfldD1b"}],"key":"E3nlOwwEL9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Option used here : data from the National Forest Inventory of Canada","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UbkUXR76Bb"}],"identifier":"option-used-here-data-from-the-national-forest-inventory-of-canada","label":"Option used here : data from the National Forest Inventory of Canada","html_id":"option-used-here-data-from-the-national-forest-inventory-of-canada","implicit":true,"key":"ux6Aun7LQF"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"See :","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"q31Wt0htYW"}],"key":"SHdGLpSS3c"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"link","url":"https://nfi.nfis.org/en/","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[],"urlSource":"https://nfi.nfis.org/en/","key":"kUYY7B3sVu"},{"type":"text","value":" for general information and visualisation of some of the maps","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"TGzc3dqprl"}],"key":"tps5FGpIOw"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://open.canada.ca/data/en/dataset/ec9e2659-1c29-4ddb-87a2-6aced147a990","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[],"urlSource":"https://open.canada.ca/data/en/dataset/ec9e2659-1c29-4ddb-87a2-6aced147a990","key":"HmWNLBqFh3"},{"type":"text","value":" to download the maps","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QlHVt8cZ6n"}],"key":"LiciC7z4su"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"cite","url":"https://cdnsciencepub.com/doi/10.1139/cjfr-2017-0184","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Beaudoin ","key":"wQAXve7Wc2"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"qLMjyUW7mB"}],"key":"vH1OzaZCq9"},{"type":"text","value":" (2018)","key":"ekOZyDeSmI"}],"kind":"narrative","label":"Beaudoin_2018","identifier":"https://cdnsciencepub.com/doi/10.1139/cjfr-2017-0184","enumerator":"2","key":"wWiv5rggIO"},{"type":"text","value":" for details about how the maps were generated.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jzzDjBxOUM"}],"key":"j3ljr3mBfo"}],"key":"OUp8Lrufny"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Here, I’m using data from the most recent year (2011). I’m using the map ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"T1gzE8KqoU"},{"type":"inlineCode","value":"/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"sBg4YPnlsr"},{"type":"text","value":" for the stand (pixel) ages; ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"SOw8iLS4di"},{"type":"inlineCode","value":"/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"NgXfeNoEsr"},{"type":"text","value":" for biomass of stands; and a series of rasters like ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"E6FzSNwwi8"},{"type":"inlineCode","value":"/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Abie_Bal_v1.tif","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"LIqlvSICWo"},{"type":"text","value":" that indicate the propotion of ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"KXhQ0K1mUh"},{"type":"inlineCode","value":"/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"kFDoMCw698"},{"type":"text","value":" that corresponds to the species of interest (e.g. ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"EEVPXSE87p"},{"type":"emphasis","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"pLV1bjRgCw"}],"key":"l2Lj6vUHoC"},{"type":"text","value":" in that case). All maps are currently in ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ntetheYYOe"},{"type":"inlineCode","value":"./ReferencesAndData","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"TSKcJ1MUwk"},{"type":"text","value":".","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"sWjhDiAn2t"}],"key":"TLWZPH87dF"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"I’m also using several “mask” rasters to restrict or differenciate the pixel data from different provinces in Canada (e.g. ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"IYg7cK33Th"},{"type":"inlineCode","value":"quebecMask.tif","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"lyUl0FWEwb"},{"type":"text","value":", etc., all in ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Nb00erfyVf"},{"type":"inlineCode","value":"./ReferencesAndData","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"sOSWwZkG0e"},{"type":"text","value":").","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"vDj3AzDzeo"}],"key":"SnCWvDEK7K"}],"key":"pER07y5fdY"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here, before we use this dataset, I quickly show how it looks like by focusing on the highest points of the point clouds that it produces. Focusing on these highest points will give us an idea of the “best growth” that the species can achieve through by looking at different pixels from the same year throughout all of Canada.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gRiUNUFTrl"}],"key":"moMiZiwClT"}],"key":"GTHxRJeQQK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# We read data from the NFI for our free species, and plot the distribution of the points above 95% of the maximum value in\n# each 3 years window (which allows us to keep the top points)\nfrom functionsForCalibration import *\nimport matplotlib.pyplot as plt\n\n\n# We define the path to where the rasters are\nspecies_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Abie_Bal_v1.tif\"\nage_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif\"\nbiomass_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif\"\n# We define the paths to the mask rasters for each province\ndictOfMasks = {\"NS\":\"./ReferencesAndData/SpatialBoundaries/novaScotiaMask.tif\",\n              \"QC\":\"./ReferencesAndData/SpatialBoundaries/quebecMask.tif\",\n              \"ON\":\"./ReferencesAndData/SpatialBoundaries/ontarioMask.tif\",\n              \"MT\":\"./ReferencesAndData/SpatialBoundaries/manitobaMask.tif\",\n              \"SK\":\"./ReferencesAndData/SpatialBoundaries/saskatchewanMask.tif\",\n              \"AB\":\"./ReferencesAndData/SpatialBoundaries/albertaMask.tif\",\n              \"BC\":\"./ReferencesAndData/SpatialBoundaries/britishColumbiaMask.tif\",}\n\n\nplottingNFISpeciesUpperBiomassByProvince(species_path,\n                                         age_path,\n                                         biomass_path,\n                                         \"Abies balsamea\",\n                                         dictOfMasks)","key":"MaYsd4uGuE"},{"type":"output","id":"4aBYUNVrvovFCHHLAq6N4","data":[{"name":"stdout","output_type":"stream","text":"Reading species raster...\nReading age raster...\nReading biomass raster...\nDealing with NS\n"},{"name":"stderr","output_type":"stream","text":"/usr/local/lib/python3.10/dist-packages/numpy/ma/core.py:1020: RuntimeWarning: overflow encountered in multiply\n  result = self.f(da, db, *args, **kwargs)\n"},{"name":"stdout","output_type":"stream","text":"Dealing with QC\nDealing with ON\nDealing with MT\nDealing with SK\nDealing with AB\nDealing with BC\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"99c0650e6247135da6ad41df1b934932","path":"/99c0650e6247135da6ad41df1b934932.png"},"text/plain":{"content":"<Figure size 1000x800 with 1 Axes>","content_type":"text/plain"}}}],"key":"QH48sujiDi"}],"key":"slTz6mrgV0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As such, we can see that :","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VWiEqBLZFj"}],"key":"kIxyTEyUob"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The NFI data shows some pretty clear growth patterns (initial growth, peak, senescence)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"V8WgFV6jsw"}],"key":"Mba5WXzKRJ"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We see that the different provinces can have very different growth peaks and initial growth/senescence. Upon closer inspection (plotting again but only for points with at least 50% of biomass composed of ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"pTuFiiZL1j"},{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"www7j9cVo8"}],"key":"lhqcKkyI2a"},{"type":"text","value":"), it seems to mostly be due to the differences in the mixture/competition of the species in difference province. SK, AB, MT and BC don’t have many points where ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"nQbOgb15XV"},{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"VBM5Q8ygvH"}],"key":"tLvz26SK5m"},{"type":"text","value":" is dominant. Meanwhile, NS, QC and ON have a lot of it.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"tRq5ePrTQl"}],"key":"EPjiCLZ2lS"}],"key":"iFTbAs4bBP"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Now, here are the same figures for the other species :","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"IIMg1GSkBc"}],"key":"WqvOLyyg0K"}],"key":"Y7B0vmelbN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# We define the path to where the rasters are\nspecies_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Pice_Mar_v1.tif\"\nage_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif\"\nbiomass_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif\"\n\nplottingNFISpeciesUpperBiomassByProvince(species_path,\n                                         age_path,\n                                         biomass_path,\n                                         \"Acer rubrum\",\n                                         dictOfMasks)","key":"t9B6k9bEGh"},{"type":"output","id":"p55jeUsktMljDmiqtvCJB","data":[{"name":"stdout","output_type":"stream","text":"Reading species raster...\nReading age raster...\nReading biomass raster...\nDealing with NS\nDealing with QC\nDealing with ON\nDealing with MT\nDealing with SK\nDealing with AB\nDealing with BC\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6e3bd5072c7a270d1a580b23f221aff8","path":"/6e3bd5072c7a270d1a580b23f221aff8.png"},"text/plain":{"content":"<Figure size 1000x800 with 1 Axes>","content_type":"text/plain"}}}],"key":"TVYyNUqTjd"}],"key":"AzitWWQECM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# We define the path to where the rasters are\nspecies_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Acer_Rub_v1.tif\"\nage_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif\"\nbiomass_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif\"\n\nplottingNFISpeciesUpperBiomassByProvince(species_path,\n                                         age_path,\n                                         biomass_path,\n                                         \"Picea mariana\",\n                                         dictOfMasks)","key":"vXLryDKLpc"},{"type":"output","id":"60IyfYynrYEY4cjEAgEyr","data":[{"name":"stdout","output_type":"stream","text":"Reading species raster...\nReading age raster...\nReading biomass raster...\nDealing with NS\nDealing with QC\nDealing with ON\nDealing with MT\nDealing with SK\nDealing with AB\nDealing with BC\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"dd07370cc1ad32d4816e922c5ccee6f2","path":"/dd07370cc1ad32d4816e922c5ccee6f2.png"},"text/plain":{"content":"<Figure size 1000x800 with 1 Axes>","content_type":"text/plain"}}}],"key":"iVFcfMnXMx"}],"key":"tipG8u6WrU"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can again see some pretty clear patterns for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"suuHrYVvK1"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dOvvxvivQF"}],"key":"NCEpXYMBsY"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RzsqbCXLmq"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Picea mariana","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CBx52PHkqW"}],"key":"OTUGOhtASN"},{"type":"text","value":". As such, this dataset should do.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"InAOe9K1Y7"}],"key":"k2mMpGIblZ"}],"key":"CqmW3USs99"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves in ideal conditions (in Canada) for our species with NFI data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rS5Upu9lM5"}],"identifier":"producing-estimated-growth-curves-in-ideal-conditions-in-canada-for-our-species-with-nfi-data","label":"Producing estimated growth curves in ideal conditions (in Canada) for our species with NFI data","html_id":"producing-estimated-growth-curves-in-ideal-conditions-in-canada-for-our-species-with-nfi-data","implicit":true,"key":"XYKnKNUGeB"}],"key":"eeXIwHZSeC"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Based on the NFI data shown and explored in the previous section, we now have to produce estimated growth curves based on this data that we will be able to use as a “target” for the first step of the calibration of PnET-Succession, where we will try to match the curves produced by PnET-Succession with the data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p1B0avP5Kx"}],"key":"qY9pKcKAmW"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We could of course simply plot the curves produced by PnET-Succession onto the data points directly, and estimate visually if the fit is good. But I prefer to produce curves that we can use to automatize the calibration process (with a curve, we can compute the difference between the PnET-Succession curve and the one we have from the data).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XevRBMaruP"}],"key":"uHKRwskYVe"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"I’ve ended up making two sets of curves with two different methods :","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Lg33D0rcJf"}],"key":"Z4CkurLqcu"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The first one is a simple algorithm that builds a curve based on a set of rules to go from data point to data point, and then smooth the curve.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jsPG80xMfM"}],"key":"rkmOQYYnuW"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"The second one uses a Generalized Additive Model (GAM) fitted on pre-processed data. The GAM is then used to generate curves of biomass for different levels of abundance.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"TYEXm23LZ1"}],"key":"oQTb6IbUaw"}],"key":"cEzcoIWIRt"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"In the next sections, I’ll briefly describe both methods and show the curves produced by each before comparing the curves from both methods.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"T0jDNlZTTL"}],"key":"p0PARy4YNK"}],"key":"tAdfJT7ehx"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing growth curves from NFI data with a simple curve-construction algorithm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GtazqJ1vvV"}],"identifier":"producing-growth-curves-from-nfi-data-with-a-simple-curve-construction-algorithm","label":"Producing growth curves from NFI data with a simple curve-construction algorithm","html_id":"producing-growth-curves-from-nfi-data-with-a-simple-curve-construction-algorithm","implicit":true,"key":"pyEoJk1ng1"}],"visibility":"show","key":"ZeV0cMlSfc"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"I’ve used a relatively simple algorithim to estimate these curves based on the data :","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NfxacUu8s3"}],"key":"lnTEmzQ26o"},{"type":"image","url":"/Algorithm_GrowthCurv-1fc0881c4e6f16c0991a3c4f2866d3c5.png","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"K9kUOOTWhs","urlSource":"./Images/Algorithm_GrowthCurves_NFI.png"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We will save these curves in ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tCmB2WWQBD"},{"type":"inlineCode","value":".csv","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"A9m3jkwo4H"},{"type":"text","value":" files so that we can use them later during the calibration.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Q3wkvyTxV0"}],"key":"G4C71dYKM5"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"To learn more, take a look at the function ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"pgCG96cG7b"},{"type":"inlineCode","value":"analyze_species_growth_curves","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"h9peGsOXCQ"},{"type":"text","value":" in ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mSOqUOLFgx"},{"type":"link","url":"/functionsForCalibrat-a190472a056d25729f0d91b00d14f170.py","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"functionsForCalibration​.py","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"HqZnCXekjT"}],"urlSource":"./functionsForCalibration.py","static":true,"protocol":"file","key":"hzOW6ujU6R"},{"type":"text","value":".","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"y8w11nS9nU"}],"key":"tROl2s7HkR"}],"visibility":"show","key":"LlBJEI5HEg"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"heading","depth":6,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LwVLgULBT3"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Et9fQFDiKJ"}],"key":"KNuO1jUM7D"},{"type":"text","value":" with the curve-construction algorithm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mYOUHDUkqs"}],"identifier":"producing-estimated-growth-curves-for-abies-balsamea-with-the-curve-construction-algorithm","label":"Producing estimated growth curves for Abies balsamea with the curve-construction algorithm","html_id":"producing-estimated-growth-curves-for-abies-balsamea-with-the-curve-construction-algorithm","implicit":true,"key":"ohz71nNBhu"}],"visibility":"show","key":"vXJebNAKSk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from functionsForCalibration import *\n\nresults = analyze_species_growth_curves(\n    prevalence_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Abie_Bal_v1.tif',\n    age_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif',\n    biomass_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif',\n    species_name='Abies balsamea',\n    output_csv_path='./ReferencesAndData/Growth Curves Predictions/abies_balsamea_estimated_growth_curves_NFI.csv',\n    prevalence_thresholds=[100, 80, 60, 40, 20],\n    peak_age_min=0,\n    peak_age_max=100,\n    senescence_age_window=5,\n    outlier_age_window=5,\n    outlier_percentile=100, # Don't remove any outlier for now\n    smoothing_window=200,\n    smoothing_polyorder=5,\n    n_sample_plot=2000000,\n    create_plot=True,\n    plot_figsize=(20, 8)\n)","key":"giAVeKUkmB"},{"type":"output","id":"1-wEOuxlp3CZWJs8YWqkf","data":[{"name":"stdout","output_type":"stream","text":"=== Abies balsamea Growth Curve Analysis with Prevalence Thresholds ===\nParameters:\n  Peak search range: 0-100 years\n  Senescence age window: 5 years\n  Outlier removal: 5-year windows, 100% threshold\n  Smoothing window: 200 points\n  Prevalence thresholds: [100, 80, 60, 40, 20]\nReading raster files...\n✓ Rasters loaded successfully\nProcessing data and applying masks...\n✓ 32674827 valid pixels found\nRemoving outliers (age window: 5 years, percentile: 100%)...\nProcessing 70 age windows...\n"},{"name":"stderr","output_type":"stream","text":"Processing age windows: 100%|██████████████████████████████████████████████████████████| 70/70 [00:03<00:00, 22.67it/s]\n"},{"name":"stdout","output_type":"stream","text":"✓ 32674827 pixels remaining after outlier removal\n\nProcessing curves for each prevalence threshold...\n\n--- Processing threshold 100% ---\n  Threshold 100%: 32674827 points remaining (100.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 100%: 116 raw points, 286 smoothed points\n\n--- Processing threshold 80% ---\n  Threshold 80%: 32638147 points remaining (99.9% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 80%: 119 raw points, 286 smoothed points\n\n--- Processing threshold 60% ---\n  Threshold 60%: 32479798 points remaining (99.4% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 60%: 120 raw points, 286 smoothed points\n\n--- Processing threshold 40% ---\n  Threshold 40%: 31891113 points remaining (97.6% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 40%: 129 raw points, 286 smoothed points\n\n--- Processing threshold 20% ---\n  Threshold 20%: 27611936 points remaining (84.5% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 20%: 121 raw points, 286 smoothed points\n\nCreating CSV output...\n✓ CSV saved to: ./ReferencesAndData/Growth Curves Predictions/abies_balsamea_estimated_growth_curves_NFI.csv\nSampling 2000000 points with prevalence-based weighting...\n✓ Sampled 2000000 points (avg prevalence: 21.8%)\n\nCreating visualization...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cc4cf000457ada919ca0dfabc8fadfd0","path":"/cc4cf000457ada919ca0dfabc8fadfd0.png"},"text/plain":{"content":"<Figure size 2000x800 with 4 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"\n=== Analysis Complete ===\nTotal processing time: 108.3 seconds\nProcessed 32674827 pixels total\nCSV saved to: ./ReferencesAndData/Growth Curves Predictions/abies_balsamea_estimated_growth_curves_NFI.csv\n\nCurve Summary:\n  Threshold ≤20%: Peak 31.11 tons/ha at age 74.0 (27611936 points)\n  Threshold ≤40%: Peak 55.17 tons/ha at age 72.0 (31891113 points)\n  Threshold ≤60%: Peak 73.65 tons/ha at age 71.0 (32479798 points)\n  Threshold ≤80%: Peak 88.76 tons/ha at age 72.0 (32638147 points)\n  Threshold ≤100%: Peak 93.02 tons/ha at age 67.0 (32674827 points)\n"}],"key":"j4wi9wrOfw"}],"key":"vYXfk5kGoF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":6,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dt9LDy4ciP"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RdPLKilOY6"}],"key":"Z5PcCdoASA"},{"type":"text","value":" with the curve-construction algorithm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JMjwxaP8q5"}],"identifier":"producing-estimated-growth-curves-for-acer-rubrum-with-the-curve-construction-algorithm","label":"Producing estimated growth curves for Acer rubrum with the curve-construction algorithm","html_id":"producing-estimated-growth-curves-for-acer-rubrum-with-the-curve-construction-algorithm","implicit":true,"key":"JId1qFtu1v"}],"key":"TpQhjKpn1D"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from functionsForCalibration import *\n\nresults = analyze_species_growth_curves(\n    prevalence_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Acer_Rub_v1.tif',\n    age_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif',\n    biomass_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif',\n    species_name='Acer rubrum',\n    output_csv_path='./ReferencesAndData/Growth Curves Predictions/acer_rubrum_estimated_growth_curves_NFI.csv',\n    prevalence_thresholds=[100, 80, 60, 40, 20],\n    peak_age_min=0,\n    peak_age_max=100,\n    senescence_age_window=5,\n    outlier_age_window=5,\n    outlier_percentile=100, # Don't remove any outlier for now\n    smoothing_window=200,\n    smoothing_polyorder=5,\n    n_sample_plot=2000000,\n    create_plot=True,\n    plot_figsize=(20, 8)\n)","key":"CbvwhuggAX"},{"type":"output","id":"R_t6qC_gsd2Zq3s6OGq9O","data":[{"name":"stdout","output_type":"stream","text":"=== Acer rubrum Growth Curve Analysis with Prevalence Thresholds ===\nParameters:\n  Peak search range: 0-100 years\n  Senescence age window: 5 years\n  Outlier removal: 5-year windows, 100% threshold\n  Smoothing window: 200 points\n  Prevalence thresholds: [100, 80, 60, 40, 20]\nReading raster files...\n✓ Rasters loaded successfully\nProcessing data and applying masks...\n✓ 8337062 valid pixels found\nRemoving outliers (age window: 5 years, percentile: 100%)...\nProcessing 51 age windows...\n"},{"name":"stderr","output_type":"stream","text":"Processing age windows: 100%|██████████████████████████████████████████████████████████| 51/51 [00:00<00:00, 100.27it/s]\n"},{"name":"stdout","output_type":"stream","text":"✓ 8337062 pixels remaining after outlier removal\n\nProcessing curves for each prevalence threshold...\n\n--- Processing threshold 100% ---\n  Threshold 100%: 8337062 points remaining (100.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 100%: 96 raw points, 185 smoothed points\n\n--- Processing threshold 80% ---\n  Threshold 80%: 8337062 points remaining (100.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 80%: 96 raw points, 185 smoothed points\n\n--- Processing threshold 60% ---\n  Threshold 60%: 8337061 points remaining (100.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 60%: 96 raw points, 185 smoothed points\n\n--- Processing threshold 40% ---\n  Threshold 40%: 8312061 points remaining (99.7% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 40%: 92 raw points, 185 smoothed points\n\n--- Processing threshold 20% ---\n  Threshold 20%: 7763982 points remaining (93.1% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 20%: 93 raw points, 185 smoothed points\n\nCreating CSV output...\n✓ CSV saved to: ./ReferencesAndData/acer_rubrum_estimated_growth_curves_NFI.csv\nSampling 2000000 points with prevalence-based weighting...\n✓ Sampled 2000000 points (avg prevalence: 13.1%)\n\nCreating visualization...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"aa10c038066db7b1655fa5c903bd4517","path":"/aa10c038066db7b1655fa5c903bd4517.png"},"text/plain":{"content":"<Figure size 2000x800 with 4 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"\n=== Analysis Complete ===\nTotal processing time: 67.3 seconds\nProcessed 8337062 pixels total\nCSV saved to: ./ReferencesAndData/acer_rubrum_estimated_growth_curves_NFI.csv\n\nCurve Summary:\n  Threshold ≤20%: Peak 31.89 tons/ha at age 70.0 (7763982 points)\n  Threshold ≤40%: Peak 48.14 tons/ha at age 62.0 (8312061 points)\n  Threshold ≤60%: Peak 50.80 tons/ha at age 62.0 (8337061 points)\n  Threshold ≤80%: Peak 50.77 tons/ha at age 62.0 (8337062 points)\n  Threshold ≤100%: Peak 50.77 tons/ha at age 62.0 (8337062 points)\n"}],"key":"BVf7t47nZC"}],"key":"EcGeON3dhN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":6,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YEHSmoWarT"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Picea mariana","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iVBCqY7Ni4"}],"key":"poxzHXvUje"},{"type":"text","value":" with the curve-construction algorithm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pVku0VvwcG"}],"identifier":"producing-estimated-growth-curves-for-picea-mariana-with-the-curve-construction-algorithm","label":"Producing estimated growth curves for Picea mariana with the curve-construction algorithm","html_id":"producing-estimated-growth-curves-for-picea-mariana-with-the-curve-construction-algorithm","implicit":true,"key":"SIZZgGot7y"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We’re taking a look at our third species, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LKMuxqLbic"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Picea mariana","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IsHOPV4Hqz"}],"key":"h5vpsAPuGu"},{"type":"text","value":". Same protocol as previous section with ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BqCPZuUbQl"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dsHK6xtvGg"}],"key":"CY1xpKVtla"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"c1bLT5Xq4F"}],"key":"uEf1fWLcdj"}],"key":"ULQRZ6wAIu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from functionsForCalibration import *\n\nresults = analyze_species_growth_curves(\n    prevalence_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Pice_Mar_v1.tif',\n    age_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif',\n    biomass_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif',\n    species_name='Picea Mariana',\n    output_csv_path='./ReferencesAndData/Growth Curves Predictions/picea_mariana_estimated_growth_curves_NFI.csv',\n    prevalence_thresholds=[100, 80, 60, 40, 20],\n    peak_age_min=0,\n    peak_age_max=200, # Peak is a bit later for Picea mariana compared to Abies balsamea and Acer rubrum\n    senescence_age_window=5,\n    outlier_age_window=5,\n    outlier_percentile=100, # Don't remove any outlier for now\n    smoothing_window=200,\n    smoothing_polyorder=5,\n    n_sample_plot=2000000,\n    create_plot=True,\n    plot_figsize=(20, 8)\n)","key":"BAcX0OBPsE"},{"type":"output","id":"Y0DDXrnUHl-XziYdMVXR5","data":[{"name":"stdout","output_type":"stream","text":"=== Picea Mariana Growth Curve Analysis with Prevalence Thresholds ===\nParameters:\n  Peak search range: 0-200 years\n  Senescence age window: 5 years\n  Outlier removal: 5-year windows, 100% threshold\n  Smoothing window: 200 points\n  Prevalence thresholds: [100, 80, 60, 40, 20]\nReading raster files...\n✓ Rasters loaded successfully\nProcessing data and applying masks...\n✓ 80116986 valid pixels found\nRemoving outliers (age window: 5 years, percentile: 100%)...\nProcessing 70 age windows...\n"},{"name":"stderr","output_type":"stream","text":"Processing age windows: 100%|██████████████████████████████████████████████████████████| 70/70 [00:07<00:00,  9.66it/s]\n"},{"name":"stdout","output_type":"stream","text":"✓ 80116986 pixels remaining after outlier removal\n\nProcessing curves for each prevalence threshold...\n\n--- Processing threshold 100% ---\n  Threshold 100%: 80116986 points remaining (100.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 100%: 124 raw points, 295 smoothed points\n\n--- Processing threshold 80% ---\n  Threshold 80%: 71328226 points remaining (89.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 80%: 120 raw points, 295 smoothed points\n\n--- Processing threshold 60% ---\n  Threshold 60%: 58280657 points remaining (72.7% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 60%: 121 raw points, 295 smoothed points\n\n--- Processing threshold 40% ---\n  Threshold 40%: 44835036 points remaining (56.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 40%: 104 raw points, 295 smoothed points\n\n--- Processing threshold 20% ---\n  Threshold 20%: 21607588 points remaining (27.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 20%: 96 raw points, 281 smoothed points\n\nCreating CSV output...\n✓ CSV saved to: ./ReferencesAndData/Growth Curves Predictions/picea_mariana_estimated_growth_curves_NFI.csv\nSampling 2000000 points with prevalence-based weighting...\n✓ Sampled 2000000 points (avg prevalence: 58.9%)\n\nCreating visualization...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"aee705277451a88bc310ea1938dc9dd6","path":"/aee705277451a88bc310ea1938dc9dd6.png"},"text/plain":{"content":"<Figure size 2000x800 with 4 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"\n=== Analysis Complete ===\nTotal processing time: 189.5 seconds\nProcessed 80116986 pixels total\nCSV saved to: ./ReferencesAndData/Growth Curves Predictions/picea_mariana_estimated_growth_curves_NFI.csv\n\nCurve Summary:\n  Threshold ≤20%: Peak 58.37 tons/ha at age 151.0 (21607588 points)\n  Threshold ≤40%: Peak 80.00 tons/ha at age 164.0 (44835036 points)\n  Threshold ≤60%: Peak 106.50 tons/ha at age 122.0 (58280657 points)\n  Threshold ≤80%: Peak 139.02 tons/ha at age 122.0 (71328226 points)\n  Threshold ≤100%: Peak 162.61 tons/ha at age 130.0 (80116986 points)\n"}],"key":"hnCgDZQjYo"}],"key":"v2dey3f7FW"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing growth curves from NFI data with a Generalized Additive Model (GAM)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GTX8e6nAiN"}],"identifier":"producing-growth-curves-from-nfi-data-with-a-generalized-additive-model-gam","label":"Producing growth curves from NFI data with a Generalized Additive Model (GAM)","html_id":"producing-growth-curves-from-nfi-data-with-a-generalized-additive-model-gam","implicit":true,"key":"shVEWa1NS9"}],"key":"DBmXruZ2lh"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here, we process the data in order to identify the highest percentiles of biomass for each species for set of successive age windows and abundance windows (see figure below). Once we have identified these percentile, we use a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UyFvZWpwfc"},{"type":"link","url":"https://en.wikipedia.org/wiki/Generalized_additive_model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generalize Additive Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LXpqE4GZdr"}],"urlSource":"https://en.wikipedia.org/wiki/Generalized_additive_model","data":{"page":"Generalized_additive_model","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"SgE8k97Be1"},{"type":"text","value":" (GAM) fitted on this processed data in order to predict the percentile values as a fonction of age, but also of the percentage of abundance of the species in a cell. GAMs are dealt with using the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oHLoIW7Tnq"},{"type":"link","url":"https://pygam.readthedocs.io/en/latest/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"pyGAM package","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h1yTiwrdWo"}],"urlSource":"https://pygam.readthedocs.io/en/latest/","key":"pzPbiWKQ5f"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XH9njbhRUL"}],"key":"w4fwYMsELI"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This is essential for species like ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"h8d7EQj7EA"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"waIOJsBjt7"}],"key":"gXg9M1tGc8"},{"type":"text","value":" in our dataset for which most of the pixels where the species is present do not have a high abundance for the species; for the great majority of pixels values for ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Nyy0QusbEX"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mHTCTf8gTC"}],"key":"CIbOuvbx9V"},{"type":"text","value":", we do not go beyond 60% of abundance of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vDcIqA0wK4"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Vd2Xx9J4uH"}],"key":"TAgorsMaTz"},{"type":"text","value":" in the stand (see figures above). However, remember that our goal here is to estimate (as much as can be) the growth of the species in ideal conditions, which includes no competition for light from other species, meaning in monoculture (100% abundance).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wHnDC8cYH0"}],"key":"AgqEHLGB4e"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The use of a GAM allows us to make predictions about what would be the growth of the species in condition of full abundance (100%)/monoculture, even though we have no data or few data points/pixels with such an abundance.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"sTBCMStfG6"}],"key":"ZjMd2dkPHH"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The issue is that fitting a GAM on the NFI data was more difficult than I expected; because of the space-for-time substitution we’re doing and the fact that we’re looking at data from the entire province, it seems that the patterns in the data (e.g. effect of age and abundance on biomass) can seem quite clear to the human eye, but can be difficult to mirror properly in a GAM. The overabundance of low-abundance pixels, and also the presence of some high-abundance pixels with relatively low biomass values and other outliers tended to create unexpected and absurd GAM behaviour.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"v14Ru7mVx1"}],"key":"hrJj4vY5z4"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"I solved this issue by pre-processing the data (see figure below) to 1) reduce the number of points, 2) remove the outliers, and 3) force a monotonic increasing rule regarding the effect of abundance of the high percentiles of biomass. This pre-processing is highly customizible, allowing you to define the size of the windows, the percentile computed, or to exclude certain pixels; see the function ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"gmECloNfMn"},{"type":"inlineCode","value":"prepareNFIDataForGAMs","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"QQf4LrrljT"},{"type":"text","value":". The fitting of the GAM can also be customised.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"qqQhBZxP9S"}],"key":"wV8yzbyz8f"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The best GAM structure I’ve found so far to produce these curve is the following :","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"jHWwz0L2KB"}],"key":"Cf6RZr43vB"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"inlineMath","value":"\\text{High Biomass Percentile} = s(age, \\text{with a concave constraint}) + interaction(age, \\% abundance, \\text{with a concave constraint})","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>High Biomass Percentile</mtext><mo>=</mo><mi>s</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mi>g</mi><mi>e</mi><mo separator=\"true\">,</mo><mtext>with a concave constraint</mtext><mo stretchy=\"false\">)</mo><mo>+</mo><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mi>g</mi><mi>e</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">%</mi><mi>a</mi><mi>b</mi><mi>u</mi><mi>n</mi><mi>d</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mo separator=\"true\">,</mo><mtext>with a concave constraint</mtext><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\text{High Biomass Percentile} = s(age, \\text{with a concave constraint}) + interaction(age, \\% abundance, \\text{with a concave constraint})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">High Biomass Percentile</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">with a concave constraint</span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">in</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">er</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">%</span><span class=\"mord mathnormal\">ab</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">an</span><span class=\"mord mathnormal\">ce</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">with a concave constraint</span></span><span class=\"mclose\">)</span></span></span></span>","key":"s2Ql9UGUVB"}],"key":"wBU0q0xkVJ"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The concave constrait force the effect of age and the 2D plane of the interaction effect (tensor product) of age and % abundance to be concave, which matches the biological reality that after a certain age, the biomass of the species will decrease.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"x8UPLAeraT"}],"key":"eaSNA6aazU"},{"type":"image","url":"/GAM_DataProessing_NF-a3c50736cf192db0b152eeb8ad74f4df.PNG","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"mHjduRnpVl","urlSource":"./Images/GAM_DataProessing_NFI_Method.PNG"}],"key":"UrH2pDuT9M"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":6,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"E5hy8sOD84"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AA1TlumHVE"}],"key":"cwyVQ4y5ns"},{"type":"text","value":" with a GAM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pGMoIy9efa"}],"identifier":"producing-estimated-growth-curves-for-abies-balsamea-with-a-gam","label":"Producing estimated growth curves for Abies balsamea with a GAM","html_id":"producing-estimated-growth-curves-for-abies-balsamea-with-a-gam","implicit":true,"key":"CjrsXxDbm3"}],"key":"OmckmyMnEC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from functionsForCalibration import *\n\nwindowed_df = prepareNFIDataForGAMs(abundance_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Abie_Bal_v1.tif',\n                                  age_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif',\n                                  biomass_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif',\n                                  speciesName = \"Abies balsamea\",\n                                  age_window = 5,\n                                  abundance_window = 10,\n                                  percentile = 100,\n                                  mask_path = None,\n                                  printPlot = False)\n\ncreateGAMsAndPredictionsForNFIDataGrowthCurves(windowed_df,\n                                                './ReferencesAndData/Growth Curves Predictions/Abies Balsamea_gam_predictions.csv',\n                                               \"Abies balsamea\",\n                                                cutoff_age = 150,\n                                                abundance_levels = [100, 80, 60, 40, 20],\n                                                printPlot = True)","key":"h1avSIB4q5"},{"type":"output","id":"ZJf_I2XbkFEyK5PUwQW0B","data":[{"name":"stdout","output_type":"stream","text":"Reading raster data...\nCreating initial dataframe...\nInitial dataframe shape: (32674827, 3)\nAge range: 0.0 - 348.4\nAbundance range: 0.0 - 100.0\n\nProcessing with parameters:\nAge window: 5\nAbundance window: 10\nPercentile: 100\n\nCreating windowed dataframe...\nApplied monotonic abundance constraint - kept 350 entries\nWindowed dataframe shape: (350, 3)\nNo data points found in the specified windows!\nFiltering data by age cutoff...\nOriginal dataframe shape: (350, 3)\nFiltered dataframe shape (Age < 150): (236, 3)\nFiltered age range: 0.0 - 147.5\nFiltered abundance range: 5.0 - 95.0\n\nFitting weighted GAM model...\ndid not converge\nGAM fitted successfully with constraints and abundance weighting!\nGAM summary:\n  - Number of observations: 236\n  - R-squared (pseudo): 0.943\n  - Constraints applied:\n    * Age effect: concave\n    * Tensor product interaction: concave\n    * Intercept forced to 0\n    * Weighted toward high abundance observations\n\nGenerating predictions for abundance levels: [100, 80, 60, 40, 20]\nGenerated predictions for 100% abundance:\n  - Biomass range: 11.86 - 95.97\n  - Value at age 0: 11.856283\nGenerated predictions for 80% abundance:\n  - Biomass range: 7.58 - 91.05\n  - Value at age 0: 7.575023\nGenerated predictions for 60% abundance:\n  - Biomass range: 1.93 - 85.51\n  - Value at age 0: 1.934564\nGenerated predictions for 40% abundance:\n  - Biomass range: -4.76 - 73.33\n  - Value at age 0: -4.760048\nGenerated predictions for 20% abundance:\n  - Biomass range: -13.71 - 52.83\n  - Value at age 0: -13.714163\n\nCreating plot with multiple GAM predictions...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4e22d868c9abd32175fc1fe04e375b9c","path":"/4e22d868c9abd32175fc1fe04e375b9c.png"},"text/plain":{"content":"<Figure size 1600x1000 with 2 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"\nGAM Model Information:\nCutoff age used: 150 years\nData points used for fitting: 236\nPrediction curves: 0-150 years for 5 abundance levels\nModel constraints and weighting applied successfully\nPredictions exported to ./ReferencesAndData/Growth Curves Predictions/Abies Balsamea_gam_predictions.csv\nShape: (100, 6)\nColumns: ['Age', 'GAM_Prediction_100%Abundance', 'GAM_Prediction_80%Abundance', 'GAM_Prediction_60%Abundance', 'GAM_Prediction_40%Abundance', 'GAM_Prediction_20%Abundance']\nAge range: 0.0 - 150.0\n\nPreview of exported data:\n        Age  GAM_Prediction_100%Abundance  GAM_Prediction_80%Abundance  \\\n0  0.000000                     11.856283                     7.575023   \n1  1.515152                     15.636944                    11.182145   \n2  3.030303                     19.377459                    14.753408   \n3  4.545455                     23.069911                    18.281029   \n4  6.060606                     26.706385                    21.757229   \n\n   GAM_Prediction_60%Abundance  GAM_Prediction_40%Abundance  \\\n0                     1.934564                    -4.760048   \n1                     5.252371                    -1.752317   \n2                     8.536013                     1.221635   \n3                    11.779049                     4.155960   \n4                    14.975040                     7.044810   \n\n   GAM_Prediction_20%Abundance  \n0                   -13.714163  \n1                   -10.932160  \n2                    -8.182467  \n3                    -5.470878  \n4                    -2.803186  \n"}],"key":"iNhoF766vW"}],"key":"Wx0xJ0ThXD"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":6,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EyqvEf4NVA"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aYE9jc8CHK"}],"key":"t7k3pIodR0"},{"type":"text","value":" with a GAM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TgnQ02S72v"}],"identifier":"producing-estimated-growth-curves-for-acer-rubrum-with-a-gam","label":"Producing estimated growth curves for Acer rubrum with a GAM","html_id":"producing-estimated-growth-curves-for-acer-rubrum-with-a-gam","implicit":true,"key":"iT9NGRWq0P"}],"key":"TyCa1HGtdn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from functionsForCalibration import *\n\nwindowed_df = prepareNFIDataForGAMs(abundance_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Acer_Rub_v1.tif',\n                                  age_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif',\n                                  biomass_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif',\n                                  speciesName = \"Acer rubrum\",\n                                  age_window = 5,\n                                  abundance_window = 10,\n                                  percentile = 100,\n                                  mask_path = None,\n                                  printPlot = False)\n\ncreateGAMsAndPredictionsForNFIDataGrowthCurves(windowed_df,\n                                                './ReferencesAndData/Growth Curves Predictions/Acer rubrum_gam_predictions.csv',\n                                               \"Acer rubrum\",\n                                                cutoff_age = 150,\n                                                abundance_levels = [100, 80, 60, 40, 20],\n                                                printPlot = True)","key":"pBENij4Z21"},{"type":"output","id":"4q8-CTC6oMyFoNkNxjjVH","data":[{"name":"stdout","output_type":"stream","text":"Reading raster data...\nCreating initial dataframe...\nInitial dataframe shape: (8337062, 3)\nAge range: 0.0 - 251.8\nAbundance range: 0.0 - 60.9\n\nProcessing with parameters:\nAge window: 5\nAbundance window: 10\nPercentile: 100\n\nCreating windowed dataframe...\nApplied monotonic abundance constraint - kept 155 entries\nWindowed dataframe shape: (155, 3)\nNo data points found in the specified windows!\nFiltering data by age cutoff...\nOriginal dataframe shape: (155, 3)\nFiltered dataframe shape (Age < 150): (118, 3)\nFiltered age range: 0.0 - 147.5\nFiltered abundance range: 5.0 - 95.0\n\nFitting weighted GAM model...\ndid not converge\nGAM fitted successfully with constraints and abundance weighting!\nGAM summary:\n  - Number of observations: 118\n  - R-squared (pseudo): 0.978\n  - Constraints applied:\n    * Age effect: concave\n    * Tensor product interaction: concave\n    * Intercept forced to 0\n    * Weighted toward high abundance observations\n\nGenerating predictions for abundance levels: [100, 80, 60, 40, 20]\nGenerated predictions for 100% abundance:\n  - Biomass range: -0.09 - 90.48\n  - Value at age 0: -0.092426\nGenerated predictions for 80% abundance:\n  - Biomass range: 0.68 - 73.15\n  - Value at age 0: 0.680676\nGenerated predictions for 60% abundance:\n  - Biomass range: 1.24 - 62.20\n  - Value at age 0: 1.237291\nGenerated predictions for 40% abundance:\n  - Biomass range: 0.88 - 51.93\n  - Value at age 0: 0.880931\nGenerated predictions for 20% abundance:\n  - Biomass range: -0.77 - 40.20\n  - Value at age 0: -0.774627\n\nCreating plot with multiple GAM predictions...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"00a2ac33f4584fed02010dce7ff226b8","path":"/00a2ac33f4584fed02010dce7ff226b8.png"},"text/plain":{"content":"<Figure size 1600x1000 with 2 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"\nGAM Model Information:\nCutoff age used: 150 years\nData points used for fitting: 118\nPrediction curves: 0-150 years for 5 abundance levels\nModel constraints and weighting applied successfully\nPredictions exported to ./ReferencesAndData/Growth Curves Predictions/Acer rubrum_gam_predictions.csv\nShape: (100, 6)\nColumns: ['Age', 'GAM_Prediction_100%Abundance', 'GAM_Prediction_80%Abundance', 'GAM_Prediction_60%Abundance', 'GAM_Prediction_40%Abundance', 'GAM_Prediction_20%Abundance']\nAge range: 0.0 - 150.0\n\nPreview of exported data:\n        Age  GAM_Prediction_100%Abundance  GAM_Prediction_80%Abundance  \\\n0  0.000000                     -0.092426                     0.680676   \n1  1.515152                      2.045502                     2.709385   \n2  3.030303                      4.179371                     4.733866   \n3  4.545455                      6.307968                     6.752787   \n4  6.060606                      8.430078                     8.764815   \n\n   GAM_Prediction_60%Abundance  GAM_Prediction_40%Abundance  \\\n0                     1.237291                     0.880931   \n1                     3.142053                     2.597460   \n2                     5.042615                     4.309738   \n3                     6.937566                     6.016400   \n4                     8.825494                     7.716084   \n\n   GAM_Prediction_20%Abundance  \n0                    -0.774627  \n1                     0.686626  \n2                     2.143208  \n3                     3.593859  \n4                     5.037319  \n"}],"key":"c3bmd7FdPF"}],"key":"NS3KxBeFkd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":6,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p2lqsA2owk"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Picea mariana","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m15wDuNce3"}],"key":"EPEamWeDlI"},{"type":"text","value":" with a GAM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T7hCcpT1mW"}],"identifier":"producing-estimated-growth-curves-for-picea-mariana-with-a-gam","label":"Producing estimated growth curves for Picea mariana with a GAM","html_id":"producing-estimated-growth-curves-for-picea-mariana-with-a-gam","implicit":true,"key":"Mt7KKdv4Lv"}],"key":"eYucdBMGYj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from functionsForCalibration import *\n\nwindowed_df = prepareNFIDataForGAMs(abundance_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Pice_Mar_v1.tif',\n                                  age_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif',\n                                  biomass_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif',\n                                  speciesName = \"Picea mariana\",\n                                  age_window = 5,\n                                  abundance_window = 10,\n                                  percentile = 100,\n                                  mask_path = None,\n                                  printPlot = False)\n\ncreateGAMsAndPredictionsForNFIDataGrowthCurves(windowed_df,\n                                                './ReferencesAndData/Growth Curves Predictions/Picea mariana_gam_predictions.csv',\n                                               \"Picea mariana\",\n                                                cutoff_age = 200, # The take more data as the pic of Picea mariana seems to be later than for Abies balsamea and Acer rubrum\n                                                abundance_levels = [100, 80, 60, 40, 20],\n                                                printPlot = True)","key":"N903gYi1rw"},{"type":"output","id":"HpmkKNDOpNj1l0j3X37ba","data":[{"name":"stdout","output_type":"stream","text":"Reading raster data...\nCreating initial dataframe...\nInitial dataframe shape: (80116986, 3)\nAge range: 0.0 - 348.4\nAbundance range: 0.0 - 100.0\n\nProcessing with parameters:\nAge window: 5\nAbundance window: 10\nPercentile: 100\n\nCreating windowed dataframe...\nApplied monotonic abundance constraint - kept 404 entries\nWindowed dataframe shape: (404, 3)\nNo data points found in the specified windows!\nFiltering data by age cutoff...\nOriginal dataframe shape: (404, 3)\nFiltered dataframe shape (Age < 200): (310, 3)\nFiltered age range: 0.0 - 197.5\nFiltered abundance range: 5.0 - 95.0\n\nFitting weighted GAM model...\nGAM fitted successfully with constraints and abundance weighting!\nGAM summary:\n  - Number of observations: 310\n  - R-squared (pseudo): 0.986\n  - Constraints applied:\n    * Age effect: concave\n    * Tensor product interaction: concave\n    * Intercept forced to 0\n    * Weighted toward high abundance observations\n\nGenerating predictions for abundance levels: [100, 80, 60, 40, 20]\nGenerated predictions for 100% abundance:\n  - Biomass range: 1.62 - 162.79\n  - Value at age 0: 1.619057\nGenerated predictions for 80% abundance:\n  - Biomass range: 4.53 - 137.91\n  - Value at age 0: 4.533635\nGenerated predictions for 60% abundance:\n  - Biomass range: 5.99 - 111.49\n  - Value at age 0: 5.992570\nGenerated predictions for 40% abundance:\n  - Biomass range: 3.08 - 83.63\n  - Value at age 0: 3.082758\nGenerated predictions for 20% abundance:\n  - Biomass range: -6.66 - 54.52\n  - Value at age 0: -6.659307\n\nCreating plot with multiple GAM predictions...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a8b37048c3f11cefcd5b9c3276408f07","path":"/a8b37048c3f11cefcd5b9c3276408f07.png"},"text/plain":{"content":"<Figure size 1600x1000 with 2 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"\nGAM Model Information:\nCutoff age used: 200 years\nData points used for fitting: 310\nPrediction curves: 0-200 years for 5 abundance levels\nModel constraints and weighting applied successfully\nPredictions exported to ./ReferencesAndData/Growth Curves Predictions/Picea mariana_gam_predictions.csv\nShape: (100, 6)\nColumns: ['Age', 'GAM_Prediction_100%Abundance', 'GAM_Prediction_80%Abundance', 'GAM_Prediction_60%Abundance', 'GAM_Prediction_40%Abundance', 'GAM_Prediction_20%Abundance']\nAge range: 0.0 - 200.0\n\nPreview of exported data:\n        Age  GAM_Prediction_100%Abundance  GAM_Prediction_80%Abundance  \\\n0  0.000000                      1.619057                     4.533635   \n1  2.020202                      5.081319                     7.759642   \n2  4.040404                      8.529249                    10.973141   \n3  6.060606                     11.962244                    14.173377   \n4  8.080808                     15.379699                    17.359592   \n\n   GAM_Prediction_60%Abundance  GAM_Prediction_40%Abundance  \\\n0                     5.992570                     3.082758   \n1                     8.864901                     5.428215   \n2                    11.722846                     7.755498   \n3                    14.565205                    10.063526   \n4                    17.390782                    12.351221   \n\n   GAM_Prediction_20%Abundance  \n0                    -6.659307  \n1                    -4.793040  \n2                    -2.943452  \n3                    -1.111152  \n4                     0.703252  \n"}],"key":"dMF7YcyjX0"}],"key":"aBn5ostaEp"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Values needed to estimate certain parameters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xCpvpk27F7"}],"identifier":"values-needed-to-estimate-certain-parameters","label":"Values needed to estimate certain parameters","html_id":"values-needed-to-estimate-certain-parameters","implicit":true,"key":"JvSBHjeamu"}],"key":"gjB3hCvPnC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Longevity and Max Longevity","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qoXcBWLhAM"}],"identifier":"longevity-and-max-longevity","label":"Longevity and Max Longevity","html_id":"longevity-and-max-longevity","implicit":true,"key":"Mcm0GP3oAl"}],"key":"pFWgrK94oQ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What we will call here “Longevity” and “Max Longevity” are necessary to calibrate the senescence part of the growth curve for our species.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PMasElOrbe"}],"key":"fTZgVvBHTj"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The difference between the two is this, per the team of Brian Sturtevant who explained their methodology to me :","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dLj2HaouZC"}],"key":"Av6A0NP6gC"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Longevity is the rule-of-thumb, expert opinion longevity for a given tree species. This is the age at which it’s expected that a tree of a given species will die, in a give region. These are the number often reported in the litterature, and also used in the core species parameter file of LANDIS-II as its “Longevity” parameter for each tree species used.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Wn12gfagbE"}],"key":"BbaPQWEHz4"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Max Longevity is the real, empirical maximum age that a tree species can reach in the study area. It’s often not reported and difficult to find. A good way to find it is to look at sample plot data and find the oldest trees ever found for a given species (which can be difficult to find as the “age” data is often not directly available in sample plots data).","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"yRPcbblVBG"}],"key":"LZ5rjtdQrw"}],"key":"DVHbgSNYYp"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Brian Sturtevant and his team have used these two notions to calibrate the senescence part of the growth curves in ideal conditions as explained in ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"kw7gzbN9SQ"},{"type":"link","url":"./6.Monoculture_ideal_conditions.py","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[],"urlSource":"./6.Monoculture_ideal_conditions.py","key":"wiwts5zsis"},{"type":"text","value":".  This part from ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"gRfHFoxwNT"},{"type":"cite","url":"https://cdnsciencepub.com/doi/suppl/10.1139/cjfr-2024-0085/suppl_file/cjfr-2024-0085suppla.docx","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"this supplementary material of Reese et al. (2025)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"RoSQRxoSSS"}],"kind":"narrative","label":"Reese_2025","identifier":"https://cdnsciencepub.com/doi/suppl/10.1139/cjfr-2024-0085/suppl_file/cjfr-2024-0085suppla.docx","enumerator":"3","key":"uEHkiQOLOU"},{"type":"text","value":" describes Brian’s methodology of explains it all :","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"VMrqDQHKgh"}],"key":"fRTE2EzlqX"},{"type":"blockquote","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"We used an unpublished review and analysis led by John Du Plissis at the University of Minnesota-Duluth to define both tree species longevity (the age at which a species age cohort can no longer persist) and the initiation of decline that is defined by the age-related photosynthesis reduction factor (PsnAgeRed) parameter in PnET Succession. In general, the maximum species longevity of Loehle (1988) corresponds with the tree species longevity parameter, while the typical species’ longevity from the same publication determines the initiation of decline, where PsnAgeRed is calibrated such that the fAGE (age reduction factor) begins to decline (~0.99) at the Typical Mortality age of the species.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"P1FUSPIuGG"}],"key":"g9M3HpKzHo"}],"key":"DH9EsBC0TV"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"The data used by Brian’s team for Typical Longevity and Max Longevity are cited as coming from ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"CfmCQkeppY"},{"type":"cite","url":"https://sci-hub.st/https://cdnsciencepub.com/doi/10.1139/x88-032","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Loehle (1988)","key":"SahSJxTFmS"}],"kind":"narrative","label":"Loehle_1988","identifier":"https://sci-hub.st/https://cdnsciencepub.com/doi/10.1139/x88-032","enumerator":"4","key":"B1cxFyK1zN"},{"type":"text","value":" in ReeseEtAl_CanJForRes_2024_supplA.docx ; it’s an article that seem to compute them based on several characteristics of tree species.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"hzHTpH5xss"}],"key":"EuMb3sdvzl"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"In the end, Brian’s team is using a combination of data from ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"W8EHjeJyOw"},{"type":"cite","url":"https://cdnsciencepub.com/doi/10.1139/x88-032","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Loehle (1988)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"sC3jX5EuhO"}],"kind":"narrative","label":"Loehle_1988","identifier":"https://cdnsciencepub.com/doi/10.1139/x88-032","enumerator":"4","key":"Tvw97wVMoC"},{"type":"text","value":" and estimates found by John Du Plissis (yet unpublished). I’m going to use the data from ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"uSfGyKHXpc"},{"type":"cite","url":"https://cdnsciencepub.com/doi/10.1139/x88-032","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Loehle (1988)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"R37oKDZ038"}],"kind":"narrative","label":"Loehle_1988","identifier":"https://cdnsciencepub.com/doi/10.1139/x88-032","enumerator":"4","key":"FaCb5UyZv2"},{"type":"text","value":", which should be enough for our goals until the data from Du Plissis is published.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"uvZfTjmBB4"}],"key":"lv5LVnapOj"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"cite","url":"https://cdnsciencepub.com/doi/10.1139/x88-032","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Loehle (1988)","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"zm47Bh1J33"}],"kind":"narrative","label":"Loehle_1988","identifier":"https://cdnsciencepub.com/doi/10.1139/x88-032","enumerator":"4","key":"tGRJg4lmfv"},{"type":"text","value":", defines “Typical” versus “Maximum” longevity in the following terms :","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Lv6nEi1N0v"}],"key":"RLz8UKQBKc"},{"type":"blockquote","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Typical longevity is the age of the older trees in an old-growth stand, whereas maximum longevity is the upper known maximum above which very few trees are found.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"ZQ8blSgMNM"}],"key":"zn01rEs7gk"}],"key":"xf7HunbzvE"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"We can find the value of typical longevity and maximum longevity from Loehle in the Appendix 1. Here are the values for our three species :","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"MsNxz93vx3"}],"key":"kO0eFArQjH"}],"key":"ETlsNRoUC7"},{"type":"block","kind":"notebook-content","children":[{"type":"table","position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Species","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iX2DRwHCZC"}],"key":"tXTqd4kfx1"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"MINREP (years)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VBcrq7mD28"}],"key":"gFISq9CGiH"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"AVEREP (years)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tinFjZ490K"}],"key":"gtQLkCA9K0"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"TYPMORT (years)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qVVIfWVvF2"}],"key":"Ul3ptKmz2i"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"MAXMORT (years)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vm3gLZ5J6F"}],"key":"WIG8NgWY41"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Specific gravity","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S6lYlsZPsT"}],"key":"Ax4b3t2ZtC"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Growth rate","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O6n8QhDZBj"}],"key":"vxLGLxoTrg"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Shade tolerance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JBKqytwd2O"}],"key":"SmePdCfE3V"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Volumetric heat (J·cm⁻³)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JYfabS6lC7"}],"key":"Y4XIA17IWo"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Decay resistance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mp7L9vx3qB"}],"key":"pSK0hNfz6l"}],"key":"qAGuPufXfe"},{"type":"tableRow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JhMyC1V8V6"}],"key":"O8HJQ9DS5w"}],"key":"ffXdXd9heG"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"15","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TcpJTdxlfe"}],"key":"Y1dT3htGt2"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"30","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yuHyxHNQjp"}],"key":"Iy7WkREUUP"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"125","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GPr7kNmKdd"}],"key":"V1P8Lu5jdE"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"150","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ma5amEztp8"}],"key":"MImqUx4lBu"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"0.34","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ywX3ERxvZf"}],"key":"of81NMBa7b"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dTCBje7ZZn"}],"key":"PwK5XF7bZe"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"p2hbikOSJS"}],"key":"cqfucoT5nl"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"6.42","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TfA25INlEf"}],"key":"zgVPHh2PhO"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hFezhRqrHz"}],"key":"oVq6BFGN3G"}],"key":"l7LtNk4imv"},{"type":"tableRow","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Picea mariana","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"UD3ELvc6QG"}],"key":"im639DsUif"}],"key":"Qj9ekQbIz0"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"10","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"wbA0ahWvYV"}],"key":"oJYUol2OLL"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"18","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"xvvGqd01bn"}],"key":"S8bvnqbKc5"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"150","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"g2SGsnS3LR"}],"key":"CaZnj1ThR2"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"250","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"gkmDj3jBiE"}],"key":"m5R1Pz4ThI"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"0.43","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"zTsx9FfjD2"}],"key":"Y7kj6yaEZ7"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"NfLKlXb5w4"}],"key":"znkuHfvEtf"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"VGnKgo16gl"}],"key":"a4Zf09gbRY"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"7.91","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rsXF1gqev4"}],"key":"bpWcdmwVXq"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"JpVUI2z4TS"}],"key":"CNY1nVusX4"}],"key":"DwTCQS3tal"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"S6S1PJuzjy"}],"key":"xxZVrlgpUf"}],"key":"Umv0dE3eAR"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uMH9gM2yL9"}],"key":"DnpCR2QoEo"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[],"key":"jgbcSeXasu"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"80","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"X0LMO7HloL"}],"key":"FNCfJgibu3"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"150","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"qb54McDeqW"}],"key":"o5P5eJKQM3"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"0.49","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SViH0Bwnwn"}],"key":"Rlrj56bRoR"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LRGViYfwZE"}],"key":"yrFALEl60l"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QW6PkZfpJ4"}],"key":"nF27iHOiv5"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"9.93","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"izSOuszBok"}],"key":"NmtChuKAXq"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HdgawHrH5I"}],"key":"Q9LZm8B68a"}],"key":"AmSr2UDING"}],"key":"KTgbnADShq"}],"key":"IaAjSQCQY4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Ranges of parameter values for the calibration","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FN7MDCygNz"}],"identifier":"ranges-of-parameter-values-for-the-calibration","label":"Ranges of parameter values for the calibration","html_id":"ranges-of-parameter-values-for-the-calibration","implicit":true,"key":"iPTe4qT1iz"}],"key":"LOmcaZXfzt"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Table with ranges extracted from the litterature for most PnET parameters ?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fpuoV32Lv3"}],"key":"FlvLvwTqzd"}],"key":"dds8wJwFKD"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From Brian’s  team (ReeseEtAl_CanJForRes_2024_supplA.docx) :","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"plL0kcVfKe"}],"key":"PlsZhgRtCz"},{"type":"blockquote","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Parameter calibrations were guided by plausible ranges for ecophysiological parameter values and species traits from the TRY Plant Trait Database (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qlgAoAChCF"},{"type":"link","url":"https://www.try-db.org/TryWeb/Home.php","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"https://​www​.try​-db​.org​/TryWeb​/Home​.php","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dbB3eBvlRD"}],"urlSource":"https://www.try-db.org/TryWeb/Home.php","key":"oCnMtDyPPI"},{"type":"text","value":"), cross-referenced against region-specific species ecology from the Fire Effects Information System (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ur5Ja3G3ho"},{"type":"link","url":"https://www.feis-crs.org/feis/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"https://​www​.feis​-crs​.org​/feis/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YaZEUeALTW"}],"urlSource":"https://www.feis-crs.org/feis/","key":"YYoeLnRCww"},{"type":"text","value":").","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Pm36ktEH01"}],"key":"fgiWKFN12R"}],"key":"KBvAqWPJUr"}],"key":"Si2ppQwqzt"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From the user guide :","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lCBtTMH62I"}],"key":"F97MjoMJrl"},{"type":"blockquote","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The range of FolN for each species across sites, age, canopy position. This is a great starting point and helps put bounds on acceptable values, but it is important to recognize that productivity is closely related to FolN in PnET, so it is more important that FolN reflect relative productivity among species than matching empirical values. That said, it is usually (but not always) possible to select a value of FolN that is within the range of empirically measured values. If you have empirical values of Amax, use your values of AmaxA and AmaxB (or see Fig. 2 in Aber et al. 1996) to estimate the FolN that produces that Amax value. NOTE: if you plan to implement dynamic FolN (FolNInt and FolNSlope set to values other than default), then be sure to set FolNInt and FolNSlope to the values you will use in your final simulations while calibrating.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lS5VxZJych"}],"key":"FzfreaZ9QC"}],"key":"ucMkIOXiTU"},{"type":"blockquote","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Species SLWmax helps determine LAI. Thicker leaves (higher SLW) reduce LAI. LAI determines the ability of a cohort to compete for light, so it is important to calibrate so that LAI produces realistic response to light. Again, it is more important to get LAI approximately right than to keep SLWmax within the empirical range. Out-of-range SLWmax values often indicate that FracFol values are incorrect. Note that higher LAI increases within-canopy competition for light and will modestly depress growth even of a single cohort. I have found that LAI values exceeding those given in Table 1 may greatly reduce the amount of light penetrating canopy layers, thus impacting growth, competition and establishment","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ErrZg7do7C"}],"key":"MyKQw29ZNz"}],"key":"Mcfv872mDY"},{"type":"blockquote","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"There are some published estimates of whole tree biomass through time by species groups to provide some indication of belowground biomass (e.g., Smith et al. 2006). => Que ce sois cette source ou les modèles allometriques trouvés dans R, avoir des estimations du ration above/belowground serais très précieux.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"RsuuXkuJbM"}],"key":"uWIb0EFwEq"}],"key":"Nrk8yb4VA0"}],"key":"Qtfy5BsEPZ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Competition outcomes between species","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r7qlfEIwNN"}],"identifier":"competition-outcomes-between-species","label":"Competition outcomes between species","html_id":"competition-outcomes-between-species","implicit":true,"key":"QaBvM0zIBX"}],"key":"cROASSqLO0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Based on litterature + expert opinion, in different conditions :","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QmqTEVpBww"}],"key":"ryVnb3xSK8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Baseline + Good water level","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cdAgYQtEdc"}],"key":"q5FU4RAyjK"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Baseline + Drought","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"VgrNTy3rIO"}],"key":"fwCps2XCBY"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Baseline + Waterlogging","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YjuamxJcBY"}],"key":"ZHvo0O89mY"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Climate change ++","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"b8XljQ1k7N"}],"key":"DaX2og1nvA"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Climate change +++","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"uNS30gpB7q"}],"key":"Sam0BnZHi0"}],"key":"f6V9jIwhYw"}],"key":"PXJfFaErd0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"DRAFTS","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iPl2nziVys"}],"identifier":"drafts","label":"DRAFTS","html_id":"drafts","implicit":true,"key":"DYKcCtDr9B"}],"key":"aug0JsuueY"}],"key":"eBvvio3fMi"},"references":{"cite":{"order":["Pickett_1989","Beaudoin_2018","Reese_2025","Loehle_1988"],"data":{"Pickett_1989":{"label":"Pickett_1989","enumerator":"1","doi":"10.1007/978-1-4615-7358-6_5","html":"Pickett, S. T. A. (1989). Space-for-Time Substitution as an Alternative to Long-Term Studies. In <i>Long-Term Studies in Ecology</i> (pp. 110–135). Springer New York. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/978-1-4615-7358-6_5\">10.1007/978-1-4615-7358-6_5</a>","url":"https://doi.org/10.1007/978-1-4615-7358-6_5"},"Beaudoin_2018":{"label":"Beaudoin_2018","enumerator":"2","doi":"10.1139/cjfr-2017-0184","html":"Beaudoin, A., Bernier, P. Y., Villemaire, P., Guindon, L., & Guo, X. J. (2018). Tracking forest attributes across Canada between 2001 and 2011 using a k nearest neighbors mapping approach applied to MODIS imagery. <i>Canadian Journal of Forest Research</i>, <i>48</i>(1), 85–93. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1139/cjfr-2017-0184\">10.1139/cjfr-2017-0184</a>","url":"https://doi.org/10.1139/cjfr-2017-0184"},"Reese_2025":{"label":"Reese_2025","enumerator":"3","doi":"10.1139/cjfr-2024-0085","html":"Reese, G. C., Sturtevant, B. R., Dymond, C. C., Quigley, K. M., Duveneck, M. J., Lucash, M. S., Gustafson, E. J., Scheller, R. M., Russell, M. B., & Miranda, B. R. (2025). Best practices for calibration of forest landscape models using fine-scaled reference information. <i>Canadian Journal of Forest Research</i>, <i>55</i>, 1–19. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1139/cjfr-2024-0085\">10.1139/cjfr-2024-0085</a>","url":"https://doi.org/10.1139/cjfr-2024-0085"},"Loehle_1988":{"label":"Loehle_1988","enumerator":"4","doi":"10.1139/x88-032","html":"Loehle, C. (1988). Tree life history strategies: the role of defenses. <i>Canadian Journal of Forest Research</i>, <i>18</i>(2), 209–222. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1139/x88-032\">10.1139/x88-032</a>","url":"https://doi.org/10.1139/x88-032"}}}}}