{"version":2,"kind":"Notebook","sha256":"92dfac8874050bc57a4aa9cbc456c621bdc15d537a4bb7394825dedc19a5cf77","slug":"startingcalibrationtest.other-important-data-before-starting","location":"/StartingCalibrationTest/5.Other_important_data_before_starting.ipynb","dependencies":[],"frontmatter":{"title":"Other data needed for the calibration process","abbreviations":{"PnETSpeciesParameters":"Parameter than then calls a list of species.","FolN":"Foliar nitrogen content (in % by weight) for the leaves of the species.","SLWmax":"Specific leaf weight at the top of the canopy.","SLWDel":"Rate of change in the weight of the leaves from the top of the canopy (SLWmax) to each sublayer under the canopy.","MaxLAI":"Maximum leaf area index (LAI) that a species can achieve in its lifetime (for an age cohort ?).","TOFol":"Fraction of foliage biomass lost per year.","TORoot":"Fraction of root biomass lost per year.","TOWood":"Fraction of wood biomass lost per year.","AmaxA":"Intercept of the relationship between foliar N and maximum net photosynthetic rate.","AmaxB":"Slope of the relationship betwee foliar N and maximum net photosynthetic rate.","HalfSat":"Half saturation light level for photosynthesis.","H1":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","H2":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","H3":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","H4":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","PsnAgeRed":"Reduction factor of photosynthesis as the age of an age cohort increases.","LeafOnMinT":"Minimum temperature for activate growing season.","PsnTMin":"Minimum average daytime temperature for photosynthesis.","PsnTOpt":"Optimal average daytime temperature for photosynthesis.","PsnTMax":"Maximum average daytime temperature for photosynthesis.","ColTol":"Cold tolerance (coldest temperature that the species can survive).","k (parameter)":"Canopy light attenuation constant (light extinction coefficient).","DNSC":"Proportion of Non Structural (ressources) carbon from the total activate biomass of the cohort that will be maintained as long as net photosynthesis exceeds maintenance respiration.","FracBelowG":"Fraction of non-foliar biomass that is allocated belowground (root pool).","EstMoist":"Scaling parameter that changes the maximum expected value of fWater when computing the probability of establishment.","EstRad":"Scaling parameter that changes the maximum expected value of fRad when computing the probability of establishment.","FracFol":"Fraction of the active woody biomass (above or belowground) of a cohort that determines the amount of foliage maintained each year.","FrActWd":"Shape parameter of the negative exponential function that calculates the amount of woody biomass that has active xylem capable of supporting foliage.","CO2HalfSatEff":"Slope coefficient used to reduce HalfSat (= increase shade tolerance) as CO2 concentration increase.","CO2AMaxBEff":"Proportional change in AmaxB at 550ppm CO2 relative to 350ppm.","O3StomataSens":"Species susceptibility of the stomata to ozone-induced sluggishness.","O3GrowthSens":"Species susceptibility to ozone-induced tissue damage.","MaxFolN":"Controls the dynamic response of foliar nitrogen (FolN) to light.","FolNShape":"Controls the dynamic response of foliar nitrogen (FolN) to light.","MaxFracFol":"Controls the dynamic response of the fraction of Foliage (FracFol) to light.","FracFolShape":"Controls the dynamic response of the fraction of Foliage (FracFol) to light.","LifeFrom":"Specifies the life form (stature) of the species to determine the limits to the species major canopy layer.","MossScalar":"Unit converter from biomass to depth in the case of a pseudo species (moss).","MaxCanopyLayer":"Caps the number of canopy layers implemented in the model.","LayerThreshRatio":"Define how age cohorts of a given species are grouped together into canopy layers. Correspond to the minimum ratio of cohort woody biomass density between two cohorts that will place them in different canopy layers.","PARunits":"Indicates the units for PAR and HalfSat values. See Climate Input File for PAR and Species Parameters File for HalfSat.","IMAX":"Defines the degree of subdivision into different canopy sublayers for each age cohort.","DVPD1":"Coefficient for converting the vapor pressure deficit (VPD) into a reduction factor for photosynthesis caused by water pressure (fDVPD).","DVPD2":"Coefficient for converting the vapor pressure deficit (VPD) into a reduction factor for photosynthesis caused by water pressure (fDVPD).","BFolResp":"Define the Base Foliar Respiration Fraction (the foliar respiration as a fraction of the maximum photosynthetic rate).","MaintResp":"Represents the loss of Non Structural Carbon (NSC) due to maintenance respiration as a fraction of the active wood biomass of the cohort.","Q10":"Coefficient of the Q10 relationship to compute the foliar respiration.","FolLignin":"Mass fraction of lignin in foliage tissue.","KWdLit":"Annual decomposition rate of woody litter (decay constant k in equations).","InitialNSC":"Amount of Non Structural Carbon assigned to newly established cohorts.","CFracBiomass":"Carbon fraction of biomass by weight in an age cohort.","PrecipEvents":"Number of precipitation events during a month.","PrecipEventsWithReplacement":"Defines the logic of assignation of the precipitation from a precipitation event to the canopy sub layers.","ETExtCoeff":"Canopy extinction coefficient to reduce soil water evaporation as LAI increases (because of shadow created by the canopy ?).","RETCropCoeff":"Coefficient that scales the reference evapotranspiration (RET).","PreventEstablishment":"Turns species establishment on new cells on or off.","Wythers":"Turns the Wythers correction on or off.","DTEMP":"Turns the PnET-II DTEMP temperature reduction factor on or off.","MaxPest":"Tuning parameter to raise or lower the establishment probability of species by a same proportion.","AmaxFrac":"Fraction of the early morning instantaneous photosynthetic rate that represents the mean daily photosynthetic rate.","InvertPest":"Activates the optional inversion of the effect of fRad on the probability establishment as a function of HalfSat.","SoilIceDepth":"Activates the optional simulation of soil ice depth and its effects on water leakage.","LeakageFrostDepth":"Soil ice depth at which frozen soil no longer impedes soil drainage.","FrostFactor":"Tuning parameter to adjust soil ice depth.","InitialCommunitiesSpinup":"Specifies how the biomass of the initial age cohorts/communities in each cells are generated.","SpinupWaterStress":"Activates waterlogging stress during spin up procedures.","Parallel":"Specifies the number of CPU threads used for parallel execution.","CohortStacking":"Specifies the canopy cohort processing method.","CanopySumScale":"Scales the degree to which cumulativve canopy proportions cannot exceed 1."},"content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Clément Hardy, PhD.","given":"PhD.","family":"Clément Hardy"},"name":"Clément Hardy, PhD.","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/Klemet/Calibration_PnET_DIVERSE","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/Klemet/Calibration_PnET_DIVERSE/blob/main/calibrationJupyterBook/StartingCalibrationTest/5.Other_important_data_before_starting.ipynb","thumbnail":"/Algorithm_GrowthCurv-fc445ac3fd5e0813654caa5495dcaf2b.png","exports":[{"format":"ipynb","filename":"5.Other_important_data_before_starting.ipynb","url":"/5.Other_important_da-23ab5c25099864f04381db8fdbc7483c.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here, I catalog the other data needed for the calibration process, that is not the initial parameter values we will be using (for this, see ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uPZDAnZ9SK"},{"type":"link","url":"/startingcalibrationtest/initial-species-parameters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DaYZUM02l3"}],"urlSource":"./3.Initial_Species_Parameters.ipynb","dataUrl":"/startingcalibrationtest.initial-species-parameters.json","internal":true,"protocol":"file","key":"h8ntHuZlOT"},{"type":"text","value":") or the climate and soil data used in the simulations for the calibration (see ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WMECFdt6QM"},{"type":"link","url":"/startingcalibrationtest/setting-up-calibration-landscape","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"e6HkOGJDRb"}],"urlSource":"./4.Setting_up_calibration_Landscape.ipynb","dataUrl":"/startingcalibrationtest.setting-up-calibration-landscape.json","internal":true,"protocol":"file","key":"vPT8Ey95Qo"},{"type":"text","value":").","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lMDQRkuiWn"}],"key":"xlnpi2DKaR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This other data will be used to :","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KaFYriOYBQ"}],"key":"z9azGyhHHv"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Target values to match during the calibration (e.g. biomass growth curves)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tMKIlQMlYm"}],"key":"rSTtFAPQ8r"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Determine the value of some parameters directly (e.g. maximum longevity)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"vT3BQuK4ig"}],"key":"ldlZiRieDb"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Establish ranges of parameter values in which we should remain during the calibration","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Nm0b3aMa1M"}],"key":"zTR9cg86yN"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Expected outcomes of simulations (e.g. competition outcomes, climate change outcomes, etc.)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ImBmMKh9j8"}],"key":"sbYC1UPnPS"}],"key":"ZbJ4DqXjL6"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"I will write here as much suggestions a possible for future researchers that will want to calibrate for their own research or study area, but I will also indicate what I will be using in these notebooks.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"M4fIqYq6mh"}],"key":"Y0kwf5xWri"}],"visibility":"show","key":"B5YP5TgMBG"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Empirical data for biomass growth curves.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GGRHVl52Dq"}],"identifier":"empirical-data-for-biomass-growth-curves","label":"Empirical data for biomass growth curves.","html_id":"empirical-data-for-biomass-growth-curves","implicit":true,"key":"kJ3xl2eulL"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This is an essential part of the calibration process, especially the first step in which we will calibrate each species in “ideal” conditions of growth (mild climate, good soil water retention, etc.). These “ideal” conditions are important to isolate the effect of other parameters and other sources of mortality, so that you can focus on the basic parameters of growth and senescence for your species (see ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CloOCeTo40"},{"type":"link","url":"/startingcalibrationtest/monoculture-ideal-conditions","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jrdbRZqv49"}],"urlSource":"./6.Monoculture_ideal_conditions.ipynb","dataUrl":"/startingcalibrationtest.monoculture-ideal-conditions.json","internal":true,"protocol":"file","key":"ZcEIxiZGCx"},{"type":"text","value":").","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uMBnkkZ6jn"}],"key":"fGB25k2mqp"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Basically, what you want is data that allows you to infer a biomass growth curve for each given species, showing the evolution of the biomass of a cohort for the species in conditions that are as ideal as possible.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PjSMyt9phb"}],"key":"N7Iu66q52r"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"As of today, I’ve ran accross three different strategies to get this data. I’ll describe them in the following sections.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"st8OrFPbQW"}],"key":"ef8SnMxRRy"},{"type":"heading","depth":4,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Option 1 : Sample plot data.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Uel3qcAxPs"}],"identifier":"option-1-sample-plot-data","label":"Option 1 : Sample plot data.","html_id":"option-1-sample-plot-data","implicit":true,"key":"ygFpQsBbA5"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"By looking at individual tree data from sample plot data, you can infer tree biomass and tree age, making each tree or plot a point on your graph.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Cw2gxyVtQi"}],"key":"miO3vquRvc"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"By looking at the points that are at the top of the cloud of points that will result, you can get and idea of the maximum biomass a tree can reach for a given age, which should give you good information about the growth curve. This is a method used by many research so far.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"zt63aOWHLO"}],"key":"DHIL3RBwTP"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The problem is that sample plot data is often messy, full of outliers, biases, needing sharing agrements, etc. As such, it will require important work to clean, and several important assumptions will influence your results enormously. For example, the “tree age” data is often missing, and you’ll have to infer it from DBH; and you’ll also have to choose how to translate your individual tree biomass into biomass/surface (as all LANDIS-II biomass output is interpreted in biomass/surface, not biomass/tree).","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"r18urKuQgr"}],"key":"dzV9UOUZ2Y"},{"type":"heading","depth":4,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Option 2 : Tree growth models.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ISOp8xfDuV"}],"identifier":"option-2-tree-growth-models","label":"Option 2 : Tree growth models.","html_id":"option-2-tree-growth-models","implicit":true,"key":"jMOrAHrbIg"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"These models are complex equations develloped by foresters, industries or governmental agencies to try and predict growth or yield for different species in different conditions. These are often calibrated based on sample plot data; as such, the work of cleaning/dealing with sample plot data is often done for you. An example is the famous ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"z9xnQwrn4k"},{"type":"link","url":"www.fs.usda.gov/fvs/","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Forest Vegetation Simulator","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"AWUB84OxgU"}],"urlSource":"www.fs.usda.gov/fvs/","key":"QvuUUOKAsx"},{"type":"text","value":" from the USDA. Other such models are simply growth curves published in the litterature, sometimes in books.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Qu9rgFMJ5Y"}],"key":"IS1etfYJrJ"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"The curves produced by these models are often in biomass/surface, which makes things easier to compare with LANDIS-II outputs. You can also tweak the parameters of these models so that they predict biomass growth in conditions as ideal as possible, making it close to what you’re looking for.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"CYRuQBvab8"}],"key":"QNKzPN8xLs"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"The main issue is that these models can still produce pretty unrealistic curves; might not be available for your study area/region; and might still need parameters derived from sample plot data (e.g. Site index and maximum basal area for FVS). So while they can make your life simpler, they can still be difficult to use.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"WPf64bfJPd"}],"key":"RP3p7LbQCG"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"FVS can be compiled into a Dockerfile and use in Python; I’ve tried it at first and will keep the functions that I’ve written in a separate document for you to re-use if necessary.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"av0qJwkrlL"}],"key":"R5fjn27kiN"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Be warned that the decreasing part of the curves produced by these often often don’t include mortality by senescence, which can make the cruve growth forever, making it difficult to identify the biomass peak which is very important for calibration purposes.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"SdiZaDUCtL"}],"key":"de4GSAH6IG"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Tree growth models have been used by several research teams, including Brian Sturtevant’s and Eric Gustafson (the latter being the author of the calibration tips for PnET-Succession that are the basis of these documents).","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"IqCKgyeFDG"}],"key":"eMXqhFwYTT"},{"type":"heading","depth":4,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Option 3 : Forest inventory data.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"AmxO9bBL1t"}],"identifier":"option-3-forest-inventory-data","label":"Option 3 : Forest inventory data.","html_id":"option-3-forest-inventory-data","implicit":true,"key":"x2Sp2CFGhz"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"Some forest inventories contain data that allow you to infer tree or stand age and the biomass of your species of interest. For example, the ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"y7DDK6XdNK"},{"type":"link","url":"https://nfi.nfis.org/en/","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"National Forest Inventory of Canada","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"OacRbJXm5R"}],"urlSource":"https://nfi.nfis.org/en/","key":"zVC60PvMQL"},{"type":"text","value":" proposes raster maps of several forest attributes Canada-wide, including pixel/stand forest age, and the biomass of each individual species that are considered in the forest inventory.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"FDIP0zLCdn"}],"key":"BUePRA2Eo9"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"If you use each pixel from the maps of a single year as a point and plot a cloud of points on a biomass/time axis, you might get a good estimation of a growth curve, with a growth peak and a initial growth (the two most important parts in our case). This is, in essence, a ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"Wp2pFxFWOW"},{"type":"cite","url":"https://link.springer.com/chapter/10.1007/978-1-4615-7358-6_5","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"“space-for-time” substitution","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"NFyDK4bpJi"}],"kind":"narrative","label":"Pickett_1989","identifier":"https://link.springer.com/chapter/10.1007/978-1-4615-7358-6_5","enumerator":"1","key":"AlFeBJBfJm"},{"type":"text","value":", where you look at many different points in space that will be forests at different stages of growth, rather than looking at the long-term history of a few forests.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"IHCzhFTGJf"}],"key":"nYwGnhx4ae"},{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"The big limitation of this data is that you often get one “stand age” or “pixel age” value per pixel, rather than a separate age value for the trees of a given species in the pixel. As such, in a pixel of 80 years, you cannot know if the biomass of species X comes from trees that are 80 years old, or if these trees are younger. But you can interpret the upper points of the cloud of points as “the maximum biomass that a species can reach for this stand age”, which is pretty close to the mark of what you’re looking for.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"z8BWw7sVmQ"}],"key":"uctxGzXjew"},{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Another big limitation is that in most pixels (if not all), your species will be mixed with other species. This is especially true if you are calibrating a “companion” species (the type of tree species that is never abundant, but yet found in many forests). You can restrict the points of your data to only the pixels where more than 50% of the biomass comes from your species of interest; but you might not get enough points for some rarer species. In these case, you will probably need to develop a correction of biomass to try and have an estimate of the biomass that your species can reach when it composes 100% of the stand. You might do this by making a statistical model that attempts to predict the biomass of your species in a stand or pixel based on the age of the pixel, and the % of composition of the species. You might want to train your statistic model on only the top percentile of points (as you’re looking out for the most biomass your species can achieve for a given age).","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"NJhpM1oh60"}],"key":"rOKbM7uCuE"},{"type":"paragraph","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"This data is often generated through a combination of forest inventory sampling (aerial photography, etc.) and sample plot data (which are assignated to stand or pixels via assignation algorithms like the kNN method). As such, it often contains information from sample plots, but which has already been cleaned and dealt with.","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"gx7ep7K0U0"}],"key":"Q4YkVU3pqO"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"The biomass data is often expressed in biomass/surface, making it easy to compare to LANDIS-II outputs.","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"TykX7IxqQu"}],"key":"UbJol0eFbX"},{"type":"paragraph","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"This is the data I will be using here. From what I heard, other teams have been using such data in the past.","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"ShNs3HiOa7"}],"key":"vbiFHWuQny"}],"key":"nFWiEZ63kv"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"What is the spatial extent for which I should take growth data for the calibration ? And what climate data should I use depending on the origin of my growth data ?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BscYsI8RvA"}],"key":"HJsGWS40yl"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Short answer :","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"e6ZYidIUuE"}],"key":"jw8dcdTTm6"},{"type":"text","value":" I wager it’s a very complicated question, with no clear answer. You might focus only on your study area/simulated area, but there are trade-offs no matter what you choose. The important things seem to be that you need to make sure 1) you get enough empirical growth data to estimate the maximum growth initial curve and peak your species can achieve in your study area (if there is not enough data in your study area, you will need to look at a larger scale than just your study area); and 2) that the temperatures and precipitations you use during the calibration come from the area where you gathered your empirical growth data, but that they are averaged to make them mild and constant; added to a good soil type (SILO) to ensure a relatively ideal water retention; and that the temperature is a close to the optimal for your species as possible (which you can ensure by changing the ","key":"QiSm3oVi5a"},{"type":"abbreviation","title":"Optimal average daytime temperature for photosynthesis.","children":[{"type":"text","value":"PsnTOpt","key":"XpIA0F3h9V"}],"key":"CwWWVNGunG"},{"type":"text","value":" parameter temporarely).","key":"lqGl27mAAu"}],"key":"sAI4odvL7E"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Extended answer :","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PYXs25dAGT"}],"key":"BkkZcE9FLe"}],"key":"dB40pyV0JF"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The empirical growth data you’re looking for is going to be used in the first calibration step, corresponding to growth in “ideal” conditions. This step is very important, because that’s where we are going to calibrate some of the most sensitive parameters of PnET-Succession. It’s also the step where we’re going to effectively give the “upper bound” of the performance of the tree species calibrated. It’s crucial to get this upper bound right, because the algorithm and equations of PnET-Succession are mostly based on photosynthesis reduction factors (linked to light, water, age, temperature, CO2, etc.) that are going to reduce the growth of the tree species bellow this upper bound. If this upper bound is too high, you’ll overestimate the growth of the species most of the time (if not all of the time); but you can also underestimate it by setting it too low.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"TqKG6cVIFK"}],"key":"zh34CNfCa3"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The empirical growth area you’re getting here is used to have an estimate of this upper bound. It’s possible that you have enough empirical data from measurements taken inside your study area to have some good estimates; but maybe you won’t have enough data points, or no growth models available for the conditions of your study area. In that case, you’ll have to look to a larger area to get data.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"HarhyiRucm"}],"key":"NV0DZI4TpI"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"But the larger the area where you take empirical data gets, the more you get into another problem : as you are looking at more trees of your species in a larger area, you’re also looking at a higher diversity of phenotypes or traits or variants in your trees. As such, the upper bound of growth that you will be getting from this data might be from a phenotype not present in your area; or maybe you’ll be combining measures from different trees, and so maybe different phenotypes. As such, this upper bound that you’ll be estimating might still be for your tree species; but it might become an upper bound for trees that might be quite different from the ones in your area (even thought they are from the same species). It might also become an upper bound for a “soup” of different phenotypes, making it less realistic, and introducing uncertainty or potential bias. As such, the bigger is not necesserally the better : it might be best to restrict your choice of data to your study area or to a province or state or region to avoid these issues.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Iq1om33oSM"}],"key":"WCiMEoO9wi"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"With the choice of the area from which you will take your empirical growth data also comes a second question : what climate data should you use during the calibration simulation ? Again, the goal of the first calibration step (where you will use your empirical growth data) is to make sure that your species reach the right upper bound given ideal conditions. But how do we define ideal conditions in that case ? Theoritically, these should be the climate conditions that led that this upper bound you have seen in your empirical data. Problem is, you will most likely not know what was the exact climate data associate with this growth : maybe it’s because your data is a composite of points from many different places (e.g. sample plot data or forest inventory data); or maybe it’s because your data comes from a growth model that do not provide the climate data associated to a growth curve. So, what climate data should you give ?","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"mH7Af8X26T"}],"key":"OmEWe4hgs0"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The option used by ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"OUMsi6IofV"},{"type":"link","url":"/Gustafson2024PnETUse-e030ce36ecd3383f68f3a22a7353dd42.pdf","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Gustafson and Miranda (2023)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"RdyOZn0toE"}],"urlSource":"./ReferencesAndData/Documentation/Gustafson2024PnETUserGuide.pdf","static":true,"protocol":"file","key":"qL389WzulF"},{"type":"text","value":" is to use an averaged historical climate data stream (same climate every year, but changes every months based on average from historical monthly data) from your study area. To ensure a relatively ideal amount of water for the species to use during the calibration, Gustafson recommands using averaged “typical” precipitations and a soil of type SILO - which will ensure that your species have a right quantity of water, not too much, and not too little. As for temperature, Gustafson recommands cheating a bit by changing the ","key":"CHSYUD5VMk"},{"type":"abbreviation","title":"Optimal average daytime temperature for photosynthesis.","children":[{"type":"text","value":"PsnTOpt","key":"QkMio3sDtZ"}],"key":"TWydg1J3ZZ"},{"type":"text","value":" parameter of your tree species temporarely so that it matches the average of the growing season temperatures in your climate data (which would already be a constant climate every year because it would be an average climate). That, or making sure that the average growing season temperatures matches the ","key":"U1lanLCqI4"},{"type":"abbreviation","title":"Optimal average daytime temperature for photosynthesis.","children":[{"type":"text","value":"PsnTOpt","key":"SSffncSh23"}],"key":"SQaPw5BKwE"},{"type":"text","value":" of your species to begin with. This ensures that the photosynthesis of your species will be maximum. However, Gustafson points out that since you’re making the climate very mild and very “ideal” for your species, this will most likely not match the less ideal and less mild climate that generated the empirical growth data you’re using to estimate this upper bound. That is why Gustafson recommands that you should try reach a growth that is a bit above the upper bound estimated from your data in this first step, if you use his methodology.","key":"Rkvb8MYlzU"}],"key":"WKUpQsjQcJ"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"I think this approach makes a lot of sense : it solves the issue of not knowing the exact climate that is associated with the upper bound of growth derived from your empirical data by tweaking the climate data coming from your study area (or the area from which your empirical growth data comes from) so that it becomes “ideal”; but to compensate this, you’ll simply have to target a bit higher than the upper bound. How much higher ? There are no perfect answers here again, just approximation. 5-10% higher could be a good estimate with a rule-of-thumb approach.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"eC6Ni3aBhK"}],"key":"bL1P5aAPaZ"}],"key":"CmHHdyOYNr"}],"key":"og5CcbGrNL"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"What data should I use to calibrate variants, like southern variants that are more adapted to heat ? And what variant I am calibrating for if I use this methodology ?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TGVvjFar8U"}],"key":"WHQbnKoeMU"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"That’s another big question. The more local the data you use (wherever in the initial parameter values you will use, parameter range, empirical growth data, etc.), the more you will be calibrating for the local phenotypes of the area you are focusing on. Invertly, the broader the data you use spatialy (and you will most likely need to use data from many different places), the more the species you are calibrating will be a kind of “soup” of “average” of many phenotypes and variants. It won’t be the most realistic option; but that’s often the best you can do given the low density of data we have for many tree species (e.g. there is not enough data locally to get values for all parameters or good empricial growth estimates as described in the tip section above).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"u05Cdut5dU"}],"key":"FVjgYwYPJv"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Once you have calibrated your species, if you want to represent “northern” and “southern” variants that are adapted to different conditions of heat (or even different conditions of drought), you might want to change some parameters related to these aspects. In particular, by changing the parameters ","key":"Sxt473eCWY"},{"type":"abbreviation","title":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","children":[{"type":"text","value":"H1","key":"xdyLxXeOjN"}],"key":"NnrB3n3aDw"},{"type":"text","value":", ","key":"D5SpHpacKm"},{"type":"abbreviation","title":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","children":[{"type":"text","value":"H2","key":"DGWZsHe1da"}],"key":"yhwgzLfo7N"},{"type":"text","value":", ","key":"hakYoNY37W"},{"type":"abbreviation","title":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","children":[{"type":"text","value":"H3","key":"ILy80AGDjh"}],"key":"jOiAOaKQB6"},{"type":"text","value":" and ","key":"g81e8Qau10"},{"type":"abbreviation","title":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","children":[{"type":"text","value":"H4","key":"qowW8IPaZV"}],"key":"AcQuLl3A0L"},{"type":"text","value":", you will change the response of the species to different conditions of water in the soil. A variant adapted to dryier conditions will certainly have increased values of ","key":"zKJFFzKny0"},{"type":"abbreviation","title":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","children":[{"type":"text","value":"H1","key":"KpGw6GIqde"}],"key":"EJGbar9lyi"},{"type":"text","value":", ","key":"GavNWX4VZu"},{"type":"abbreviation","title":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","children":[{"type":"text","value":"H2","key":"McMdS0ClGN"}],"key":"YzuKHZgQs9"},{"type":"text","value":", ","key":"xa3LLVwpFt"},{"type":"abbreviation","title":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","children":[{"type":"text","value":"H3","key":"bywHGNM5Bb"}],"key":"TXuH5CNofI"},{"type":"text","value":" and ","key":"VaR5ejKFy1"},{"type":"abbreviation","title":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","children":[{"type":"text","value":"H4","key":"Ff614aZp6q"}],"key":"s380qXR3hV"},{"type":"text","value":" overall (can pump more water from the soil where pressure is low; but is also more sensitive to waterlogging). For temperature, you will most likely need to change ","key":"ZihPYXYVNG"},{"type":"abbreviation","title":"Minimum average daytime temperature for photosynthesis.","children":[{"type":"text","value":"PsnTMin","key":"CRF1sJfK64"}],"key":"HLa5JR1a51"},{"type":"text","value":", ","key":"mWo0cw9PkX"},{"type":"abbreviation","title":"Optimal average daytime temperature for photosynthesis.","children":[{"type":"text","value":"PsnTOpt","key":"Mh1s0OOLwG"}],"key":"JwS6ozX7g6"},{"type":"text","value":", and ","key":"Ef81hk4V3N"},{"type":"abbreviation","title":"Maximum average daytime temperature for photosynthesis.","children":[{"type":"text","value":"PsnTMax","key":"WV7dGXbrs3"}],"key":"tR3u5OUX9V"},{"type":"text","value":". Gustafson notes in ","key":"B7ulfVSqfM"},{"type":"link","url":"/Gustafson2024PnETUse-e030ce36ecd3383f68f3a22a7353dd42.pdf","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Gustafson and Miranda (2023)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fquSW6vmlI"}],"urlSource":"./ReferencesAndData/Documentation/Gustafson2024PnETUserGuide.pdf","static":true,"protocol":"file","key":"LcZsaBeC5w"},{"type":"text","value":" : ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"OGISMUdtnr"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"I use ","key":"R9Sb2aLoAG"},{"type":"abbreviation","title":"Maximum average daytime temperature for photosynthesis.","children":[{"type":"text","value":"PsnTMax","key":"MAfHqA2l9y"}],"key":"GYBnaVrn2d"},{"type":"text","value":" to make more northerly species less competitive than southerly species as climate warms.","key":"rn0KW4mNdC"}],"key":"BElZSK2a4D"},{"type":"text","value":" You can also slightly change ","key":"g4b5TKySRf"},{"type":"abbreviation","title":"Optimal average daytime temperature for photosynthesis.","children":[{"type":"text","value":"PsnTOpt","key":"vChnh5Xc9k"}],"key":"YkmlnbLMdX"},{"type":"text","value":", which indicates the optimum temperature for the species. How much you increase or decrease these values is up to your interpretation; you can compare to other species, but you can also look at the average temperatures for the growing season at the latitude corresponding to the center of the range distribution of your variant.","key":"nFeKc9FnJb"}],"key":"KJONh83xbA"}],"key":"PuE9ZnJ3K7"}],"key":"Mq8snNGin3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Option used here : data from the National Forest Inventory of Canada","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T9P2cnbUGC"}],"identifier":"option-used-here-data-from-the-national-forest-inventory-of-canada","label":"Option used here : data from the National Forest Inventory of Canada","html_id":"option-used-here-data-from-the-national-forest-inventory-of-canada","implicit":true,"key":"NOuLbjzcj3"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"See :","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fkRxKCNeHC"}],"key":"q3Gvnq349B"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"link","url":"https://nfi.nfis.org/en/","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[],"urlSource":"https://nfi.nfis.org/en/","key":"h8lsGyZhwq"},{"type":"text","value":" for general information and visualisation of some of the maps","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"d8lxEjx56t"}],"key":"PYweNdiiyQ"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://open.canada.ca/data/en/dataset/ec9e2659-1c29-4ddb-87a2-6aced147a990","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[],"urlSource":"https://open.canada.ca/data/en/dataset/ec9e2659-1c29-4ddb-87a2-6aced147a990","key":"IuRr93XGRr"},{"type":"text","value":" to download the maps","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DpPS2Hx9z0"}],"key":"GjwdvQq78v"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"cite","url":"https://cdnsciencepub.com/doi/10.1139/cjfr-2017-0184","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Beaudoin ","key":"Aa49KOSlzk"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"T7ZuUziIIJ"}],"key":"XBqL90JFEb"},{"type":"text","value":" (2018)","key":"NlbRbV0GIc"}],"kind":"narrative","label":"Beaudoin_2018","identifier":"https://cdnsciencepub.com/doi/10.1139/cjfr-2017-0184","enumerator":"2","key":"JWtIGkwCoN"},{"type":"text","value":" for details about how the maps were generated.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"mSNuHBdYn2"}],"key":"oMkLyVDAmd"}],"key":"D1yiDDctQg"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Here, I’m using data from the most recent year (2011). I’m using the map ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"rEt8rXgNGv"},{"type":"inlineCode","value":"/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"bre6VI7R0q"},{"type":"text","value":" for the stand (pixel) ages; ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"XDZWY0YTfZ"},{"type":"inlineCode","value":"/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"l8Lo3qSHBm"},{"type":"text","value":" for biomass of stands; and a series of rasters like ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"m5pCxIAqXR"},{"type":"inlineCode","value":"/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Abie_Bal_v1.tif","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"wy23Cr98mT"},{"type":"text","value":" that indicate the propotion of ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"DU7oxVw1am"},{"type":"inlineCode","value":"/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Oizdrn7vrc"},{"type":"text","value":" that corresponds to the species of interest (e.g. ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"eDojnrgY6W"},{"type":"emphasis","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"UXwnzMifDf"}],"key":"aXQOADolsG"},{"type":"text","value":" in that case). All maps are currently in ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"MKkx3aFcTy"},{"type":"inlineCode","value":"./ReferencesAndData","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ZhWciZcdI0"},{"type":"text","value":".","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"CfeE7bextH"}],"key":"HRMgmAgoRx"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"I’m also using several “mask” rasters to restrict or differenciate the pixel data from different provinces in Canada (e.g. ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"AG2EhtBxGd"},{"type":"inlineCode","value":"quebecMask.tif","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Rv0n02LGZB"},{"type":"text","value":", etc., all in ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"JFjlbq6xc0"},{"type":"inlineCode","value":"./ReferencesAndData","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ZAhTRY7Cov"},{"type":"text","value":").","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"NKlU4KiQNP"}],"key":"qt4r6HKonD"}],"key":"JBoHdoplyr"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here, before we use this dataset, I quickly show how it looks like by focusing on the highest points of the point clouds that it produces. Focusing on these highest points will give us an idea of the “best growth” that the species can achieve through by looking at different pixels from the same year throughout all of Canada.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wIdZvzdFbh"}],"key":"mAdXtocixN"}],"key":"Lv4Mf0e2NN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# We read data from the NFI for our free species, and plot the distribution of the points above 95% of the maximum value in\n# each 3 years window (which allows us to keep the top points)\nfrom functionsForCalibration import *\nimport matplotlib.pyplot as plt\n\n\n# We define the path to where the rasters are\nspecies_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Abie_Bal_v1.tif\"\nage_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif\"\nbiomass_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif\"\n# We define the paths to the mask rasters for each province\ndictOfMasks = {\"NS\":\"./ReferencesAndData/SpatialBoundaries/novaScotiaMask.tif\",\n              \"QC\":\"./ReferencesAndData/SpatialBoundaries/quebecMask.tif\",\n              \"ON\":\"./ReferencesAndData/SpatialBoundaries/ontarioMask.tif\",\n              \"MT\":\"./ReferencesAndData/SpatialBoundaries/manitobaMask.tif\",\n              \"SK\":\"./ReferencesAndData/SpatialBoundaries/saskatchewanMask.tif\",\n              \"AB\":\"./ReferencesAndData/SpatialBoundaries/albertaMask.tif\",\n              \"BC\":\"./ReferencesAndData/SpatialBoundaries/britishColumbiaMask.tif\",}\n\n\nplottingNFISpeciesUpperBiomassByProvince(species_path,\n                                         age_path,\n                                         biomass_path,\n                                         \"Abies balsamea\",\n                                         dictOfMasks)","key":"c6gkxgCKJq"},{"type":"output","id":"ez43rLcv0LcectquG5lhN","data":[{"name":"stdout","output_type":"stream","text":"Reading species raster...\nReading age raster...\nReading biomass raster...\nDealing with NS\n"},{"name":"stderr","output_type":"stream","text":"/usr/local/lib/python3.10/dist-packages/numpy/ma/core.py:1020: RuntimeWarning: overflow encountered in multiply\n  result = self.f(da, db, *args, **kwargs)\n"},{"name":"stdout","output_type":"stream","text":"Dealing with QC\nDealing with ON\nDealing with MT\nDealing with SK\nDealing with AB\nDealing with BC\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"99c0650e6247135da6ad41df1b934932","path":"/99c0650e6247135da6ad41df1b934932.png"},"text/plain":{"content":"<Figure size 1000x800 with 1 Axes>","content_type":"text/plain"}}}],"key":"Iddj78LYXw"}],"key":"EwWhxyWbwp"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As such, we can see that :","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Wyk624Z7qY"}],"key":"Sdmm39oaot"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The NFI data shows some pretty clear growth patterns (initial growth, peak, senescence)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mtAkCrJ3F7"}],"key":"gydTr3gwN7"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We see that the different provinces can have very different growth peaks and initial growth/senescence. Upon closer inspection (plotting again but only for points with at least 50% of biomass composed of ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Nh4K5Y1RNd"},{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ayjiIW7u4R"}],"key":"bo0EeLZhAo"},{"type":"text","value":"), it seems to mostly be due to the differences in the mixture/competition of the species in difference province. SK, AB, MT and BC don’t have many points where ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"d6wnsCTELN"},{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"HHXsZGftpk"}],"key":"bYNzlUdF9k"},{"type":"text","value":" is dominant. Meanwhile, NS, QC and ON have a lot of it.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"BwrH6AU1oE"}],"key":"pXYEJjUIf6"}],"key":"HRVMaYu09v"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Now, here are the same figures for the other species :","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jxCk7aA2Il"}],"key":"OLDWIrFPGf"}],"key":"fDdkfIbSH7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# We define the path to where the rasters are\nspecies_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Pice_Mar_v1.tif\"\nage_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif\"\nbiomass_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif\"\n\nplottingNFISpeciesUpperBiomassByProvince(species_path,\n                                         age_path,\n                                         biomass_path,\n                                         \"Acer rubrum\",\n                                         dictOfMasks)","key":"cCwnxGcl91"},{"type":"output","id":"K7E78o6ElkcYLaRcrguRc","data":[{"name":"stdout","output_type":"stream","text":"Reading species raster...\nReading age raster...\nReading biomass raster...\nDealing with NS\nDealing with QC\nDealing with ON\nDealing with MT\nDealing with SK\nDealing with AB\nDealing with BC\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6e3bd5072c7a270d1a580b23f221aff8","path":"/6e3bd5072c7a270d1a580b23f221aff8.png"},"text/plain":{"content":"<Figure size 1000x800 with 1 Axes>","content_type":"text/plain"}}}],"key":"ZUujfRDVSQ"}],"key":"dInHnKcTX7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# We define the path to where the rasters are\nspecies_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Acer_Rub_v1.tif\"\nage_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif\"\nbiomass_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif\"\n\nplottingNFISpeciesUpperBiomassByProvince(species_path,\n                                         age_path,\n                                         biomass_path,\n                                         \"Picea mariana\",\n                                         dictOfMasks)","key":"UW6LFBFCzm"},{"type":"output","id":"w5303Hbax8ipjjKG6saeJ","data":[{"name":"stdout","output_type":"stream","text":"Reading species raster...\nReading age raster...\nReading biomass raster...\nDealing with NS\nDealing with QC\nDealing with ON\nDealing with MT\nDealing with SK\nDealing with AB\nDealing with BC\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"dd07370cc1ad32d4816e922c5ccee6f2","path":"/dd07370cc1ad32d4816e922c5ccee6f2.png"},"text/plain":{"content":"<Figure size 1000x800 with 1 Axes>","content_type":"text/plain"}}}],"key":"RUib7etrL1"}],"key":"kR6ezlpEpA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can again see some pretty clear patterns for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zi9XtnjhEJ"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cNe2XUuxcn"}],"key":"sfgUYOW0n6"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O2XGrRDJ11"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Picea mariana","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RMLAhoDhYM"}],"key":"wlh1QZnkeK"},{"type":"text","value":". As such, this dataset should do.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dnu5W1JTRW"}],"key":"Yoxqs9UlBh"}],"key":"ou7CeztRDf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves in ideal conditions (in Canada) for our species with NFI data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"al1ZRNB6OA"}],"identifier":"producing-estimated-growth-curves-in-ideal-conditions-in-canada-for-our-species-with-nfi-data","label":"Producing estimated growth curves in ideal conditions (in Canada) for our species with NFI data","html_id":"producing-estimated-growth-curves-in-ideal-conditions-in-canada-for-our-species-with-nfi-data","implicit":true,"key":"EZH2fTm08T"}],"key":"k6IF57ZTff"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Based on the NFI data shown and explored in the previous section, we now have to produce estimated growth curves based on this data that we will be able to use as a “target” for the first step of the calibration of PnET-Succession, where we will try to match the curves produced by PnET-Succession with the data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ABvhsenD3Y"}],"key":"iZH9sW2FFl"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We could of course simply plot the curves produced by PnET-Succession onto the data points directly, and estimate visually if the fit is good. But I prefer to produce curves that we can use to automatize the calibration process (with a curve, we can compute the difference between the PnET-Succession curve and the one we have from the data).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vH08xkv5wG"}],"key":"ez6TqbYXRj"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"I’ve ended up making two sets of curves with two different methods :","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"nO6maN5iOn"}],"key":"Zm6Xd0CK78"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The first one is a simple algorithm that builds a curve based on a set of rules to go from data point to data point, and then smooth the curve.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Jvi8zgWoRG"}],"key":"ltPAV5AtuZ"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"The second one uses a Generalized Additive Model (GAM) fitted on pre-processed data. The GAM is then used to generate curves of biomass for different levels of abundance.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"zekAI06rXn"}],"key":"owMt06ek3z"}],"key":"X3KCuYORpR"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"In the next sections, I’ll briefly describe both methods and show the curves produced by each before comparing the curves from both methods.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"I0arbeKs17"}],"key":"GU7KBnQyJu"}],"key":"FkOPJ4JL11"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing growth curves from NFI data with a simple curve-construction algorithm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AFwqkXuC98"}],"identifier":"producing-growth-curves-from-nfi-data-with-a-simple-curve-construction-algorithm","label":"Producing growth curves from NFI data with a simple curve-construction algorithm","html_id":"producing-growth-curves-from-nfi-data-with-a-simple-curve-construction-algorithm","implicit":true,"key":"kwtbUGvGLN"}],"visibility":"show","key":"Q2XHUaj0Di"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"I’ve used a relatively simple algorithim to estimate these curves based on the data :","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O8zhdHDCNV"}],"key":"uRaypv2blE"},{"type":"image","url":"/Algorithm_GrowthCurv-fc445ac3fd5e0813654caa5495dcaf2b.png","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"S0nK4VrANZ","urlSource":"./Images/Algorithm_GrowthCurves_NFI.png"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We will save these curves in ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"D5qyeEFPiu"},{"type":"inlineCode","value":".csv","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cs8cljq6Ct"},{"type":"text","value":" files so that we can use them later during the calibration.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"S7ezEQbtPL"}],"key":"nGqbuGh4ME"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"To learn more, take a look at the function ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"aVTKdruQE6"},{"type":"inlineCode","value":"analyze_species_growth_curves","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"A5CDX10YzM"},{"type":"text","value":" in ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mARzS7n7sq"},{"type":"link","url":"/functionsForCalibrat-b40081e509ffb38bec265f38bc99c65a.py","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"functionsForCalibration​.py","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jshlxalFuY"}],"urlSource":"./functionsForCalibration.py","static":true,"protocol":"file","key":"MgDSqytvpk"},{"type":"text","value":".","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"K5ts0D4GSG"}],"key":"RAsVBSLUfk"}],"visibility":"show","key":"N4u4C3HuUZ"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"heading","depth":6,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sOtmIsaOy9"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ubSgLd62Oc"}],"key":"m8LxBSnA1x"},{"type":"text","value":" with the curve-construction algorithm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CqhCMhcWpn"}],"identifier":"producing-estimated-growth-curves-for-abies-balsamea-with-the-curve-construction-algorithm","label":"Producing estimated growth curves for Abies balsamea with the curve-construction algorithm","html_id":"producing-estimated-growth-curves-for-abies-balsamea-with-the-curve-construction-algorithm","implicit":true,"key":"mHMZzCjedd"}],"visibility":"show","key":"Q0yccC2d96"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from functionsForCalibration import *\n\nresults = analyze_species_growth_curves(\n    prevalence_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Abie_Bal_v1.tif',\n    age_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif',\n    biomass_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif',\n    species_name='Abies balsamea',\n    output_csv_path='./ReferencesAndData/Growth Curves Predictions/abies_balsamea_estimated_growth_curves_NFI.csv',\n    prevalence_thresholds=[100, 80, 60, 40, 20],\n    peak_age_min=0,\n    peak_age_max=100,\n    senescence_age_window=5,\n    outlier_age_window=5,\n    outlier_percentile=100, # Don't remove any outlier for now\n    smoothing_window=200,\n    smoothing_polyorder=5,\n    n_sample_plot=2000000,\n    create_plot=True,\n    plot_figsize=(20, 8)\n)","key":"WBZITEI7v1"},{"type":"output","id":"TDWouo1s8_2XCthZ44K72","data":[{"name":"stdout","output_type":"stream","text":"=== Abies balsamea Growth Curve Analysis with Prevalence Thresholds ===\nParameters:\n  Peak search range: 0-100 years\n  Senescence age window: 5 years\n  Outlier removal: 5-year windows, 100% threshold\n  Smoothing window: 200 points\n  Prevalence thresholds: [100, 80, 60, 40, 20]\nReading raster files...\n✓ Rasters loaded successfully\nProcessing data and applying masks...\n✓ 32674827 valid pixels found\nRemoving outliers (age window: 5 years, percentile: 100%)...\nProcessing 70 age windows...\n"},{"name":"stderr","output_type":"stream","text":"Processing age windows: 100%|██████████████████████████████████████████████████████████| 70/70 [00:03<00:00, 22.67it/s]\n"},{"name":"stdout","output_type":"stream","text":"✓ 32674827 pixels remaining after outlier removal\n\nProcessing curves for each prevalence threshold...\n\n--- Processing threshold 100% ---\n  Threshold 100%: 32674827 points remaining (100.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 100%: 116 raw points, 286 smoothed points\n\n--- Processing threshold 80% ---\n  Threshold 80%: 32638147 points remaining (99.9% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 80%: 119 raw points, 286 smoothed points\n\n--- Processing threshold 60% ---\n  Threshold 60%: 32479798 points remaining (99.4% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 60%: 120 raw points, 286 smoothed points\n\n--- Processing threshold 40% ---\n  Threshold 40%: 31891113 points remaining (97.6% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 40%: 129 raw points, 286 smoothed points\n\n--- Processing threshold 20% ---\n  Threshold 20%: 27611936 points remaining (84.5% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 20%: 121 raw points, 286 smoothed points\n\nCreating CSV output...\n✓ CSV saved to: ./ReferencesAndData/Growth Curves Predictions/abies_balsamea_estimated_growth_curves_NFI.csv\nSampling 2000000 points with prevalence-based weighting...\n✓ Sampled 2000000 points (avg prevalence: 21.8%)\n\nCreating visualization...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cc4cf000457ada919ca0dfabc8fadfd0","path":"/cc4cf000457ada919ca0dfabc8fadfd0.png"},"text/plain":{"content":"<Figure size 2000x800 with 4 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"\n=== Analysis Complete ===\nTotal processing time: 108.3 seconds\nProcessed 32674827 pixels total\nCSV saved to: ./ReferencesAndData/Growth Curves Predictions/abies_balsamea_estimated_growth_curves_NFI.csv\n\nCurve Summary:\n  Threshold ≤20%: Peak 31.11 tons/ha at age 74.0 (27611936 points)\n  Threshold ≤40%: Peak 55.17 tons/ha at age 72.0 (31891113 points)\n  Threshold ≤60%: Peak 73.65 tons/ha at age 71.0 (32479798 points)\n  Threshold ≤80%: Peak 88.76 tons/ha at age 72.0 (32638147 points)\n  Threshold ≤100%: Peak 93.02 tons/ha at age 67.0 (32674827 points)\n"}],"key":"YC0yp34Vgc"}],"key":"e0g78IoxYb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":6,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JUoEozBdOR"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VYEiJolxPZ"}],"key":"ip8fFaDi4z"},{"type":"text","value":" with the curve-construction algorithm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jCzUy86vMQ"}],"identifier":"producing-estimated-growth-curves-for-acer-rubrum-with-the-curve-construction-algorithm","label":"Producing estimated growth curves for Acer rubrum with the curve-construction algorithm","html_id":"producing-estimated-growth-curves-for-acer-rubrum-with-the-curve-construction-algorithm","implicit":true,"key":"Rqa6qs5bQ3"}],"key":"hpzXCCDN3k"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from functionsForCalibration import *\n\nresults = analyze_species_growth_curves(\n    prevalence_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Acer_Rub_v1.tif',\n    age_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif',\n    biomass_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif',\n    species_name='Acer rubrum',\n    output_csv_path='./ReferencesAndData/Growth Curves Predictions/acer_rubrum_estimated_growth_curves_NFI.csv',\n    prevalence_thresholds=[100, 80, 60, 40, 20],\n    peak_age_min=0,\n    peak_age_max=100,\n    senescence_age_window=5,\n    outlier_age_window=5,\n    outlier_percentile=100, # Don't remove any outlier for now\n    smoothing_window=200,\n    smoothing_polyorder=5,\n    n_sample_plot=2000000,\n    create_plot=True,\n    plot_figsize=(20, 8)\n)","key":"Cjl01UgrHW"},{"type":"output","id":"lWLFTkOqScJ-aWEVY9J3f","data":[{"name":"stdout","output_type":"stream","text":"=== Acer rubrum Growth Curve Analysis with Prevalence Thresholds ===\nParameters:\n  Peak search range: 0-100 years\n  Senescence age window: 5 years\n  Outlier removal: 5-year windows, 100% threshold\n  Smoothing window: 200 points\n  Prevalence thresholds: [100, 80, 60, 40, 20]\nReading raster files...\n✓ Rasters loaded successfully\nProcessing data and applying masks...\n✓ 8337062 valid pixels found\nRemoving outliers (age window: 5 years, percentile: 100%)...\nProcessing 51 age windows...\n"},{"name":"stderr","output_type":"stream","text":"Processing age windows: 100%|██████████████████████████████████████████████████████████| 51/51 [00:00<00:00, 100.27it/s]\n"},{"name":"stdout","output_type":"stream","text":"✓ 8337062 pixels remaining after outlier removal\n\nProcessing curves for each prevalence threshold...\n\n--- Processing threshold 100% ---\n  Threshold 100%: 8337062 points remaining (100.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 100%: 96 raw points, 185 smoothed points\n\n--- Processing threshold 80% ---\n  Threshold 80%: 8337062 points remaining (100.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 80%: 96 raw points, 185 smoothed points\n\n--- Processing threshold 60% ---\n  Threshold 60%: 8337061 points remaining (100.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 60%: 96 raw points, 185 smoothed points\n\n--- Processing threshold 40% ---\n  Threshold 40%: 8312061 points remaining (99.7% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 40%: 92 raw points, 185 smoothed points\n\n--- Processing threshold 20% ---\n  Threshold 20%: 7763982 points remaining (93.1% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 20%: 93 raw points, 185 smoothed points\n\nCreating CSV output...\n✓ CSV saved to: ./ReferencesAndData/acer_rubrum_estimated_growth_curves_NFI.csv\nSampling 2000000 points with prevalence-based weighting...\n✓ Sampled 2000000 points (avg prevalence: 13.1%)\n\nCreating visualization...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"aa10c038066db7b1655fa5c903bd4517","path":"/aa10c038066db7b1655fa5c903bd4517.png"},"text/plain":{"content":"<Figure size 2000x800 with 4 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"\n=== Analysis Complete ===\nTotal processing time: 67.3 seconds\nProcessed 8337062 pixels total\nCSV saved to: ./ReferencesAndData/acer_rubrum_estimated_growth_curves_NFI.csv\n\nCurve Summary:\n  Threshold ≤20%: Peak 31.89 tons/ha at age 70.0 (7763982 points)\n  Threshold ≤40%: Peak 48.14 tons/ha at age 62.0 (8312061 points)\n  Threshold ≤60%: Peak 50.80 tons/ha at age 62.0 (8337061 points)\n  Threshold ≤80%: Peak 50.77 tons/ha at age 62.0 (8337062 points)\n  Threshold ≤100%: Peak 50.77 tons/ha at age 62.0 (8337062 points)\n"}],"key":"pWBE3cTLkw"}],"key":"gPXhpSkZd3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":6,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ettJeVxW0a"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Picea mariana","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KH7lseph5t"}],"key":"DD1Hsc9Ssw"},{"type":"text","value":" with the curve-construction algorithm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YhnHSVuYMC"}],"identifier":"producing-estimated-growth-curves-for-picea-mariana-with-the-curve-construction-algorithm","label":"Producing estimated growth curves for Picea mariana with the curve-construction algorithm","html_id":"producing-estimated-growth-curves-for-picea-mariana-with-the-curve-construction-algorithm","implicit":true,"key":"hsfUYqE1Mq"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We’re taking a look at our third species, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CcskBtPEnM"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Picea mariana","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"q2mMIf5BoH"}],"key":"ClmM5KpPzu"},{"type":"text","value":". Same protocol as previous section with ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AMlfwyQxxV"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mf6G940G7z"}],"key":"MlyJk6b7kw"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Qyj4MoSTqp"}],"key":"O50hC4jk6D"}],"key":"JgaH33QYxE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from functionsForCalibration import *\n\nresults = analyze_species_growth_curves(\n    prevalence_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Pice_Mar_v1.tif',\n    age_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif',\n    biomass_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif',\n    species_name='Picea Mariana',\n    output_csv_path='./ReferencesAndData/Growth Curves Predictions/picea_mariana_estimated_growth_curves_NFI.csv',\n    prevalence_thresholds=[100, 80, 60, 40, 20],\n    peak_age_min=0,\n    peak_age_max=200, # Peak is a bit later for Picea mariana compared to Abies balsamea and Acer rubrum\n    senescence_age_window=5,\n    outlier_age_window=5,\n    outlier_percentile=100, # Don't remove any outlier for now\n    smoothing_window=200,\n    smoothing_polyorder=5,\n    n_sample_plot=2000000,\n    create_plot=True,\n    plot_figsize=(20, 8)\n)","key":"RcHwtMkzaV"},{"type":"output","id":"2gcMX0SSjTlNfc1jD-46N","data":[{"name":"stdout","output_type":"stream","text":"=== Picea Mariana Growth Curve Analysis with Prevalence Thresholds ===\nParameters:\n  Peak search range: 0-200 years\n  Senescence age window: 5 years\n  Outlier removal: 5-year windows, 100% threshold\n  Smoothing window: 200 points\n  Prevalence thresholds: [100, 80, 60, 40, 20]\nReading raster files...\n✓ Rasters loaded successfully\nProcessing data and applying masks...\n✓ 80116986 valid pixels found\nRemoving outliers (age window: 5 years, percentile: 100%)...\nProcessing 70 age windows...\n"},{"name":"stderr","output_type":"stream","text":"Processing age windows: 100%|██████████████████████████████████████████████████████████| 70/70 [00:07<00:00,  9.66it/s]\n"},{"name":"stdout","output_type":"stream","text":"✓ 80116986 pixels remaining after outlier removal\n\nProcessing curves for each prevalence threshold...\n\n--- Processing threshold 100% ---\n  Threshold 100%: 80116986 points remaining (100.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 100%: 124 raw points, 295 smoothed points\n\n--- Processing threshold 80% ---\n  Threshold 80%: 71328226 points remaining (89.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 80%: 120 raw points, 295 smoothed points\n\n--- Processing threshold 60% ---\n  Threshold 60%: 58280657 points remaining (72.7% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 60%: 121 raw points, 295 smoothed points\n\n--- Processing threshold 40% ---\n  Threshold 40%: 44835036 points remaining (56.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 40%: 104 raw points, 295 smoothed points\n\n--- Processing threshold 20% ---\n  Threshold 20%: 21607588 points remaining (27.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 20%: 96 raw points, 281 smoothed points\n\nCreating CSV output...\n✓ CSV saved to: ./ReferencesAndData/Growth Curves Predictions/picea_mariana_estimated_growth_curves_NFI.csv\nSampling 2000000 points with prevalence-based weighting...\n✓ Sampled 2000000 points (avg prevalence: 58.9%)\n\nCreating visualization...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"aee705277451a88bc310ea1938dc9dd6","path":"/aee705277451a88bc310ea1938dc9dd6.png"},"text/plain":{"content":"<Figure size 2000x800 with 4 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"\n=== Analysis Complete ===\nTotal processing time: 189.5 seconds\nProcessed 80116986 pixels total\nCSV saved to: ./ReferencesAndData/Growth Curves Predictions/picea_mariana_estimated_growth_curves_NFI.csv\n\nCurve Summary:\n  Threshold ≤20%: Peak 58.37 tons/ha at age 151.0 (21607588 points)\n  Threshold ≤40%: Peak 80.00 tons/ha at age 164.0 (44835036 points)\n  Threshold ≤60%: Peak 106.50 tons/ha at age 122.0 (58280657 points)\n  Threshold ≤80%: Peak 139.02 tons/ha at age 122.0 (71328226 points)\n  Threshold ≤100%: Peak 162.61 tons/ha at age 130.0 (80116986 points)\n"}],"key":"UEycoK2olt"}],"key":"pjHhqGVN6d"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing growth curves from NFI data with a Generalized Additive Model (GAM)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ywAG7ZEPFc"}],"identifier":"producing-growth-curves-from-nfi-data-with-a-generalized-additive-model-gam","label":"Producing growth curves from NFI data with a Generalized Additive Model (GAM)","html_id":"producing-growth-curves-from-nfi-data-with-a-generalized-additive-model-gam","implicit":true,"key":"XexOMK4eem"}],"key":"H4qjcXmBN8"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here, we process the data in order to identify the highest percentiles of biomass for each species for set of successive age windows and abundance windows (see figure below). Once we have identified these percentile, we use a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KMQHtbG5zx"},{"type":"link","url":"https://en.wikipedia.org/wiki/Generalized_additive_model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generalize Additive Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dAEWrjbMgw"}],"urlSource":"https://en.wikipedia.org/wiki/Generalized_additive_model","data":{"page":"Generalized_additive_model","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"H9J9sBsFqU"},{"type":"text","value":" (GAM) fitted on this processed data in order to predict the percentile values as a fonction of age, but also of the percentage of abundance of the species in a cell. GAMs are dealt with using the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n8HeDJBjIu"},{"type":"link","url":"https://pygam.readthedocs.io/en/latest/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"pyGAM package","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RLbzvfmCKe"}],"urlSource":"https://pygam.readthedocs.io/en/latest/","key":"vn8Gb7pSUF"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CAxxkgTItT"}],"key":"CdllPAGdm4"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This is essential for species like ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kcliEAjF6J"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Pcs6qA57xa"}],"key":"b33zxk2WX8"},{"type":"text","value":" in our dataset for which most of the pixels where the species is present do not have a high abundance for the species; for the great majority of pixels values for ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Al2Fx6i5n4"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Kxykpyn33B"}],"key":"mBDpOUDNZb"},{"type":"text","value":", we do not go beyond 60% of abundance of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dsgOa0MEiY"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"umeke23LqC"}],"key":"ZGHxxxf2ov"},{"type":"text","value":" in the stand (see figures above). However, remember that our goal here is to estimate (as much as can be) the growth of the species in ideal conditions, which includes no competition for light from other species, meaning in monoculture (100% abundance).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HPCVC2uxoA"}],"key":"ehPE2ZnGup"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The use of a GAM allows us to make predictions about what would be the growth of the species in condition of full abundance (100%)/monoculture, even though we have no data or few data points/pixels with such an abundance.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SNh7uGuuE1"}],"key":"m37xik5mMt"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The issue is that fitting a GAM on the NFI data was more difficult than I expected; because of the space-for-time substitution we’re doing and the fact that we’re looking at data from the entire province, it seems that the patterns in the data (e.g. effect of age and abundance on biomass) can seem quite clear to the human eye, but can be difficult to mirror properly in a GAM. The overabundance of low-abundance pixels, and also the presence of some high-abundance pixels with relatively low biomass values and other outliers tended to create unexpected and absurd GAM behaviour.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"aCPGgr1PtF"}],"key":"c49xySRe96"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"I solved this issue by pre-processing the data (see figure below) to 1) reduce the number of points, 2) remove the outliers, and 3) force a monotonic increasing rule regarding the effect of abundance of the high percentiles of biomass. This pre-processing is highly customizible, allowing you to define the size of the windows, the percentile computed, or to exclude certain pixels; see the function ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"HlQX5IGSAW"},{"type":"inlineCode","value":"prepareNFIDataForGAMs","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"D1rf6Uohgs"},{"type":"text","value":". The fitting of the GAM can also be customised.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"n1lkxkLMOn"}],"key":"Rv84nm1grB"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The best GAM structure I’ve found so far to produce these curve is the following :","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"yxMavS42B0"}],"key":"eoDFn17ups"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"inlineMath","value":"\\text{High Biomass Percentile} = s(age, \\text{with a concave constraint}) + interaction(age, \\% abundance, \\text{with a concave constraint})","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>High Biomass Percentile</mtext><mo>=</mo><mi>s</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mi>g</mi><mi>e</mi><mo separator=\"true\">,</mo><mtext>with a concave constraint</mtext><mo stretchy=\"false\">)</mo><mo>+</mo><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mi>g</mi><mi>e</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">%</mi><mi>a</mi><mi>b</mi><mi>u</mi><mi>n</mi><mi>d</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mo separator=\"true\">,</mo><mtext>with a concave constraint</mtext><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\text{High Biomass Percentile} = s(age, \\text{with a concave constraint}) + interaction(age, \\% abundance, \\text{with a concave constraint})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">High Biomass Percentile</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">with a concave constraint</span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">in</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">er</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">%</span><span class=\"mord mathnormal\">ab</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">an</span><span class=\"mord mathnormal\">ce</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">with a concave constraint</span></span><span class=\"mclose\">)</span></span></span></span>","key":"duvuIZECea"}],"key":"OvhSsEBxRy"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The concave constrait force the effect of age and the 2D plane of the interaction effect (tensor product) of age and % abundance to be concave, which matches the biological reality that after a certain age, the biomass of the species will decrease.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"XrskzrzGT3"}],"key":"aF6L0G7kZw"},{"type":"image","url":"/GAM_DataProessing_NF-3357e4b65ceb134f9c46dd8300697344.PNG","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"KXOH15VeFo","urlSource":"./Images/GAM_DataProessing_NFI_Method.PNG"}],"key":"Cntuyvn2II"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":6,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EB3YKvTbwJ"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jYO6BGNvBG"}],"key":"etp0ICXDkG"},{"type":"text","value":" with a GAM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SohMSCYPGy"}],"identifier":"producing-estimated-growth-curves-for-abies-balsamea-with-a-gam","label":"Producing estimated growth curves for Abies balsamea with a GAM","html_id":"producing-estimated-growth-curves-for-abies-balsamea-with-a-gam","implicit":true,"key":"Rx23yAtsML"}],"key":"hajDlXR5DP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from functionsForCalibration import *\n\nwindowed_df = prepareNFIDataForGAMs(abundance_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Abie_Bal_v1.tif',\n                                  age_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif',\n                                  biomass_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif',\n                                  speciesName = \"Abies balsamea\",\n                                  age_window = 5,\n                                  abundance_window = 10,\n                                  percentile = 100,\n                                  mask_path = None,\n                                  printPlot = False)\n\ncreateGAMsAndPredictionsForNFIDataGrowthCurves(windowed_df,\n                                                './ReferencesAndData/Growth Curves Predictions/Abies Balsamea_gam_predictions.csv',\n                                               \"Abies balsamea\",\n                                                cutoff_age = 150,\n                                                abundance_levels = [100, 80, 60, 40, 20],\n                                                printPlot = True)","key":"Y9qcaIYXMq"},{"type":"output","id":"1JrUletzWxCLQkoBtDQ7W","data":[{"name":"stdout","output_type":"stream","text":"Reading raster data...\nCreating initial dataframe...\nInitial dataframe shape: (32674827, 3)\nAge range: 0.0 - 348.4\nAbundance range: 0.0 - 100.0\n\nProcessing with parameters:\nAge window: 5\nAbundance window: 10\nPercentile: 100\n\nCreating windowed dataframe...\nApplied monotonic abundance constraint - kept 350 entries\nWindowed dataframe shape: (350, 3)\nNo data points found in the specified windows!\nFiltering data by age cutoff...\nOriginal dataframe shape: (350, 3)\nFiltered dataframe shape (Age < 150): (236, 3)\nFiltered age range: 0.0 - 147.5\nFiltered abundance range: 5.0 - 95.0\n\nFitting weighted GAM model...\ndid not converge\nGAM fitted successfully with constraints and abundance weighting!\nGAM summary:\n  - Number of observations: 236\n  - R-squared (pseudo): 0.943\n  - Constraints applied:\n    * Age effect: concave\n    * Tensor product interaction: concave\n    * Intercept forced to 0\n    * Weighted toward high abundance observations\n\nGenerating predictions for abundance levels: [100, 80, 60, 40, 20]\nGenerated predictions for 100% abundance:\n  - Biomass range: 11.86 - 95.97\n  - Value at age 0: 11.856283\nGenerated predictions for 80% abundance:\n  - Biomass range: 7.58 - 91.05\n  - Value at age 0: 7.575023\nGenerated predictions for 60% abundance:\n  - Biomass range: 1.93 - 85.51\n  - Value at age 0: 1.934564\nGenerated predictions for 40% abundance:\n  - Biomass range: -4.76 - 73.33\n  - Value at age 0: -4.760048\nGenerated predictions for 20% abundance:\n  - Biomass range: -13.71 - 52.83\n  - Value at age 0: -13.714163\n\nCreating plot with multiple GAM predictions...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4e22d868c9abd32175fc1fe04e375b9c","path":"/4e22d868c9abd32175fc1fe04e375b9c.png"},"text/plain":{"content":"<Figure size 1600x1000 with 2 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"\nGAM Model Information:\nCutoff age used: 150 years\nData points used for fitting: 236\nPrediction curves: 0-150 years for 5 abundance levels\nModel constraints and weighting applied successfully\nPredictions exported to ./ReferencesAndData/Growth Curves Predictions/Abies Balsamea_gam_predictions.csv\nShape: (100, 6)\nColumns: ['Age', 'GAM_Prediction_100%Abundance', 'GAM_Prediction_80%Abundance', 'GAM_Prediction_60%Abundance', 'GAM_Prediction_40%Abundance', 'GAM_Prediction_20%Abundance']\nAge range: 0.0 - 150.0\n\nPreview of exported data:\n        Age  GAM_Prediction_100%Abundance  GAM_Prediction_80%Abundance  \\\n0  0.000000                     11.856283                     7.575023   \n1  1.515152                     15.636944                    11.182145   \n2  3.030303                     19.377459                    14.753408   \n3  4.545455                     23.069911                    18.281029   \n4  6.060606                     26.706385                    21.757229   \n\n   GAM_Prediction_60%Abundance  GAM_Prediction_40%Abundance  \\\n0                     1.934564                    -4.760048   \n1                     5.252371                    -1.752317   \n2                     8.536013                     1.221635   \n3                    11.779049                     4.155960   \n4                    14.975040                     7.044810   \n\n   GAM_Prediction_20%Abundance  \n0                   -13.714163  \n1                   -10.932160  \n2                    -8.182467  \n3                    -5.470878  \n4                    -2.803186  \n"}],"key":"Rtskqot186"}],"key":"TrcOaFkPqm"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":6,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aUY91P9eAt"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zud4NbRPsm"}],"key":"VM7GGFQElB"},{"type":"text","value":" with a GAM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bMkKhIE3zP"}],"identifier":"producing-estimated-growth-curves-for-acer-rubrum-with-a-gam","label":"Producing estimated growth curves for Acer rubrum with a GAM","html_id":"producing-estimated-growth-curves-for-acer-rubrum-with-a-gam","implicit":true,"key":"j3irw6Bq7g"}],"key":"Qyam6DAapo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from functionsForCalibration import *\n\nwindowed_df = prepareNFIDataForGAMs(abundance_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Acer_Rub_v1.tif',\n                                  age_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif',\n                                  biomass_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif',\n                                  speciesName = \"Acer rubrum\",\n                                  age_window = 5,\n                                  abundance_window = 10,\n                                  percentile = 100,\n                                  mask_path = None,\n                                  printPlot = False)\n\ncreateGAMsAndPredictionsForNFIDataGrowthCurves(windowed_df,\n                                                './ReferencesAndData/Growth Curves Predictions/Acer rubrum_gam_predictions.csv',\n                                               \"Acer rubrum\",\n                                                cutoff_age = 150,\n                                                abundance_levels = [100, 80, 60, 40, 20],\n                                                printPlot = True)","key":"GWUAwP2Pkz"},{"type":"output","id":"hGClAkxBnHiJbAoqwtUq7","data":[{"name":"stdout","output_type":"stream","text":"Reading raster data...\nCreating initial dataframe...\nInitial dataframe shape: (8337062, 3)\nAge range: 0.0 - 251.8\nAbundance range: 0.0 - 60.9\n\nProcessing with parameters:\nAge window: 5\nAbundance window: 10\nPercentile: 100\n\nCreating windowed dataframe...\nApplied monotonic abundance constraint - kept 155 entries\nWindowed dataframe shape: (155, 3)\nNo data points found in the specified windows!\nFiltering data by age cutoff...\nOriginal dataframe shape: (155, 3)\nFiltered dataframe shape (Age < 150): (118, 3)\nFiltered age range: 0.0 - 147.5\nFiltered abundance range: 5.0 - 95.0\n\nFitting weighted GAM model...\ndid not converge\nGAM fitted successfully with constraints and abundance weighting!\nGAM summary:\n  - Number of observations: 118\n  - R-squared (pseudo): 0.978\n  - Constraints applied:\n    * Age effect: concave\n    * Tensor product interaction: concave\n    * Intercept forced to 0\n    * Weighted toward high abundance observations\n\nGenerating predictions for abundance levels: [100, 80, 60, 40, 20]\nGenerated predictions for 100% abundance:\n  - Biomass range: -0.09 - 90.48\n  - Value at age 0: -0.092426\nGenerated predictions for 80% abundance:\n  - Biomass range: 0.68 - 73.15\n  - Value at age 0: 0.680676\nGenerated predictions for 60% abundance:\n  - Biomass range: 1.24 - 62.20\n  - Value at age 0: 1.237291\nGenerated predictions for 40% abundance:\n  - Biomass range: 0.88 - 51.93\n  - Value at age 0: 0.880931\nGenerated predictions for 20% abundance:\n  - Biomass range: -0.77 - 40.20\n  - Value at age 0: -0.774627\n\nCreating plot with multiple GAM predictions...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"00a2ac33f4584fed02010dce7ff226b8","path":"/00a2ac33f4584fed02010dce7ff226b8.png"},"text/plain":{"content":"<Figure size 1600x1000 with 2 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"\nGAM Model Information:\nCutoff age used: 150 years\nData points used for fitting: 118\nPrediction curves: 0-150 years for 5 abundance levels\nModel constraints and weighting applied successfully\nPredictions exported to ./ReferencesAndData/Growth Curves Predictions/Acer rubrum_gam_predictions.csv\nShape: (100, 6)\nColumns: ['Age', 'GAM_Prediction_100%Abundance', 'GAM_Prediction_80%Abundance', 'GAM_Prediction_60%Abundance', 'GAM_Prediction_40%Abundance', 'GAM_Prediction_20%Abundance']\nAge range: 0.0 - 150.0\n\nPreview of exported data:\n        Age  GAM_Prediction_100%Abundance  GAM_Prediction_80%Abundance  \\\n0  0.000000                     -0.092426                     0.680676   \n1  1.515152                      2.045502                     2.709385   \n2  3.030303                      4.179371                     4.733866   \n3  4.545455                      6.307968                     6.752787   \n4  6.060606                      8.430078                     8.764815   \n\n   GAM_Prediction_60%Abundance  GAM_Prediction_40%Abundance  \\\n0                     1.237291                     0.880931   \n1                     3.142053                     2.597460   \n2                     5.042615                     4.309738   \n3                     6.937566                     6.016400   \n4                     8.825494                     7.716084   \n\n   GAM_Prediction_20%Abundance  \n0                    -0.774627  \n1                     0.686626  \n2                     2.143208  \n3                     3.593859  \n4                     5.037319  \n"}],"key":"jBi5pS5IC5"}],"key":"tdyGMoOmCQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":6,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OMbGXUuW8B"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Picea mariana","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SCkX9SzMtu"}],"key":"vpgipJQh9y"},{"type":"text","value":" with a GAM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hQ6N1WNNti"}],"identifier":"producing-estimated-growth-curves-for-picea-mariana-with-a-gam","label":"Producing estimated growth curves for Picea mariana with a GAM","html_id":"producing-estimated-growth-curves-for-picea-mariana-with-a-gam","implicit":true,"key":"IRt4T1uMef"}],"key":"eUQ32IC6Xv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from functionsForCalibration import *\n\nwindowed_df = prepareNFIDataForGAMs(abundance_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Pice_Mar_v1.tif',\n                                  age_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif',\n                                  biomass_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif',\n                                  speciesName = \"Picea mariana\",\n                                  age_window = 5,\n                                  abundance_window = 10,\n                                  percentile = 100,\n                                  mask_path = None,\n                                  printPlot = False)\n\ncreateGAMsAndPredictionsForNFIDataGrowthCurves(windowed_df,\n                                                './ReferencesAndData/Growth Curves Predictions/Picea mariana_gam_predictions.csv',\n                                               \"Picea mariana\",\n                                                cutoff_age = 200, # The take more data as the pic of Picea mariana seems to be later than for Abies balsamea and Acer rubrum\n                                                abundance_levels = [100, 80, 60, 40, 20],\n                                                printPlot = True)","key":"NdHg73XPdL"},{"type":"output","id":"1lLBs_Z7LK9VCXqYVg3Al","data":[{"name":"stdout","output_type":"stream","text":"Reading raster data...\nCreating initial dataframe...\nInitial dataframe shape: (80116986, 3)\nAge range: 0.0 - 348.4\nAbundance range: 0.0 - 100.0\n\nProcessing with parameters:\nAge window: 5\nAbundance window: 10\nPercentile: 100\n\nCreating windowed dataframe...\nApplied monotonic abundance constraint - kept 404 entries\nWindowed dataframe shape: (404, 3)\nNo data points found in the specified windows!\nFiltering data by age cutoff...\nOriginal dataframe shape: (404, 3)\nFiltered dataframe shape (Age < 200): (310, 3)\nFiltered age range: 0.0 - 197.5\nFiltered abundance range: 5.0 - 95.0\n\nFitting weighted GAM model...\nGAM fitted successfully with constraints and abundance weighting!\nGAM summary:\n  - Number of observations: 310\n  - R-squared (pseudo): 0.986\n  - Constraints applied:\n    * Age effect: concave\n    * Tensor product interaction: concave\n    * Intercept forced to 0\n    * Weighted toward high abundance observations\n\nGenerating predictions for abundance levels: [100, 80, 60, 40, 20]\nGenerated predictions for 100% abundance:\n  - Biomass range: 1.62 - 162.79\n  - Value at age 0: 1.619057\nGenerated predictions for 80% abundance:\n  - Biomass range: 4.53 - 137.91\n  - Value at age 0: 4.533635\nGenerated predictions for 60% abundance:\n  - Biomass range: 5.99 - 111.49\n  - Value at age 0: 5.992570\nGenerated predictions for 40% abundance:\n  - Biomass range: 3.08 - 83.63\n  - Value at age 0: 3.082758\nGenerated predictions for 20% abundance:\n  - Biomass range: -6.66 - 54.52\n  - Value at age 0: -6.659307\n\nCreating plot with multiple GAM predictions...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a8b37048c3f11cefcd5b9c3276408f07","path":"/a8b37048c3f11cefcd5b9c3276408f07.png"},"text/plain":{"content":"<Figure size 1600x1000 with 2 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"\nGAM Model Information:\nCutoff age used: 200 years\nData points used for fitting: 310\nPrediction curves: 0-200 years for 5 abundance levels\nModel constraints and weighting applied successfully\nPredictions exported to ./ReferencesAndData/Growth Curves Predictions/Picea mariana_gam_predictions.csv\nShape: (100, 6)\nColumns: ['Age', 'GAM_Prediction_100%Abundance', 'GAM_Prediction_80%Abundance', 'GAM_Prediction_60%Abundance', 'GAM_Prediction_40%Abundance', 'GAM_Prediction_20%Abundance']\nAge range: 0.0 - 200.0\n\nPreview of exported data:\n        Age  GAM_Prediction_100%Abundance  GAM_Prediction_80%Abundance  \\\n0  0.000000                      1.619057                     4.533635   \n1  2.020202                      5.081319                     7.759642   \n2  4.040404                      8.529249                    10.973141   \n3  6.060606                     11.962244                    14.173377   \n4  8.080808                     15.379699                    17.359592   \n\n   GAM_Prediction_60%Abundance  GAM_Prediction_40%Abundance  \\\n0                     5.992570                     3.082758   \n1                     8.864901                     5.428215   \n2                    11.722846                     7.755498   \n3                    14.565205                    10.063526   \n4                    17.390782                    12.351221   \n\n   GAM_Prediction_20%Abundance  \n0                    -6.659307  \n1                    -4.793040  \n2                    -2.943452  \n3                    -1.111152  \n4                     0.703252  \n"}],"key":"XnW2wLlV5o"}],"key":"jZSfgC9ZPC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Values needed to estimate certain parameters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W4ewfs8stO"}],"identifier":"values-needed-to-estimate-certain-parameters","label":"Values needed to estimate certain parameters","html_id":"values-needed-to-estimate-certain-parameters","implicit":true,"key":"uHI5mFDUxg"}],"key":"MHvHne33n1"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Longevity and Max Longevity","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"k8P4UxjmK7"}],"identifier":"longevity-and-max-longevity","label":"Longevity and Max Longevity","html_id":"longevity-and-max-longevity","implicit":true,"key":"LFiBAs3rXe"}],"key":"oO0mjmrDaw"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What we will call here “Longevity” and “Max Longevity” are necessary to calibrate the senescence part of the growth curve for our species.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PLArLTndCp"}],"key":"JMD6WzaoLm"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The difference between the two is this, per the team of Brian Sturtevant who explained their methodology to me :","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BPmUlJz0Ea"}],"key":"R1gU0wIvCc"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Longevity is the rule-of-thumb, expert opinion longevity for a given tree species. This is the age at which it’s expected that a tree of a given species will die, in a give region. These are the number often reported in the litterature, and also used in the core species parameter file of LANDIS-II as its “Longevity” parameter for each tree species used.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ubRZYQFHBF"}],"key":"ABn0Hyz0BJ"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Max Longevity is the real, empirical maximum age that a tree species can reach in the study area. It’s often not reported and difficult to find. A good way to find it is to look at sample plot data and find the oldest trees ever found for a given species (which can be difficult to find as the “age” data is often not directly available in sample plots data).","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"sNB1M6S587"}],"key":"HfCZAYeK4A"}],"key":"GtT2809NHE"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Brian Sturtevant and his team have used these two notions to calibrate the senescence part of the growth curves in ideal conditions as explained in ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"YJBlvcRM7c"},{"type":"link","url":"./6.Monoculture_ideal_conditions.py","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[],"urlSource":"./6.Monoculture_ideal_conditions.py","key":"dx3T0EZaHW"},{"type":"text","value":".  This part from ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"F1hxQOlhhQ"},{"type":"cite","url":"https://cdnsciencepub.com/doi/suppl/10.1139/cjfr-2024-0085/suppl_file/cjfr-2024-0085suppla.docx","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"this supplementary material of Reese et al. (2025)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"MDPYy6QfEk"}],"kind":"narrative","label":"Reese_2025","identifier":"https://cdnsciencepub.com/doi/suppl/10.1139/cjfr-2024-0085/suppl_file/cjfr-2024-0085suppla.docx","enumerator":"3","key":"wQz7LblO89"},{"type":"text","value":" describes Brian’s methodology of explains it all :","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"jusV8hkEmK"}],"key":"huR5Gbd66m"},{"type":"blockquote","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"We used an unpublished review and analysis led by John Du Plissis at the University of Minnesota-Duluth to define both tree species longevity (the age at which a species age cohort can no longer persist) and the initiation of decline that is defined by the age-related photosynthesis reduction factor (","key":"anpIyFNJ10"},{"type":"abbreviation","title":"Reduction factor of photosynthesis as the age of an age cohort increases.","children":[{"type":"text","value":"PsnAgeRed","key":"O0whhWiBVv"}],"key":"L1h3Jaxj2S"},{"type":"text","value":") parameter in PnET Succession. In general, the maximum species longevity of Loehle (1988) corresponds with the tree species longevity parameter, while the typical species’ longevity from the same publication determines the initiation of decline, where ","key":"his5Jcblp9"},{"type":"abbreviation","title":"Reduction factor of photosynthesis as the age of an age cohort increases.","children":[{"type":"text","value":"PsnAgeRed","key":"prEgm8cx3B"}],"key":"Kcx5onRKIa"},{"type":"text","value":" is calibrated such that the fAGE (age reduction factor) begins to decline (~0.99) at the Typical Mortality age of the species.","key":"ikAfg5poif"}],"key":"yryjEvYCzr"}],"key":"OA04QthyJZ"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"The data used by Brian’s team for Typical Longevity and Max Longevity are cited as coming from ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"qExcTmkPTh"},{"type":"cite","url":"https://sci-hub.st/https://cdnsciencepub.com/doi/10.1139/x88-032","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Loehle (1988)","key":"XLT5QUEkUR"}],"kind":"narrative","label":"Loehle_1988","identifier":"https://sci-hub.st/https://cdnsciencepub.com/doi/10.1139/x88-032","enumerator":"4","key":"s8wzeEPzbB"},{"type":"text","value":" in ReeseEtAl_CanJForRes_2024_supplA.docx ; it’s an article that seem to compute them based on several characteristics of tree species.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"BJcueMRSMW"}],"key":"iorWnXhv9s"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"In the end, Brian’s team is using a combination of data from ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"GgqebqoYoa"},{"type":"cite","url":"https://cdnsciencepub.com/doi/10.1139/x88-032","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Loehle (1988)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"hP8ZLmOYKV"}],"kind":"narrative","label":"Loehle_1988","identifier":"https://cdnsciencepub.com/doi/10.1139/x88-032","enumerator":"4","key":"bO3tBCDPqv"},{"type":"text","value":" and estimates found by John Du Plissis (yet unpublished). I’m going to use the data from ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Bj9Ls3cRoU"},{"type":"cite","url":"https://cdnsciencepub.com/doi/10.1139/x88-032","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Loehle (1988)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"YWdhbxuAZ3"}],"kind":"narrative","label":"Loehle_1988","identifier":"https://cdnsciencepub.com/doi/10.1139/x88-032","enumerator":"4","key":"QTaITivvgq"},{"type":"text","value":", which should be enough for our goals until the data from Du Plissis is published.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"EH3hOS10Nx"}],"key":"Q2KlfThsgp"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"cite","url":"https://cdnsciencepub.com/doi/10.1139/x88-032","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Loehle (1988)","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"NxqdZ9H1r6"}],"kind":"narrative","label":"Loehle_1988","identifier":"https://cdnsciencepub.com/doi/10.1139/x88-032","enumerator":"4","key":"U18ZgrHBCo"},{"type":"text","value":", defines “Typical” versus “Maximum” longevity in the following terms :","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"msTbiGubsp"}],"key":"k2ZvmZw3jN"},{"type":"blockquote","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Typical longevity is the age of the older trees in an old-growth stand, whereas maximum longevity is the upper known maximum above which very few trees are found.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"efNqhhjwAZ"}],"key":"NLesktSoZE"}],"key":"O32UFK00Sl"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"We can find the value of typical longevity and maximum longevity from Loehle in the Appendix 1. Here are the values for our three species :","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"ySkQxqMjwr"}],"key":"y0GtjqweeC"}],"key":"PHK04R4okz"},{"type":"block","kind":"notebook-content","children":[{"type":"table","position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Species","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oYlz3GcSFq"}],"key":"mEyyndcQdV"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"MINREP (years)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kTGDuIPXuM"}],"key":"hG5BhpbuLH"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"AVEREP (years)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uClGgPNO71"}],"key":"nnQG67lSoz"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"TYPMORT (years)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QY9fgLC81U"}],"key":"ldB7ghhuCk"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"MAXMORT (years)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I0QI0CVk38"}],"key":"JexpOvQdSD"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Specific gravity","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KqnQ0CvddO"}],"key":"NcY4zzbpPh"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Growth rate","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U4rLsnNKLM"}],"key":"rRrLqkOoI6"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Shade tolerance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jS9Hx7KYsA"}],"key":"Dm3LI5i9Ha"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Volumetric heat (J·cm⁻³)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IpP28U8kW8"}],"key":"WveUqnul8L"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Decay resistance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DlFAn1rx3B"}],"key":"jjttRHJexG"}],"key":"tZoLJYK4Xw"},{"type":"tableRow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xJ9593KRi1"}],"key":"awQkoaVw8V"}],"key":"nzXsN8qVn5"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"15","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GMpux0lIVj"}],"key":"wKs1lZgjvv"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"30","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vzj7K1W8Eb"}],"key":"zmiv1xg8nY"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"125","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dB7cf3a4Ma"}],"key":"MNIvaWBk5a"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"150","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Q8UJnwHYPe"}],"key":"XYS2ab6opd"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"0.34","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t61oD4G4JG"}],"key":"EgGEwRoMja"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SWSirzdOgN"}],"key":"x4bJc4DHLo"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gLjnlgIFyp"}],"key":"BJZTk1P95V"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"6.42","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jkxyBRNTRT"}],"key":"K5hPPAuVbg"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PfX839uWQc"}],"key":"yVdDgQTHOx"}],"key":"CwPv5o9jUg"},{"type":"tableRow","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Picea mariana","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"b24nZzwLtI"}],"key":"Dv3IBe5sDn"}],"key":"s87EUoAMBu"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"10","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Oax8uu6LMm"}],"key":"HxSB9etniL"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"18","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ZjK6DUVvuj"}],"key":"ObYmJvNQNK"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"150","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ir4R2oWt85"}],"key":"ENRofckzHo"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"250","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"LuuALc30Rk"}],"key":"RSL5k2QCny"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"0.43","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"yUBm5CXIS4"}],"key":"py3TCrM7jT"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Zs5Jrb7bQk"}],"key":"HngRzfC2rn"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"QgRRkhhGu4"}],"key":"QNXbPb9Zsn"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"7.91","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"cjcj3LDh6V"}],"key":"fo1V86sm4B"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"JFKBdEji3v"}],"key":"HeyHGoEytd"}],"key":"Dkpjf39xRX"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dMOO6Wxx61"}],"key":"U0enr7BBJl"}],"key":"IGvhQPu5bX"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SFtPYqnUlj"}],"key":"mtDOjYKOSE"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[],"key":"gHRScGEKpK"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"80","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MDo5rBrUdR"}],"key":"dbuXJToG0H"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"150","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"AcoFH4rtbF"}],"key":"mm8DArCZYo"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"0.49","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"P2OqNciKUw"}],"key":"eWBsFxyMaB"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ziGzaGesbQ"}],"key":"mZIwsCfXx2"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DLfW4yDwWS"}],"key":"vAIArO3RQY"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"9.93","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MmX7uGp9SF"}],"key":"oyrTSpRoFr"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hAVZbsMq70"}],"key":"swh8cWrLri"}],"key":"PeB3bEPn7e"}],"key":"KY5jvQoXUK"}],"key":"AobigHpouG"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Ranges of parameter values for the calibration","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ibPnpvC0Oy"}],"identifier":"ranges-of-parameter-values-for-the-calibration","label":"Ranges of parameter values for the calibration","html_id":"ranges-of-parameter-values-for-the-calibration","implicit":true,"key":"MK6Aqb3qhm"}],"key":"PNnICjvvtn"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Table with ranges extracted from the litterature for most PnET parameters ?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PYsYTihsPa"}],"key":"thvkI41aFs"}],"key":"B7O2pwJa9d"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From Brian’s  team (ReeseEtAl_CanJForRes_2024_supplA.docx) :","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B3WjeRBF3N"}],"key":"fDLrA65PDc"},{"type":"blockquote","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Parameter calibrations were guided by plausible ranges for ecophysiological parameter values and species traits from the TRY Plant Trait Database (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"O9dqUcOiec"},{"type":"link","url":"https://www.try-db.org/TryWeb/Home.php","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"https://​www​.try​-db​.org​/TryWeb​/Home​.php","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IwQYNiqDsj"}],"urlSource":"https://www.try-db.org/TryWeb/Home.php","key":"iwAnffW0s1"},{"type":"text","value":"), cross-referenced against region-specific species ecology from the Fire Effects Information System (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qu3tFKDoGr"},{"type":"link","url":"https://www.feis-crs.org/feis/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"https://​www​.feis​-crs​.org​/feis/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"niL07gAAbk"}],"urlSource":"https://www.feis-crs.org/feis/","key":"blz78vV9lY"},{"type":"text","value":").","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GhF2owLDjc"}],"key":"oAWR4B9SwB"}],"key":"qfGMY5Xbfi"}],"key":"EQF96rMqJe"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From the user guide :","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uHUFq5Ipy5"}],"key":"qgxy6xRQwa"},{"type":"blockquote","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The range of ","key":"SEGGTIY2Yr"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"XtoHSDnLMd"}],"key":"OOlE33Tacj"},{"type":"text","value":" for each species across sites, age, canopy position. This is a great starting point and helps put bounds on acceptable values, but it is important to recognize that productivity is closely related to ","key":"gteEgn6IGM"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"YFrXFHoD6p"}],"key":"CbakFJ1Yqi"},{"type":"text","value":" in PnET, so it is more important that ","key":"lrIWTjqit7"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"UPVA1mU4d0"}],"key":"WUxcvYRA7P"},{"type":"text","value":" reflect relative productivity among species than matching empirical values. That said, it is usually (but not always) possible to select a value of ","key":"xPS9fyvELB"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"IWnrkNMyr6"}],"key":"x6XERtdmR1"},{"type":"text","value":" that is within the range of empirically measured values. If you have empirical values of Amax, use your values of ","key":"bxNARiGTS1"},{"type":"abbreviation","title":"Intercept of the relationship between foliar N and maximum net photosynthetic rate.","children":[{"type":"text","value":"AmaxA","key":"EKzIgumqLJ"}],"key":"omrd7JRj5h"},{"type":"text","value":" and ","key":"vN75hU77pb"},{"type":"abbreviation","title":"Slope of the relationship betwee foliar N and maximum net photosynthetic rate.","children":[{"type":"text","value":"AmaxB","key":"rRRq3eBh1w"}],"key":"kHWbaBQU4Y"},{"type":"text","value":" (or see Fig. 2 in Aber et al. 1996) to estimate the ","key":"H8oyYnS8pk"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"VuCsp0krxw"}],"key":"ZiF0FCBwbB"},{"type":"text","value":" that produces that Amax value. NOTE: if you plan to implement dynamic ","key":"Aw2jdAVQIp"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"cSEnYQOxK5"}],"key":"B3NN3HKQ42"},{"type":"text","value":" (","key":"bPCn6eOHkU"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"GnsgKd5EBP"}],"key":"hUTf9d91rF"},{"type":"text","value":"Int and ","key":"iJKUdrSrcy"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"kCfRiRfE8h"}],"key":"rNfOWqROEO"},{"type":"text","value":"Slope set to values other than default), then be sure to set ","key":"S7wnzR7dmo"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"Z4xyHWaijK"}],"key":"nuSFjABTvy"},{"type":"text","value":"Int and ","key":"j586oQhZR5"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"Wghum4l8cH"}],"key":"hXfE0vhIYc"},{"type":"text","value":"Slope to the values you will use in your final simulations while calibrating.","key":"BapsFPVDlH"}],"key":"fJzNNJMRMb"}],"key":"vVU1lhNurp"},{"type":"blockquote","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Species ","key":"zN8iY8OpuO"},{"type":"abbreviation","title":"Specific leaf weight at the top of the canopy.","children":[{"type":"text","value":"SLWmax","key":"AxejIfA8IT"}],"key":"WAjXUAWaAF"},{"type":"text","value":" helps determine LAI. Thicker leaves (higher SLW) reduce LAI. LAI determines the ability of a cohort to compete for light, so it is important to calibrate so that LAI produces realistic response to light. Again, it is more important to get LAI approximately right than to keep ","key":"zCKxvmqYZr"},{"type":"abbreviation","title":"Specific leaf weight at the top of the canopy.","children":[{"type":"text","value":"SLWmax","key":"TlHSsh4yPt"}],"key":"rUHLwxTCZD"},{"type":"text","value":" within the empirical range. Out-of-range ","key":"WvBZt3KWuz"},{"type":"abbreviation","title":"Specific leaf weight at the top of the canopy.","children":[{"type":"text","value":"SLWmax","key":"kuwZO1GPxQ"}],"key":"QHFLhNKdLW"},{"type":"text","value":" values often indicate that ","key":"RV2pdx2znv"},{"type":"abbreviation","title":"Fraction of the active woody biomass (above or belowground) of a cohort that determines the amount of foliage maintained each year.","children":[{"type":"text","value":"FracFol","key":"SnVbUvgKlJ"}],"key":"A4ZJCyKufB"},{"type":"text","value":" values are incorrect. Note that higher LAI increases within-canopy competition for light and will modestly depress growth even of a single cohort. I have found that LAI values exceeding those given in Table 1 may greatly reduce the amount of light penetrating canopy layers, thus impacting growth, competition and establishment","key":"ChLVZYg3Gs"}],"key":"VfUA9x21TD"}],"key":"tQnO7GKY0b"},{"type":"blockquote","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"There are some published estimates of whole tree biomass through time by species groups to provide some indication of belowground biomass (e.g., Smith et al. 2006). => Que ce sois cette source ou les modèles allometriques trouvés dans R, avoir des estimations du ration above/belowground serais très précieux.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"D0RNOIfl10"}],"key":"aCoxyGSabI"}],"key":"D7ApEjICkR"}],"key":"V1KJzFqRt7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Competition outcomes between species","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aJ1AgRIuLp"}],"identifier":"competition-outcomes-between-species","label":"Competition outcomes between species","html_id":"competition-outcomes-between-species","implicit":true,"key":"u0QcyXNREY"}],"key":"h11zV2DNuB"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Based on litterature + expert opinion, in different conditions :","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cVpV5jN1JW"}],"key":"rpfqHSD6I1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Baseline + Good water level","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"G7dwwzpkY6"}],"key":"mcshhmnBvS"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Baseline + Drought","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"XkNCzje3ZU"}],"key":"nDKzKAf77u"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Baseline + Waterlogging","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZgIpvXg9P4"}],"key":"BG3HMrR6M6"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Climate change ++","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"VCPXCKQNV6"}],"key":"c0YislFhyf"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Climate change +++","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"yetyTQde6p"}],"key":"uq0DMkUYLo"}],"key":"AysW8wFQYt"}],"key":"nybh8F6ND9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"DRAFTS","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AuJLE6tbNC"}],"identifier":"drafts","label":"DRAFTS","html_id":"drafts","implicit":true,"key":"o27et8R1if"}],"key":"AcQSV97Cmr"}],"key":"OTNmw5Bs6k"},"references":{"cite":{"order":["Pickett_1989","Beaudoin_2018","Reese_2025","Loehle_1988"],"data":{"Pickett_1989":{"label":"Pickett_1989","enumerator":"1","doi":"10.1007/978-1-4615-7358-6_5","html":"Pickett, S. T. A. (1989). Space-for-Time Substitution as an Alternative to Long-Term Studies. In <i>Long-Term Studies in Ecology</i> (pp. 110–135). Springer New York. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/978-1-4615-7358-6_5\">10.1007/978-1-4615-7358-6_5</a>","url":"https://doi.org/10.1007/978-1-4615-7358-6_5"},"Beaudoin_2018":{"label":"Beaudoin_2018","enumerator":"2","doi":"10.1139/cjfr-2017-0184","html":"Beaudoin, A., Bernier, P. Y., Villemaire, P., Guindon, L., & Guo, X. J. (2018). Tracking forest attributes across Canada between 2001 and 2011 using a k nearest neighbors mapping approach applied to MODIS imagery. <i>Canadian Journal of Forest Research</i>, <i>48</i>(1), 85–93. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1139/cjfr-2017-0184\">10.1139/cjfr-2017-0184</a>","url":"https://doi.org/10.1139/cjfr-2017-0184"},"Reese_2025":{"label":"Reese_2025","enumerator":"3","doi":"10.1139/cjfr-2024-0085","html":"Reese, G. C., Sturtevant, B. R., Dymond, C. C., Quigley, K. M., Duveneck, M. J., Lucash, M. S., Gustafson, E. J., Scheller, R. M., Russell, M. B., & Miranda, B. R. (2025). Best practices for calibration of forest landscape models using fine-scaled reference information. <i>Canadian Journal of Forest Research</i>, <i>55</i>, 1–19. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1139/cjfr-2024-0085\">10.1139/cjfr-2024-0085</a>","url":"https://doi.org/10.1139/cjfr-2024-0085"},"Loehle_1988":{"label":"Loehle_1988","enumerator":"4","doi":"10.1139/x88-032","html":"Loehle, C. (1988). Tree life history strategies: the role of defenses. <i>Canadian Journal of Forest Research</i>, <i>18</i>(2), 209–222. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1139/x88-032\">10.1139/x88-032</a>","url":"https://doi.org/10.1139/x88-032"}}}}}