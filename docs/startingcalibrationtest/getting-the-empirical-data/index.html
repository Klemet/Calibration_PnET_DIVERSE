<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Getting the empirical data needed fo the calibration process - Calibration of PnET Succession for the DIVERSE project</title><meta property="og:title" content="Getting the empirical data needed fo the calibration process - Calibration of PnET Succession for the DIVERSE project"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="https://klemet.github.io/Calibration_PnET_DIVERSE/build/Algorithm_GrowthCurv-fc445ac3fd5e0813654caa5495dcaf2b.png"/><meta property="og:image" content="https://klemet.github.io/Calibration_PnET_DIVERSE/build/Algorithm_GrowthCurv-fc445ac3fd5e0813654caa5495dcaf2b.png"/><link rel="stylesheet" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="https://klemet.github.io/Calibration_PnET_DIVERSE/favicon.ico"/><link rel="stylesheet" href="https://klemet.github.io/Calibration_PnET_DIVERSE/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="https://klemet.github.io/Calibration_PnET_DIVERSE/"><div class="p-1 mr-3 dark:bg-white dark:rounded"><img src="https://klemet.github.io/Calibration_PnET_DIVERSE/build/DIVERSE_PnET_Calibra-5bdc855d1747cacb3d11076efd7a4094.png" class="h-9" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="Calibration of PnET Succession for the DIVERSE project" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="https://klemet.github.io/Calibration_PnET_DIVERSE/">Calibration of PnET Succession for the DIVERSE project</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Calibration test" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="https://klemet.github.io/Calibration_PnET_DIVERSE/startingcalibrationtest/intro-calibrationtest">Calibration test</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap"><main class="article-grid subgrid-gap col-screen"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://github.com/Klemet/Calibration_PnET_DIVERSE" title="GitHub Repository: Klemet/Calibration_PnET_DIVERSE" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><a href="https://github.com/Klemet/Calibration_PnET_DIVERSE/blob/main/calibrationJupyterBook/StartingCalibrationTest/4.Getting_the_empirical_data.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Getting the empirical data needed fo the calibration process</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78top:" data-state="closed">Clément Hardy, PhD.</button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="dSNNahAgoW" class="relative group/block"><p>Here, I catalog the other data needed for the calibration process, that is not the initial parameter values we will be using (for this, see <a class="" href="https://klemet.github.io/Calibration_PnET_DIVERSE/startingcalibrationtest/initial-species-parameters">here</a>) or the climate and soil data used in the simulations for the calibration (see <a target="_blank" rel="noreferrer" href="./4.Setting_up_calibration_Landscape.ipynb" class="">here</a>).</p><p>This other data will be used to :</p><ul><li>Target values to match during the calibration (e.g. biomass growth curves)</li><li>Determine the value of some parameters directly (e.g. maximum longevity)</li><li>Establish ranges of parameter values in which we should remain during the calibration</li><li>Expected outcomes of simulations (e.g. competition outcomes, climate change outcomes, etc.)</li></ul><p>I will write here as much suggestions a possible for future researchers that will want to calibrate for their own research or study area, but I will also indicate what I will be using in these notebooks.</p></div><div id="OX5QifFSkx" class="relative group/block"><h3 id="empirical-data-for-biomass-growth-curves" class="relative group"><span class="heading-text">Empirical data for biomass growth curves.</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#empirical-data-for-biomass-growth-curves" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>This is an essential part of the calibration process, especially the first step in which we will calibrate each species in “ideal” conditions of growth (mild climate, good soil water retention, etc.). These “ideal” conditions are important to isolate the effect of other parameters and other sources of mortality, so that you can focus on the basic parameters of growth and senescence for your species (see <a class="" href="https://klemet.github.io/Calibration_PnET_DIVERSE/startingcalibrationtest/monoculture-ideal-conditions">here</a>).</p><p>Basically, what you want is data that allows you to infer a biomass growth curve for each given species, showing the evolution of the biomass of a cohort for the species in conditions that are as ideal as possible.</p><p>As of today, I’ve ran accross three different strategies to get this data. I’ll describe them in the following sections.</p><h4 id="option-1-sample-plot-data" class="relative group"><span class="heading-text">Option 1 : Sample plot data.</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#option-1-sample-plot-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>By looking at individual tree data from sample plot data, you can infer tree biomass and tree age, making each tree or plot a point on your graph.</p><p>By looking at the points that are at the top of the cloud of points that will result, you can get and idea of the maximum biomass a tree can reach for a given age, which should give you good information about the growth curve. This is a method used by many research so far.</p><p>The problem is that sample plot data is often messy, full of outliers, biases, needing sharing agrements, etc. As such, it will require important work to clean, and several important assumptions will influence your results enormously. For example, the “tree age” data is often missing, and you’ll have to infer it from DBH; and you’ll also have to choose how to translate your individual tree biomass into biomass/surface (as all LANDIS-II biomass output is interpreted in biomass/surface, not biomass/tree).</p><h4 id="option-2-tree-growth-models" class="relative group"><span class="heading-text">Option 2 : Tree growth models.</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#option-2-tree-growth-models" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>These models are complex equations develloped by foresters, industries or governmental agencies to try and predict growth or yield for different species in different conditions. These are often calibrated based on sample plot data; as such, the work of cleaning/dealing with sample plot data is often done for you. An example is the famous <a target="_blank" rel="noreferrer" href="www.fs.usda.gov/fvs/" class="">Forest Vegetation Simulator</a> from the USDA. Other such models are simply growth curves published in the litterature, sometimes in books.</p><p>The curves produced by these models are often in biomass/surface, which makes things easier to compare with LANDIS-II outputs. You can also tweak the parameters of these models so that they predict biomass growth in conditions as ideal as possible, making it close to what you’re looking for.</p><p>The main issue is that these models can still produce pretty unrealistic curves; might not be available for your study area/region; and might still need parameters derived from sample plot data (e.g. Site index and maximum basal area for FVS). So while they can make your life simpler, they can still be difficult to use.</p><p>FVS can be compiled into a Dockerfile and use in Python; I’ve tried it at first and will keep the functions that I’ve written in a separate document for you to re-use if necessary.</p><p>Be warned that the decreasing part of the curves produced by these often often don’t include mortality by senescence, which can make the cruve growth forever, making it difficult to identify the biomass peak which is very important for calibration purposes.</p><p>Tree growth models have been used by several research teams, including Brian Sturtevant’s and Eric Gustafson (the latter being the author of the calibration tips for PnET-Succession that are the basis of these documents).</p><h4 id="option-3-forest-inventory-data" class="relative group"><span class="heading-text">Option 3 : Forest inventory data.</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#option-3-forest-inventory-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>Some forest inventories contain data that allow you to infer tree or stand age and the biomass of your species of interest. For example, the <a target="_blank" rel="noreferrer" href="https://nfi.nfis.org/en/" class="">National Forest Inventory of Canada</a> proposes raster maps of several forest attributes Canada-wide, including pixel/stand forest age, and the biomass of each individual species that are considered in the forest inventory.</p><p>If you use each pixel from the maps of a single year as a point and plot a cloud of points on a biomass/time axis, you might get a good estimation of a growth curve, with a growth peak and a initial growth (the two most important parts in our case). This is, in essence, a <cite class="" data-state="closed"><a href="https://doi.org/10.1007/978-1-4615-7358-6_5" target="_blank" rel="noreferrer" class="hover-link">“space-for-time” substitution</a></cite>, where you look at many different points in space that will be forests at different stages of growth, rather than looking at the long-term history of a few forests.</p><p>The big limitation of this data is that you often get one “stand age” or “pixel age” value per pixel, rather than a separate age value for the trees of a given species in the pixel. As such, in a pixel of 80 years, you cannot know if the biomass of species X comes from trees that are 80 years old, or if these trees are younger. But you can interpret the upper points of the cloud of points as “the maximum biomass that a species can reach for this stand age”, which is pretty close to the mark of what you’re looking for.</p><p>Another big limitation is that in most pixels (if not all), your species will be mixed with other species. This is especially true if you are calibrating a “companion” species (the type of tree species that is never abundant, but yet found in many forests). You can restrict the points of your data to only the pixels where more than 50% of the biomass comes from your species of interest; but you might not get enough points for some rarer species. In these case, you will probably need to develop a correction of biomass to try and have an estimate of the biomass that your species can reach when it composes 100% of the stand. You might do this by making a statistical model that attempts to predict the biomass of your species in a stand or pixel based on the age of the pixel, and the % of composition of the species. You might want to train your statistic model on only the top percentile of points (as you’re looking out for the most biomass your species can achieve for a given age).</p><p>This data is often generated through a combination of forest inventory sampling (aerial photography, etc.) and sample plot data (which are assignated to stand or pixels via assignation algorithms like the kNN method). As such, it often contains information from sample plots, but which has already been cleaned and dealt with.</p><p>The biomass data is often expressed in biomass/surface, making it easy to compare to LANDIS-II outputs.</p><p>This is the data I will be using here. From what I heard, other teams have been using such data in the past.</p></div><div id="kQ4igfAG0q" class="relative group/block"><aside class="myst-admonition myst-admonition-tip my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-green-600"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">What is the spatial extent for which I should take growth data for the calibration ? And what climate data should I use depending on the origin of my growth data ?</div></div><div class="myst-admonition-body px-4 py-1"><p><strong>Short answer :</strong> I wager it’s a very complicated question, with no clear answer. You might focus only on your study area/simulated area, but there are trade-offs no matter what you choose. The important things seem to be that you need to make sure 1) you get enough empirical growth data to estimate the maximum growth initial curve and peak your species can achieve in your study area (if there is not enough data in your study area, you will need to look at a larger scale than just your study area); and 2) that the temperatures and precipitations you use during the calibration come from the area where you gathered your empirical growth data, but that they are averaged to make them mild and constant; added to a good soil type (SILO) to ensure a relatively ideal water retention; and that the temperature is a close to the optimal for your species as possible (which you can ensure by changing the <abbr aria-label="Optimal average daytime temperature for photosynthesis." class="border-b border-dotted cursor-help" data-state="closed">PsnTOpt</abbr> parameter temporarely).</p><p><strong>Extended answer :</strong></p><p>The empirical growth data you’re looking for is going to be used in the first calibration step, corresponding to growth in “ideal” conditions. This step is very important, because that’s where we are going to calibrate some of the most sensitive parameters of PnET-Succession. It’s also the step where we’re going to effectively give the “upper bound” of the performance of the tree species calibrated. It’s crucial to get this upper bound right, because the algorithm and equations of PnET-Succession are mostly based on photosynthesis reduction factors (linked to light, water, age, temperature, CO2, etc.) that are going to reduce the growth of the tree species bellow this upper bound. If this upper bound is too high, you’ll overestimate the growth of the species most of the time (if not all of the time); but you can also underestimate it by setting it too low.</p><p>The empirical growth area you’re getting here is used to have an estimate of this upper bound. It’s possible that you have enough empirical data from measurements taken inside your study area to have some good estimates; but maybe you won’t have enough data points, or no growth models available for the conditions of your study area. In that case, you’ll have to look to a larger area to get data.</p><p>But the larger the area where you take empirical data gets, the more you get into another problem : as you are looking at more trees of your species in a larger area, you’re also looking at a higher diversity of phenotypes or traits or variants in your trees. As such, the upper bound of growth that you will be getting from this data might be from a phenotype not present in your area; or maybe you’ll be combining measures from different trees, and so maybe different phenotypes. As such, this upper bound that you’ll be estimating might still be for your tree species; but it might become an upper bound for trees that might be quite different from the ones in your area (even thought they are from the same species). It might also become an upper bound for a “soup” of different phenotypes, making it less realistic, and introducing uncertainty or potential bias. As such, the bigger is not necesserally the better : it might be best to restrict your choice of data to your study area or to a province or state or region to avoid these issues.</p><p>With the choice of the area from which you will take your empirical growth data also comes a second question : what climate data should you use during the calibration simulation ? Again, the goal of the first calibration step (where you will use your empirical growth data) is to make sure that your species reach the right upper bound given ideal conditions. But how do we define ideal conditions in that case ? Theoritically, these should be the climate conditions that led that this upper bound you have seen in your empirical data. Problem is, you will most likely not know what was the exact climate data associate with this growth : maybe it’s because your data is a composite of points from many different places (e.g. sample plot data or forest inventory data); or maybe it’s because your data comes from a growth model that do not provide the climate data associated to a growth curve. So, what climate data should you give ?</p><p>The option used by <a target="_blank" rel="noreferrer" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/Gustafson2024PnETUse-e030ce36ecd3383f68f3a22a7353dd42.pdf" class="">Gustafson and Miranda (2023)</a> is to use an averaged historical climate data stream (same climate every year, but changes every months based on average from historical monthly data) from your study area. To ensure a relatively ideal amount of water for the species to use during the calibration, Gustafson recommands using averaged “typical” precipitations and a soil of type SILO - which will ensure that your species have a right quantity of water, not too much, and not too little. As for temperature, Gustafson recommands cheating a bit by changing the <abbr aria-label="Optimal average daytime temperature for photosynthesis." class="border-b border-dotted cursor-help" data-state="closed">PsnTOpt</abbr> parameter of your tree species temporarely so that it matches the average of the growing season temperatures in your climate data (which would already be a constant climate every year because it would be an average climate). That, or making sure that the average growing season temperatures matches the <abbr aria-label="Optimal average daytime temperature for photosynthesis." class="border-b border-dotted cursor-help" data-state="closed">PsnTOpt</abbr> of your species to begin with. This ensures that the photosynthesis of your species will be maximum. However, Gustafson points out that since you’re making the climate very mild and very “ideal” for your species, this will most likely not match the less ideal and less mild climate that generated the empirical growth data you’re using to estimate this upper bound. That is why Gustafson recommands that you should try reach a growth that is a bit above the upper bound estimated from your data in this first step, if you use his methodology.</p><p>I think this approach makes a lot of sense : it solves the issue of not knowing the exact climate that is associated with the upper bound of growth derived from your empirical data by tweaking the climate data coming from your study area (or the area from which your empirical growth data comes from) so that it becomes “ideal”; but to compensate this, you’ll simply have to target a bit higher than the upper bound. How much higher ? There are no perfect answers here again, just approximation. 5-10% higher could be a good estimate with a rule-of-thumb approach.</p></div></aside></div><div id="RNGknO43Mg" class="relative group/block"><aside class="myst-admonition myst-admonition-tip my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-green-600"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">What data should I use to calibrate variants, like southern variants that are more adapted to heat ? And what variant I am calibrating for if I use this methodology ?</div></div><div class="myst-admonition-body px-4 py-1"><p>That’s another big question. The more local the data you use (wherever in the initial parameter values you will use, parameter range, empirical growth data, etc.), the more you will be calibrating for the local phenotypes of the area you are focusing on. Invertly, the broader the data you use spatialy (and you will most likely need to use data from many different places), the more the species you are calibrating will be a kind of “soup” of “average” of many phenotypes and variants. It won’t be the most realistic option; but that’s often the best you can do given the low density of data we have for many tree species (e.g. there is not enough data locally to get values for all parameters or good empricial growth estimates as described in the tip section above).</p><p>Once you have calibrated your species, if you want to represent “northern” and “southern” variants that are adapted to different conditions of heat (or even different conditions of drought), you might want to change some parameters related to these aspects. In particular, by changing the parameters <abbr aria-label="Water stress parameter according to Feddes et al. (1978) (Fig. 59)." class="border-b border-dotted cursor-help" data-state="closed">H1</abbr>, <abbr aria-label="Water stress parameter according to Feddes et al. (1978) (Fig. 59)." class="border-b border-dotted cursor-help" data-state="closed">H2</abbr>, <abbr aria-label="Water stress parameter according to Feddes et al. (1978) (Fig. 59)." class="border-b border-dotted cursor-help" data-state="closed">H3</abbr> and <abbr aria-label="Water stress parameter according to Feddes et al. (1978) (Fig. 59)." class="border-b border-dotted cursor-help" data-state="closed">H4</abbr>, you will change the response of the species to different conditions of water in the soil. A variant adapted to dryier conditions will certainly have increased values of <abbr aria-label="Water stress parameter according to Feddes et al. (1978) (Fig. 59)." class="border-b border-dotted cursor-help" data-state="closed">H1</abbr>, <abbr aria-label="Water stress parameter according to Feddes et al. (1978) (Fig. 59)." class="border-b border-dotted cursor-help" data-state="closed">H2</abbr>, <abbr aria-label="Water stress parameter according to Feddes et al. (1978) (Fig. 59)." class="border-b border-dotted cursor-help" data-state="closed">H3</abbr> and <abbr aria-label="Water stress parameter according to Feddes et al. (1978) (Fig. 59)." class="border-b border-dotted cursor-help" data-state="closed">H4</abbr> overall (can pump more water from the soil where pressure is low; but is also more sensitive to waterlogging). For temperature, you will most likely need to change <abbr aria-label="Minimum average daytime temperature for photosynthesis." class="border-b border-dotted cursor-help" data-state="closed">PsnTMin</abbr>, <abbr aria-label="Optimal average daytime temperature for photosynthesis." class="border-b border-dotted cursor-help" data-state="closed">PsnTOpt</abbr>, and <abbr aria-label="Maximum average daytime temperature for photosynthesis." class="border-b border-dotted cursor-help" data-state="closed">PsnTMax</abbr>. Gustafson notes in <a target="_blank" rel="noreferrer" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/Gustafson2024PnETUse-e030ce36ecd3383f68f3a22a7353dd42.pdf" class="">Gustafson and Miranda (2023)</a> : <em>I use <abbr aria-label="Maximum average daytime temperature for photosynthesis." class="border-b border-dotted cursor-help" data-state="closed">PsnTMax</abbr> to make more northerly species less competitive than southerly species as climate warms.</em> You can also slightly change <abbr aria-label="Optimal average daytime temperature for photosynthesis." class="border-b border-dotted cursor-help" data-state="closed">PsnTOpt</abbr>, which indicates the optimum temperature for the species. How much you increase or decrease these values is up to your interpretation; you can compare to other species, but you can also look at the average temperatures for the growing season at the latitude corresponding to the center of the range distribution of your variant.</p></div></aside></div><div id="yVUOjfpNRp" class="relative group/block"><h4 id="option-used-here-data-from-the-national-forest-inventory-of-canada" class="relative group"><span class="heading-text">Option used here : data from the National Forest Inventory of Canada</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#option-used-here-data-from-the-national-forest-inventory-of-canada" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>See :</p><ul><li><a target="_blank" rel="noreferrer" href="https://nfi.nfis.org/en/" class=""></a> for general information and visualisation of some of the maps</li><li><a target="_blank" rel="noreferrer" href="https://open.canada.ca/data/en/dataset/ec9e2659-1c29-4ddb-87a2-6aced147a990" class=""></a> to download the maps</li><li><cite class="" data-state="closed"><a href="https://doi.org/10.1139/cjfr-2017-0184" target="_blank" rel="noreferrer" class="hover-link">Beaudoin <em>et al.</em> (2018)</a></cite> for details about how the maps were generated.</li></ul><p>Here, I’m using data from the most recent year (2011). I’m using the map <code>/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif</code> for the stand (pixel) ages; <code>/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif</code> for biomass of stands; and a series of rasters like <code>/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Abie_Bal_v1.tif</code> that indicate the propotion of <code>/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif</code> that corresponds to the species of interest (e.g. <em>Abies balsamea</em> in that case). All maps are currently in <code>./ReferencesAndData</code>.</p><p>I’m also using several “mask” rasters to restrict or differenciate the pixel data from different provinces in Canada (e.g. <code>quebecMask.tif</code>, etc., all in <code>./ReferencesAndData</code>).</p></div><div id="dPIVOpUlkh" class="relative group/block"><p>Here, before we use this dataset, I quickly show how it looks like by focusing on the highest points of the point clouds that it produces. Focusing on these highest points will give us an idea of the “best growth” that the species can achieve through by looking at different pixels from the same year throughout all of Canada.</p></div><div id="bm2Xq3vYgJ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># We read data from the NFI for our free species, and plot the distribution of the points above 95% of the maximum value in
# each 3 years window (which allows us to keep the top points)
from functionsForCalibration import *
import matplotlib.pyplot as plt


# We define the path to where the rasters are
species_path = &quot;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Abie_Bal_v1.tif&quot;
age_path = &quot;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif&quot;
biomass_path = &quot;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif&quot;
# We define the paths to the mask rasters for each province
dictOfMasks = {&quot;NS&quot;:&quot;./ReferencesAndData/SpatialBoundaries/novaScotiaMask.tif&quot;,
              &quot;QC&quot;:&quot;./ReferencesAndData/SpatialBoundaries/quebecMask.tif&quot;,
              &quot;ON&quot;:&quot;./ReferencesAndData/SpatialBoundaries/ontarioMask.tif&quot;,
              &quot;MT&quot;:&quot;./ReferencesAndData/SpatialBoundaries/manitobaMask.tif&quot;,
              &quot;SK&quot;:&quot;./ReferencesAndData/SpatialBoundaries/saskatchewanMask.tif&quot;,
              &quot;AB&quot;:&quot;./ReferencesAndData/SpatialBoundaries/albertaMask.tif&quot;,
              &quot;BC&quot;:&quot;./ReferencesAndData/SpatialBoundaries/britishColumbiaMask.tif&quot;,}


plottingNFISpeciesUpperBiomassByProvince(species_path,
                                         age_path,
                                         biomass_path,
                                         &quot;Abies balsamea&quot;,
                                         dictOfMasks)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Q-yljt_en3PV6RiNlCF0r" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Reading species raster...
Reading age raster...
Reading biomass raster...
Dealing with NS
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/usr/local/lib/python3.10/dist-packages/numpy/ma/core.py:1020: RuntimeWarning: overflow encountered in multiply
  result = self.f(da, db, *args, **kwargs)
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Dealing with QC
Dealing with ON
Dealing with MT
Dealing with SK
Dealing with AB
Dealing with BC
</span></code></pre></div><img src="https://klemet.github.io/Calibration_PnET_DIVERSE/build/99c0650e6247135da6ad41df1b934932.png" alt="&lt;Figure size 1000x800 with 1 Axes&gt;"/></div></div><div id="QAbZSfVRge" class="relative group/block"><p>As such, we can see that :</p><ul><li>The NFI data shows some pretty clear growth patterns (initial growth, peak, senescence)</li><li>We see that the different provinces can have very different growth peaks and initial growth/senescence. Upon closer inspection (plotting again but only for points with at least 50% of biomass composed of <em>Abies balsamea</em>), it seems to mostly be due to the differences in the mixture/competition of the species in difference province. SK, AB, MT and BC don’t have many points where <em>Abies balsamea</em> is dominant. Meanwhile, NS, QC and ON have a lot of it.</li></ul><p>Now, here are the same figures for the other species :</p></div><div id="h2h4gdgYNZ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># We define the path to where the rasters are
species_path = &quot;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Pice_Mar_v1.tif&quot;
age_path = &quot;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif&quot;
biomass_path = &quot;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif&quot;

plottingNFISpeciesUpperBiomassByProvince(species_path,
                                         age_path,
                                         biomass_path,
                                         &quot;Acer rubrum&quot;,
                                         dictOfMasks)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JGWWlrrHPDgPZBuJUmjJC" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Reading species raster...
Reading age raster...
Reading biomass raster...
Dealing with NS
Dealing with QC
Dealing with ON
Dealing with MT
Dealing with SK
Dealing with AB
Dealing with BC
</span></code></pre></div><img src="https://klemet.github.io/Calibration_PnET_DIVERSE/build/6e3bd5072c7a270d1a580b23f221aff8.png" alt="&lt;Figure size 1000x800 with 1 Axes&gt;"/></div></div><div id="qHGCMB8KH4" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># We define the path to where the rasters are
species_path = &quot;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Acer_Rub_v1.tif&quot;
age_path = &quot;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif&quot;
biomass_path = &quot;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif&quot;

plottingNFISpeciesUpperBiomassByProvince(species_path,
                                         age_path,
                                         biomass_path,
                                         &quot;Picea mariana&quot;,
                                         dictOfMasks)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="TwxBs6qftbhb404ec1xAn" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Reading species raster...
Reading age raster...
Reading biomass raster...
Dealing with NS
Dealing with QC
Dealing with ON
Dealing with MT
Dealing with SK
Dealing with AB
Dealing with BC
</span></code></pre></div><img src="https://klemet.github.io/Calibration_PnET_DIVERSE/build/dd07370cc1ad32d4816e922c5ccee6f2.png" alt="&lt;Figure size 1000x800 with 1 Axes&gt;"/></div></div><div id="qRYc1GZ203" class="relative group/block"><p>We can again see some pretty clear patterns for <em>Acer rubrum</em> and <em>Picea mariana</em>. As such, this dataset should do.</p></div><div id="mBIU90NFP8" class="relative group/block"><h4 id="producing-estimated-growth-curves-in-ideal-conditions-in-canada-for-our-species-with-nfi-data" class="relative group"><span class="heading-text">Producing estimated growth curves in ideal conditions (in Canada) for our species with NFI data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#producing-estimated-growth-curves-in-ideal-conditions-in-canada-for-our-species-with-nfi-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="BCyw1NMMWs" class="relative group/block"><p>Based on the NFI data shown and explored in the previous section, we now have to produce estimated growth curves based on this data that we will be able to use as a “target” for the first step of the calibration of PnET-Succession, where we will try to match the curves produced by PnET-Succession with the data.</p><p>We could of course simply plot the curves produced by PnET-Succession onto the data points directly, and estimate visually if the fit is good. But I prefer to produce curves that we can use to automatize the calibration process (with a curve, we can compute the difference between the PnET-Succession curve and the one we have from the data).</p><p>I’ve ended up making two sets of curves with two different methods :</p><ul><li>The first one is a simple algorithm that builds a curve based on a set of rules to go from data point to data point, and then smooth the curve.</li><li>The second one uses a Generalized Additive Model (GAM) fitted on pre-processed data. The GAM is then used to generate curves of biomass for different levels of abundance.</li></ul><p>In the next sections, I’ll briefly describe both methods and show the curves produced by each before comparing the curves from both methods.</p></div><div id="kMk1ottksU" class="relative group/block"><h5 id="producing-growth-curves-from-nfi-data-with-a-simple-curve-construction-algorithm" class="relative group"><span class="heading-text">Producing growth curves from NFI data with a simple curve-construction algorithm</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#producing-growth-curves-from-nfi-data-with-a-simple-curve-construction-algorithm" title="Link to this Section" aria-label="Link to this Section">¶</a></h5></div><div id="gGF40HmPD6" class="relative group/block"><p>I’ve used a relatively simple algorithim to estimate these curves based on the data :</p><img id="yReFT2XSK2" style="margin:0 auto" src="https://klemet.github.io/Calibration_PnET_DIVERSE/build/Algorithm_GrowthCurv-fc445ac3fd5e0813654caa5495dcaf2b.png" data-canonical-url="./Images/Algorithm_GrowthCurves_NFI.png" class=""/><p>We will save these curves in <code>.csv</code> files so that we can use them later during the calibration.</p><p>To learn more, take a look at the function <code>analyze_species_growth_curves</code> in <a target="_blank" rel="noreferrer" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/functionsForCalibrat-b40081e509ffb38bec265f38bc99c65a.py" class="">functionsForCalibration<wbr/>.py</a>.</p></div><div id="uX7GvXFrYc" class="relative group/block"><h6 id="producing-estimated-growth-curves-for-abies-balsamea-with-the-curve-construction-algorithm" class="relative group"><span class="heading-text">Producing estimated growth curves for <em>Abies balsamea</em> with the curve-construction algorithm</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#producing-estimated-growth-curves-for-abies-balsamea-with-the-curve-construction-algorithm" title="Link to this Section" aria-label="Link to this Section">¶</a></h6></div><div id="WsvrP0NXwk" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from functionsForCalibration import *

results = analyze_species_growth_curves(
    prevalence_raster_path=&#x27;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Abie_Bal_v1.tif&#x27;,
    age_raster_path=&#x27;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif&#x27;,
    biomass_raster_path=&#x27;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif&#x27;,
    species_name=&#x27;Abies balsamea&#x27;,
    output_csv_path=&#x27;./ReferencesAndData/Growth Curves Predictions/abies_balsamea_estimated_growth_curves_NFI.csv&#x27;,
    prevalence_thresholds=[100, 80, 60, 40, 20],
    peak_age_min=0,
    peak_age_max=100,
    senescence_age_window=5,
    outlier_age_window=5,
    outlier_percentile=100, # Don&#x27;t remove any outlier for now
    smoothing_window=200,
    smoothing_polyorder=5,
    n_sample_plot=2000000,
    create_plot=True,
    plot_figsize=(20, 8)
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="GU77IjGYILJTY2S3b8Odw" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>=== Abies balsamea Growth Curve Analysis with Prevalence Thresholds ===
Parameters:
  Peak search range: 0-100 years
  Senescence age window: 5 years
  Outlier removal: 5-year windows, 100% threshold
  Smoothing window: 200 points
  Prevalence thresholds: [100, 80, 60, 40, 20]
Reading raster files...
✓ Rasters loaded successfully
Processing data and applying masks...
✓ 32674827 valid pixels found
Removing outliers (age window: 5 years, percentile: 100%)...
Processing 70 age windows...
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Processing age windows: 100%|██████████████████████████████████████████████████████████| 70/70 [00:03&lt;00:00, 22.67it/s]
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>✓ 32674827 pixels remaining after outlier removal

Processing curves for each prevalence threshold...

--- Processing threshold 100% ---
  Threshold 100%: 32674827 points remaining (100.0% of original)
  Constructing growth curve...
  Interpolating to yearly intervals...
  Smoothing curve...
  ✓ Threshold 100%: 116 raw points, 286 smoothed points

--- Processing threshold 80% ---
  Threshold 80%: 32638147 points remaining (99.9% of original)
  Constructing growth curve...
  Interpolating to yearly intervals...
  Smoothing curve...
  ✓ Threshold 80%: 119 raw points, 286 smoothed points

--- Processing threshold 60% ---
  Threshold 60%: 32479798 points remaining (99.4% of original)
  Constructing growth curve...
  Interpolating to yearly intervals...
  Smoothing curve...
  ✓ Threshold 60%: 120 raw points, 286 smoothed points

--- Processing threshold 40% ---
  Threshold 40%: 31891113 points remaining (97.6% of original)
  Constructing growth curve...
  Interpolating to yearly intervals...
  Smoothing curve...
  ✓ Threshold 40%: 129 raw points, 286 smoothed points

--- Processing threshold 20% ---
  Threshold 20%: 27611936 points remaining (84.5% of original)
  Constructing growth curve...
  Interpolating to yearly intervals...
  Smoothing curve...
  ✓ Threshold 20%: 121 raw points, 286 smoothed points

Creating CSV output...
✓ CSV saved to: ./ReferencesAndData/Growth Curves Predictions/abies_balsamea_estimated_growth_curves_NFI.csv
Sampling 2000000 points with prevalence-based weighting...
✓ Sampled 2000000 points (avg prevalence: 21.8%)

Creating visualization...
</span></code></pre></div><img src="https://klemet.github.io/Calibration_PnET_DIVERSE/build/cc4cf000457ada919ca0dfabc8fadfd0.png" alt="&lt;Figure size 2000x800 with 4 Axes&gt;"/><div><pre class="text-sm font-thin font-system"><code><span>
=== Analysis Complete ===
Total processing time: 108.3 seconds
Processed 32674827 pixels total
CSV saved to: ./ReferencesAndData/Growth Curves Predictions/abies_balsamea_estimated_growth_curves_NFI.csv

Curve Summary:
  Threshold ≤20%: Peak 31.11 tons/ha at age 74.0 (27611936 points)
  Threshold ≤40%: Peak 55.17 tons/ha at age 72.0 (31891113 points)
  Threshold ≤60%: Peak 73.65 tons/ha at age 71.0 (32479798 points)
  Threshold ≤80%: Peak 88.76 tons/ha at age 72.0 (32638147 points)
  Threshold ≤100%: Peak 93.02 tons/ha at age 67.0 (32674827 points)
</span></code></pre></div></div></div><div id="pDc69Muh2i" class="relative group/block"><h6 id="producing-estimated-growth-curves-for-acer-rubrum-with-the-curve-construction-algorithm" class="relative group"><span class="heading-text">Producing estimated growth curves for <em>Acer rubrum</em> with the curve-construction algorithm</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#producing-estimated-growth-curves-for-acer-rubrum-with-the-curve-construction-algorithm" title="Link to this Section" aria-label="Link to this Section">¶</a></h6></div><div id="IiJFlfmNW4" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from functionsForCalibration import *

results = analyze_species_growth_curves(
    prevalence_raster_path=&#x27;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Acer_Rub_v1.tif&#x27;,
    age_raster_path=&#x27;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif&#x27;,
    biomass_raster_path=&#x27;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif&#x27;,
    species_name=&#x27;Acer rubrum&#x27;,
    output_csv_path=&#x27;./ReferencesAndData/Growth Curves Predictions/acer_rubrum_estimated_growth_curves_NFI.csv&#x27;,
    prevalence_thresholds=[100, 80, 60, 40, 20],
    peak_age_min=0,
    peak_age_max=100,
    senescence_age_window=5,
    outlier_age_window=5,
    outlier_percentile=100, # Don&#x27;t remove any outlier for now
    smoothing_window=200,
    smoothing_polyorder=5,
    n_sample_plot=2000000,
    create_plot=True,
    plot_figsize=(20, 8)
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="hO4akN8yv2mt75TUaO1d1" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>=== Acer rubrum Growth Curve Analysis with Prevalence Thresholds ===
Parameters:
  Peak search range: 0-100 years
  Senescence age window: 5 years
  Outlier removal: 5-year windows, 100% threshold
  Smoothing window: 200 points
  Prevalence thresholds: [100, 80, 60, 40, 20]
Reading raster files...
✓ Rasters loaded successfully
Processing data and applying masks...
✓ 8337062 valid pixels found
Removing outliers (age window: 5 years, percentile: 100%)...
Processing 51 age windows...
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Processing age windows: 100%|██████████████████████████████████████████████████████████| 51/51 [00:00&lt;00:00, 100.27it/s]
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>✓ 8337062 pixels remaining after outlier removal

Processing curves for each prevalence threshold...

--- Processing threshold 100% ---
  Threshold 100%: 8337062 points remaining (100.0% of original)
  Constructing growth curve...
  Interpolating to yearly intervals...
  Smoothing curve...
  ✓ Threshold 100%: 96 raw points, 185 smoothed points

--- Processing threshold 80% ---
  Threshold 80%: 8337062 points remaining (100.0% of original)
  Constructing growth curve...
  Interpolating to yearly intervals...
  Smoothing curve...
  ✓ Threshold 80%: 96 raw points, 185 smoothed points

--- Processing threshold 60% ---
  Threshold 60%: 8337061 points remaining (100.0% of original)
  Constructing growth curve...
  Interpolating to yearly intervals...
  Smoothing curve...
  ✓ Threshold 60%: 96 raw points, 185 smoothed points

--- Processing threshold 40% ---
  Threshold 40%: 8312061 points remaining (99.7% of original)
  Constructing growth curve...
  Interpolating to yearly intervals...
  Smoothing curve...
  ✓ Threshold 40%: 92 raw points, 185 smoothed points

--- Processing threshold 20% ---
  Threshold 20%: 7763982 points remaining (93.1% of original)
  Constructing growth curve...
  Interpolating to yearly intervals...
  Smoothing curve...
  ✓ Threshold 20%: 93 raw points, 185 smoothed points

Creating CSV output...
✓ CSV saved to: ./ReferencesAndData/acer_rubrum_estimated_growth_curves_NFI.csv
Sampling 2000000 points with prevalence-based weighting...
✓ Sampled 2000000 points (avg prevalence: 13.1%)

Creating visualization...
</span></code></pre></div><img src="https://klemet.github.io/Calibration_PnET_DIVERSE/build/aa10c038066db7b1655fa5c903bd4517.png" alt="&lt;Figure size 2000x800 with 4 Axes&gt;"/><div><pre class="text-sm font-thin font-system"><code><span>
=== Analysis Complete ===
Total processing time: 67.3 seconds
Processed 8337062 pixels total
CSV saved to: ./ReferencesAndData/acer_rubrum_estimated_growth_curves_NFI.csv

Curve Summary:
  Threshold ≤20%: Peak 31.89 tons/ha at age 70.0 (7763982 points)
  Threshold ≤40%: Peak 48.14 tons/ha at age 62.0 (8312061 points)
  Threshold ≤60%: Peak 50.80 tons/ha at age 62.0 (8337061 points)
  Threshold ≤80%: Peak 50.77 tons/ha at age 62.0 (8337062 points)
  Threshold ≤100%: Peak 50.77 tons/ha at age 62.0 (8337062 points)
</span></code></pre></div></div></div><div id="AU6VaMGkH0" class="relative group/block"><h6 id="producing-estimated-growth-curves-for-picea-mariana-with-the-curve-construction-algorithm" class="relative group"><span class="heading-text">Producing estimated growth curves for <em>Picea mariana</em> with the curve-construction algorithm</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#producing-estimated-growth-curves-for-picea-mariana-with-the-curve-construction-algorithm" title="Link to this Section" aria-label="Link to this Section">¶</a></h6><p>We’re taking a look at our third species, <em>Picea mariana</em>. Same protocol as previous section with <em>Abies balsamea</em>.</p></div><div id="jQwwzWn5tb" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from functionsForCalibration import *

results = analyze_species_growth_curves(
    prevalence_raster_path=&#x27;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Pice_Mar_v1.tif&#x27;,
    age_raster_path=&#x27;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif&#x27;,
    biomass_raster_path=&#x27;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif&#x27;,
    species_name=&#x27;Picea Mariana&#x27;,
    output_csv_path=&#x27;./ReferencesAndData/Growth Curves Predictions/picea_mariana_estimated_growth_curves_NFI.csv&#x27;,
    prevalence_thresholds=[100, 80, 60, 40, 20],
    peak_age_min=0,
    peak_age_max=200, # Peak is a bit later for Picea mariana compared to Abies balsamea and Acer rubrum
    senescence_age_window=5,
    outlier_age_window=5,
    outlier_percentile=100, # Don&#x27;t remove any outlier for now
    smoothing_window=200,
    smoothing_polyorder=5,
    n_sample_plot=2000000,
    create_plot=True,
    plot_figsize=(20, 8)
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="H7PvevSoavZr-CnqJJqlV" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>=== Picea Mariana Growth Curve Analysis with Prevalence Thresholds ===
Parameters:
  Peak search range: 0-200 years
  Senescence age window: 5 years
  Outlier removal: 5-year windows, 100% threshold
  Smoothing window: 200 points
  Prevalence thresholds: [100, 80, 60, 40, 20]
Reading raster files...
✓ Rasters loaded successfully
Processing data and applying masks...
✓ 80116986 valid pixels found
Removing outliers (age window: 5 years, percentile: 100%)...
Processing 70 age windows...
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Processing age windows: 100%|██████████████████████████████████████████████████████████| 70/70 [00:07&lt;00:00,  9.66it/s]
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>✓ 80116986 pixels remaining after outlier removal

Processing curves for each prevalence threshold...

--- Processing threshold 100% ---
  Threshold 100%: 80116986 points remaining (100.0% of original)
  Constructing growth curve...
  Interpolating to yearly intervals...
  Smoothing curve...
  ✓ Threshold 100%: 124 raw points, 295 smoothed points

--- Processing threshold 80% ---
  Threshold 80%: 71328226 points remaining (89.0% of original)
  Constructing growth curve...
  Interpolating to yearly intervals...
  Smoothing curve...
  ✓ Threshold 80%: 120 raw points, 295 smoothed points

--- Processing threshold 60% ---
  Threshold 60%: 58280657 points remaining (72.7% of original)
  Constructing growth curve...
  Interpolating to yearly intervals...
  Smoothing curve...
  ✓ Threshold 60%: 121 raw points, 295 smoothed points

--- Processing threshold 40% ---
  Threshold 40%: 44835036 points remaining (56.0% of original)
  Constructing growth curve...
  Interpolating to yearly intervals...
  Smoothing curve...
  ✓ Threshold 40%: 104 raw points, 295 smoothed points

--- Processing threshold 20% ---
  Threshold 20%: 21607588 points remaining (27.0% of original)
  Constructing growth curve...
  Interpolating to yearly intervals...
  Smoothing curve...
  ✓ Threshold 20%: 96 raw points, 281 smoothed points

Creating CSV output...
✓ CSV saved to: ./ReferencesAndData/Growth Curves Predictions/picea_mariana_estimated_growth_curves_NFI.csv
Sampling 2000000 points with prevalence-based weighting...
✓ Sampled 2000000 points (avg prevalence: 58.9%)

Creating visualization...
</span></code></pre></div><img src="https://klemet.github.io/Calibration_PnET_DIVERSE/build/aee705277451a88bc310ea1938dc9dd6.png" alt="&lt;Figure size 2000x800 with 4 Axes&gt;"/><div><pre class="text-sm font-thin font-system"><code><span>
=== Analysis Complete ===
Total processing time: 189.5 seconds
Processed 80116986 pixels total
CSV saved to: ./ReferencesAndData/Growth Curves Predictions/picea_mariana_estimated_growth_curves_NFI.csv

Curve Summary:
  Threshold ≤20%: Peak 58.37 tons/ha at age 151.0 (21607588 points)
  Threshold ≤40%: Peak 80.00 tons/ha at age 164.0 (44835036 points)
  Threshold ≤60%: Peak 106.50 tons/ha at age 122.0 (58280657 points)
  Threshold ≤80%: Peak 139.02 tons/ha at age 122.0 (71328226 points)
  Threshold ≤100%: Peak 162.61 tons/ha at age 130.0 (80116986 points)
</span></code></pre></div></div></div><div id="VMS4lppcW1" class="relative group/block"><h5 id="producing-growth-curves-from-nfi-data-with-a-generalized-additive-model-gam" class="relative group"><span class="heading-text">Producing growth curves from NFI data with a Generalized Additive Model (GAM)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#producing-growth-curves-from-nfi-data-with-a-generalized-additive-model-gam" title="Link to this Section" aria-label="Link to this Section">¶</a></h5></div><div id="OBtT223JFv" class="relative group/block"><p>Here, we process the data in order to identify the highest percentiles of biomass for each species for set of successive age windows and abundance windows (see figure below). Once we have identified these percentile, we use a <a href="https://en.wikipedia.org/wiki/Generalized_additive_model" class="italic" target="_blank" rel="noreferrer" data-state="closed">Generalize Additive Model</a> (GAM) fitted on this processed data in order to predict the percentile values as a fonction of age, but also of the percentage of abundance of the species in a cell. GAMs are dealt with using the <a target="_blank" rel="noreferrer" href="https://pygam.readthedocs.io/en/latest/" class="">pyGAM package</a>.</p><p>This is essential for species like <em>Acer rubrum</em> in our dataset for which most of the pixels where the species is present do not have a high abundance for the species; for the great majority of pixels values for <em>Acer rubrum</em>, we do not go beyond 60% of abundance of <em>Acer rubrum</em> in the stand (see figures above). However, remember that our goal here is to estimate (as much as can be) the growth of the species in ideal conditions, which includes no competition for light from other species, meaning in monoculture (100% abundance).</p><p>The use of a GAM allows us to make predictions about what would be the growth of the species in condition of full abundance (100%)/monoculture, even though we have no data or few data points/pixels with such an abundance.</p><p>The issue is that fitting a GAM on the NFI data was more difficult than I expected; because of the space-for-time substitution we’re doing and the fact that we’re looking at data from the entire province, it seems that the patterns in the data (e.g. effect of age and abundance on biomass) can seem quite clear to the human eye, but can be difficult to mirror properly in a GAM. The overabundance of low-abundance pixels, and also the presence of some high-abundance pixels with relatively low biomass values and other outliers tended to create unexpected and absurd GAM behaviour.</p><p>I solved this issue by pre-processing the data (see figure below) to 1) reduce the number of points, 2) remove the outliers, and 3) force a monotonic increasing rule regarding the effect of abundance of the high percentiles of biomass. This pre-processing is highly customizible, allowing you to define the size of the windows, the percentile computed, or to exclude certain pixels; see the function <code>prepareNFIDataForGAMs</code>. The fitting of the GAM can also be customised.</p><p>The best GAM structure I’ve found so far to produce these curve is the following :</p><p><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>High Biomass Percentile</mtext><mo>=</mo><mi>s</mi><mo stretchy="false">(</mo><mi>a</mi><mi>g</mi><mi>e</mi><mo separator="true">,</mo><mtext>with a concave constraint</mtext><mo stretchy="false">)</mo><mo>+</mo><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo stretchy="false">(</mo><mi>a</mi><mi>g</mi><mi>e</mi><mo separator="true">,</mo><mi mathvariant="normal">%</mi><mi>a</mi><mi>b</mi><mi>u</mi><mi>n</mi><mi>d</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mo separator="true">,</mo><mtext>with a concave constraint</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{High Biomass Percentile} = s(age, \text{with a concave constraint}) + interaction(age, \% abundance, \text{with a concave constraint})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">High Biomass Percentile</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">with a concave constraint</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">in</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">%</span><span class="mord mathnormal">ab</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mord mathnormal">an</span><span class="mord mathnormal">ce</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">with a concave constraint</span></span><span class="mclose">)</span></span></span></span></span></p><p>The concave constrait force the effect of age and the 2D plane of the interaction effect (tensor product) of age and % abundance to be concave, which matches the biological reality that after a certain age, the biomass of the species will decrease.</p><img id="pzfsSvZHTO" style="margin:0 auto" src="https://klemet.github.io/Calibration_PnET_DIVERSE/build/GAM_DataProessing_NF-3357e4b65ceb134f9c46dd8300697344.PNG" data-canonical-url="./Images/GAM_DataProessing_NFI_Method.PNG" class=""/></div><div id="l4tFPtEVlv" class="relative group/block"><h6 id="producing-estimated-growth-curves-for-abies-balsamea-with-a-gam" class="relative group"><span class="heading-text">Producing estimated growth curves for <em>Abies balsamea</em> with a GAM</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#producing-estimated-growth-curves-for-abies-balsamea-with-a-gam" title="Link to this Section" aria-label="Link to this Section">¶</a></h6></div><div id="nd1XhxUPsU" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from functionsForCalibration import *

windowed_df = prepareNFIDataForGAMs(abundance_path = &#x27;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Abie_Bal_v1.tif&#x27;,
                                  age_path = &#x27;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif&#x27;,
                                  biomass_path = &#x27;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif&#x27;,
                                  speciesName = &quot;Abies balsamea&quot;,
                                  age_window = 5,
                                  abundance_window = 10,
                                  percentile = 100,
                                  mask_path = None,
                                  printPlot = False)

createGAMsAndPredictionsForNFIDataGrowthCurves(windowed_df,
                                                &#x27;./ReferencesAndData/Growth Curves Predictions/Abies Balsamea_gam_predictions.csv&#x27;,
                                               &quot;Abies balsamea&quot;,
                                                cutoff_age = 150,
                                                abundance_levels = [100, 80, 60, 40, 20],
                                                printPlot = True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="szB1GIYKB_YR5QgP25TtO" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Reading raster data...
Creating initial dataframe...
Initial dataframe shape: (32674827, 3)
Age range: 0.0 - 348.4
Abundance range: 0.0 - 100.0

Processing with parameters:
Age window: 5
Abundance window: 10
Percentile: 100

Creating windowed dataframe...
Applied monotonic abundance constraint - kept 350 entries
Windowed dataframe shape: (350, 3)
No data points found in the specified windows!
Filtering data by age cutoff...
Original dataframe shape: (350, 3)
Filtered dataframe shape (Age &lt; 150): (236, 3)
Filtered age range: 0.0 - 147.5
Filtered abundance range: 5.0 - 95.0

Fitting weighted GAM model...
did not converge
GAM fitted successfully with constraints and abundance weighting!
GAM summary:
  - Number of observations: 236
  - R-squared (pseudo): 0.943
  - Constraints applied:
    * Age effect: concave
    * Tensor product interaction: concave
    * Intercept forced to 0
    * Weighted toward high abundance observations

Generating predictions for abundance levels: [100, 80, 60, 40, 20]
Generated predictions for 100% abundance:
  - Biomass range: 11.86 - 95.97
  - Value at age 0: 11.856283
Generated predictions for 80% abundance:
  - Biomass range: 7.58 - 91.05
  - Value at age 0: 7.575023
Generated predictions for 60% abundance:
  - Biomass range: 1.93 - 85.51
  - Value at age 0: 1.934564
Generated predictions for 40% abundance:
  - Biomass range: -4.76 - 73.33
  - Value at age 0: -4.760048
Generated predictions for 20% abundance:
  - Biomass range: -13.71 - 52.83
  - Value at age 0: -13.714163

Creating plot with multiple GAM predictions...
</span></code></pre></div><img src="https://klemet.github.io/Calibration_PnET_DIVERSE/build/4e22d868c9abd32175fc1fe04e375b9c.png" alt="&lt;Figure size 1600x1000 with 2 Axes&gt;"/><div><pre class="text-sm font-thin font-system"><code><span>
GAM Model Information:
Cutoff age used: 150 years
Data points used for fitting: 236
Prediction curves: 0-150 years for 5 abundance levels
Model constraints and weighting applied successfully
Predictions exported to ./ReferencesAndData/Growth Curves Predictions/Abies Balsamea_gam_predictions.csv
Shape: (100, 6)
Columns: [&#x27;Age&#x27;, &#x27;GAM_Prediction_100%Abundance&#x27;, &#x27;GAM_Prediction_80%Abundance&#x27;, &#x27;GAM_Prediction_60%Abundance&#x27;, &#x27;GAM_Prediction_40%Abundance&#x27;, &#x27;GAM_Prediction_20%Abundance&#x27;]
Age range: 0.0 - 150.0

Preview of exported data:
        Age  GAM_Prediction_100%Abundance  GAM_Prediction_80%Abundance  \
0  0.000000                     11.856283                     7.575023   
1  1.515152                     15.636944                    11.182145   
2  3.030303                     19.377459                    14.753408   
3  4.545455                     23.069911                    18.281029   
4  6.060606                     26.706385                    21.757229   

   GAM_Prediction_60%Abundance  GAM_Prediction_40%Abundance  \
0                     1.934564                    -4.760048   
1                     5.252371                    -1.752317   
2                     8.536013                     1.221635   
3                    11.779049                     4.155960   
4                    14.975040                     7.044810   

   GAM_Prediction_20%Abundance  
0                   -13.714163  
1                   -10.932160  
2                    -8.182467  
3                    -5.470878  
4                    -2.803186  
</span></code></pre></div></div></div><div id="awuL9dXbNn" class="relative group/block"><h6 id="producing-estimated-growth-curves-for-acer-rubrum-with-a-gam" class="relative group"><span class="heading-text">Producing estimated growth curves for <em>Acer rubrum</em> with a GAM</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#producing-estimated-growth-curves-for-acer-rubrum-with-a-gam" title="Link to this Section" aria-label="Link to this Section">¶</a></h6></div><div id="irmC0xS3w0" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from functionsForCalibration import *

windowed_df = prepareNFIDataForGAMs(abundance_path = &#x27;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Acer_Rub_v1.tif&#x27;,
                                  age_path = &#x27;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif&#x27;,
                                  biomass_path = &#x27;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif&#x27;,
                                  speciesName = &quot;Acer rubrum&quot;,
                                  age_window = 5,
                                  abundance_window = 10,
                                  percentile = 100,
                                  mask_path = None,
                                  printPlot = False)

createGAMsAndPredictionsForNFIDataGrowthCurves(windowed_df,
                                                &#x27;./ReferencesAndData/Growth Curves Predictions/Acer rubrum_gam_predictions.csv&#x27;,
                                               &quot;Acer rubrum&quot;,
                                                cutoff_age = 150,
                                                abundance_levels = [100, 80, 60, 40, 20],
                                                printPlot = True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="bro824xJA_VNeeOLshEbB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Reading raster data...
Creating initial dataframe...
Initial dataframe shape: (8337062, 3)
Age range: 0.0 - 251.8
Abundance range: 0.0 - 60.9

Processing with parameters:
Age window: 5
Abundance window: 10
Percentile: 100

Creating windowed dataframe...
Applied monotonic abundance constraint - kept 155 entries
Windowed dataframe shape: (155, 3)
No data points found in the specified windows!
Filtering data by age cutoff...
Original dataframe shape: (155, 3)
Filtered dataframe shape (Age &lt; 150): (118, 3)
Filtered age range: 0.0 - 147.5
Filtered abundance range: 5.0 - 95.0

Fitting weighted GAM model...
did not converge
GAM fitted successfully with constraints and abundance weighting!
GAM summary:
  - Number of observations: 118
  - R-squared (pseudo): 0.978
  - Constraints applied:
    * Age effect: concave
    * Tensor product interaction: concave
    * Intercept forced to 0
    * Weighted toward high abundance observations

Generating predictions for abundance levels: [100, 80, 60, 40, 20]
Generated predictions for 100% abundance:
  - Biomass range: -0.09 - 90.48
  - Value at age 0: -0.092426
Generated predictions for 80% abundance:
  - Biomass range: 0.68 - 73.15
  - Value at age 0: 0.680676
Generated predictions for 60% abundance:
  - Biomass range: 1.24 - 62.20
  - Value at age 0: 1.237291
Generated predictions for 40% abundance:
  - Biomass range: 0.88 - 51.93
  - Value at age 0: 0.880931
Generated predictions for 20% abundance:
  - Biomass range: -0.77 - 40.20
  - Value at age 0: -0.774627

Creating plot with multiple GAM predictions...
</span></code></pre></div><img src="https://klemet.github.io/Calibration_PnET_DIVERSE/build/00a2ac33f4584fed02010dce7ff226b8.png" alt="&lt;Figure size 1600x1000 with 2 Axes&gt;"/><div><pre class="text-sm font-thin font-system"><code><span>
GAM Model Information:
Cutoff age used: 150 years
Data points used for fitting: 118
Prediction curves: 0-150 years for 5 abundance levels
Model constraints and weighting applied successfully
Predictions exported to ./ReferencesAndData/Growth Curves Predictions/Acer rubrum_gam_predictions.csv
Shape: (100, 6)
Columns: [&#x27;Age&#x27;, &#x27;GAM_Prediction_100%Abundance&#x27;, &#x27;GAM_Prediction_80%Abundance&#x27;, &#x27;GAM_Prediction_60%Abundance&#x27;, &#x27;GAM_Prediction_40%Abundance&#x27;, &#x27;GAM_Prediction_20%Abundance&#x27;]
Age range: 0.0 - 150.0

Preview of exported data:
        Age  GAM_Prediction_100%Abundance  GAM_Prediction_80%Abundance  \
0  0.000000                     -0.092426                     0.680676   
1  1.515152                      2.045502                     2.709385   
2  3.030303                      4.179371                     4.733866   
3  4.545455                      6.307968                     6.752787   
4  6.060606                      8.430078                     8.764815   

   GAM_Prediction_60%Abundance  GAM_Prediction_40%Abundance  \
0                     1.237291                     0.880931   
1                     3.142053                     2.597460   
2                     5.042615                     4.309738   
3                     6.937566                     6.016400   
4                     8.825494                     7.716084   

   GAM_Prediction_20%Abundance  
0                    -0.774627  
1                     0.686626  
2                     2.143208  
3                     3.593859  
4                     5.037319  
</span></code></pre></div></div></div><div id="CrE12gLS0w" class="relative group/block"><h6 id="producing-estimated-growth-curves-for-picea-mariana-with-a-gam" class="relative group"><span class="heading-text">Producing estimated growth curves for <em>Picea mariana</em> with a GAM</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#producing-estimated-growth-curves-for-picea-mariana-with-a-gam" title="Link to this Section" aria-label="Link to this Section">¶</a></h6></div><div id="C0BYd96Fe3" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from functionsForCalibration import *

windowed_df = prepareNFIDataForGAMs(abundance_path = &#x27;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Pice_Mar_v1.tif&#x27;,
                                  age_path = &#x27;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif&#x27;,
                                  biomass_path = &#x27;./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif&#x27;,
                                  speciesName = &quot;Picea mariana&quot;,
                                  age_window = 5,
                                  abundance_window = 10,
                                  percentile = 100,
                                  mask_path = None,
                                  printPlot = False)

createGAMsAndPredictionsForNFIDataGrowthCurves(windowed_df,
                                                &#x27;./ReferencesAndData/Growth Curves Predictions/Picea mariana_gam_predictions.csv&#x27;,
                                               &quot;Picea mariana&quot;,
                                                cutoff_age = 200, # The take more data as the pic of Picea mariana seems to be later than for Abies balsamea and Acer rubrum
                                                abundance_levels = [100, 80, 60, 40, 20],
                                                printPlot = True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="TKRgX2MuA8UMVjYpwQbrd" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Reading raster data...
Creating initial dataframe...
Initial dataframe shape: (80116986, 3)
Age range: 0.0 - 348.4
Abundance range: 0.0 - 100.0

Processing with parameters:
Age window: 5
Abundance window: 10
Percentile: 100

Creating windowed dataframe...
Applied monotonic abundance constraint - kept 404 entries
Windowed dataframe shape: (404, 3)
No data points found in the specified windows!
Filtering data by age cutoff...
Original dataframe shape: (404, 3)
Filtered dataframe shape (Age &lt; 200): (310, 3)
Filtered age range: 0.0 - 197.5
Filtered abundance range: 5.0 - 95.0

Fitting weighted GAM model...
GAM fitted successfully with constraints and abundance weighting!
GAM summary:
  - Number of observations: 310
  - R-squared (pseudo): 0.986
  - Constraints applied:
    * Age effect: concave
    * Tensor product interaction: concave
    * Intercept forced to 0
    * Weighted toward high abundance observations

Generating predictions for abundance levels: [100, 80, 60, 40, 20]
Generated predictions for 100% abundance:
  - Biomass range: 1.62 - 162.79
  - Value at age 0: 1.619057
Generated predictions for 80% abundance:
  - Biomass range: 4.53 - 137.91
  - Value at age 0: 4.533635
Generated predictions for 60% abundance:
  - Biomass range: 5.99 - 111.49
  - Value at age 0: 5.992570
Generated predictions for 40% abundance:
  - Biomass range: 3.08 - 83.63
  - Value at age 0: 3.082758
Generated predictions for 20% abundance:
  - Biomass range: -6.66 - 54.52
  - Value at age 0: -6.659307

Creating plot with multiple GAM predictions...
</span></code></pre></div><img src="https://klemet.github.io/Calibration_PnET_DIVERSE/build/a8b37048c3f11cefcd5b9c3276408f07.png" alt="&lt;Figure size 1600x1000 with 2 Axes&gt;"/><div><pre class="text-sm font-thin font-system"><code><span>
GAM Model Information:
Cutoff age used: 200 years
Data points used for fitting: 310
Prediction curves: 0-200 years for 5 abundance levels
Model constraints and weighting applied successfully
Predictions exported to ./ReferencesAndData/Growth Curves Predictions/Picea mariana_gam_predictions.csv
Shape: (100, 6)
Columns: [&#x27;Age&#x27;, &#x27;GAM_Prediction_100%Abundance&#x27;, &#x27;GAM_Prediction_80%Abundance&#x27;, &#x27;GAM_Prediction_60%Abundance&#x27;, &#x27;GAM_Prediction_40%Abundance&#x27;, &#x27;GAM_Prediction_20%Abundance&#x27;]
Age range: 0.0 - 200.0

Preview of exported data:
        Age  GAM_Prediction_100%Abundance  GAM_Prediction_80%Abundance  \
0  0.000000                      1.619057                     4.533635   
1  2.020202                      5.081319                     7.759642   
2  4.040404                      8.529249                    10.973141   
3  6.060606                     11.962244                    14.173377   
4  8.080808                     15.379699                    17.359592   

   GAM_Prediction_60%Abundance  GAM_Prediction_40%Abundance  \
0                     5.992570                     3.082758   
1                     8.864901                     5.428215   
2                    11.722846                     7.755498   
3                    14.565205                    10.063526   
4                    17.390782                    12.351221   

   GAM_Prediction_20%Abundance  
0                    -6.659307  
1                    -4.793040  
2                    -2.943452  
3                    -1.111152  
4                     0.703252  
</span></code></pre></div></div></div><div id="sbEaW99ElL" class="relative group/block"><h3 id="values-needed-to-estimate-certain-parameters" class="relative group"><span class="heading-text">Values needed to estimate certain parameters</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#values-needed-to-estimate-certain-parameters" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="C5BM96kqjC" class="relative group/block"><h4 id="longevity-and-max-longevity" class="relative group"><span class="heading-text">Longevity and Max Longevity</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#longevity-and-max-longevity" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="RPTj38i99F" class="relative group/block"><p>What we will call here “Longevity” and “Max Longevity” are necessary to calibrate the senescence part of the growth curve for our species.</p><p>The difference between the two is this, per the team of Brian Sturtevant who explained their methodology to me :</p><ul><li>Longevity is the rule-of-thumb, expert opinion longevity for a given tree species. This is the age at which it’s expected that a tree of a given species will die, in a give region. These are the number often reported in the litterature, and also used in the core species parameter file of LANDIS-II as its “Longevity” parameter for each tree species used.</li><li>Max Longevity is the real, empirical maximum age that a tree species can reach in the study area. It’s often not reported and difficult to find. A good way to find it is to look at sample plot data and find the oldest trees ever found for a given species (which can be difficult to find as the “age” data is often not directly available in sample plots data).</li></ul><p>Brian Sturtevant and his team have used these two notions to calibrate the senescence part of the growth curves in ideal conditions as explained in <a target="_blank" rel="noreferrer" href="./6.Monoculture_ideal_conditions.py" class=""></a>.  This part from <cite class="" data-state="closed"><a href="https://doi.org/10.1139/cjfr-2024-0085" target="_blank" rel="noreferrer" class="hover-link">this supplementary material of Reese et al. (2025)</a></cite> describes Brian’s methodology of explains it all :</p><blockquote><p>We used an unpublished review and analysis led by John Du Plissis at the University of Minnesota-Duluth to define both tree species longevity (the age at which a species age cohort can no longer persist) and the initiation of decline that is defined by the age-related photosynthesis reduction factor (<abbr aria-label="Reduction factor of photosynthesis as the age of an age cohort increases." class="border-b border-dotted cursor-help" data-state="closed">PsnAgeRed</abbr>) parameter in PnET Succession. In general, the maximum species longevity of Loehle (1988) corresponds with the tree species longevity parameter, while the typical species’ longevity from the same publication determines the initiation of decline, where <abbr aria-label="Reduction factor of photosynthesis as the age of an age cohort increases." class="border-b border-dotted cursor-help" data-state="closed">PsnAgeRed</abbr> is calibrated such that the fAGE (age reduction factor) begins to decline (~0.99) at the Typical Mortality age of the species.</p></blockquote><p>The data used by Brian’s team for Typical Longevity and Max Longevity are cited as coming from <cite class="" data-state="closed"><a href="https://doi.org/10.1139/x88-032" target="_blank" rel="noreferrer" class="hover-link">Loehle (1988)</a></cite> in ReeseEtAl_CanJForRes_2024_supplA.docx ; it’s an article that seem to compute them based on several characteristics of tree species.</p><p>In the end, Brian’s team is using a combination of data from <cite class="" data-state="closed"><a href="https://doi.org/10.1139/x88-032" target="_blank" rel="noreferrer" class="hover-link">Loehle (1988)</a></cite> and estimates found by John Du Plissis (yet unpublished). I’m going to use the data from <cite class="" data-state="closed"><a href="https://doi.org/10.1139/x88-032" target="_blank" rel="noreferrer" class="hover-link">Loehle (1988)</a></cite>, which should be enough for our goals until the data from Du Plissis is published.</p><p><cite class="" data-state="closed"><a href="https://doi.org/10.1139/x88-032" target="_blank" rel="noreferrer" class="hover-link">Loehle (1988)</a></cite>, defines “Typical” versus “Maximum” longevity in the following terms :</p><blockquote><p>Typical longevity is the age of the older trees in an old-growth stand, whereas maximum longevity is the upper known maximum above which very few trees are found.</p></blockquote><p>We can find the value of typical longevity and maximum longevity from Loehle in the Appendix 1. Here are the values for our three species :</p></div><div id="BLXiX4oNeT" class="relative group/block"><table class=""><tbody><tr class=""><th class="text-left">Species</th><th class="text-left">MINREP (years)</th><th class="text-left">AVEREP (years)</th><th class="text-left">TYPMORT (years)</th><th class="text-left">MAXMORT (years)</th><th class="text-left">Specific gravity</th><th class="text-left">Growth rate</th><th class="text-left">Shade tolerance</th><th class="text-left">Volumetric heat (J·cm⁻³)</th><th class="text-left">Decay resistance</th></tr><tr class=""><td class="text-left"><em>Abies balsamea</em></td><td class="text-left">15</td><td class="text-left">30</td><td class="text-left">125</td><td class="text-left">150</td><td class="text-left">0.34</td><td class="text-left">4</td><td class="text-left">5</td><td class="text-left">6.42</td><td class="text-left">1</td></tr><tr class=""><td class="text-left"><em>Picea mariana</em></td><td class="text-left">10</td><td class="text-left">18</td><td class="text-left">150</td><td class="text-left">250</td><td class="text-left">0.43</td><td class="text-left">2</td><td class="text-left">4</td><td class="text-left">7.91</td><td class="text-left">1</td></tr><tr class=""><td class="text-left"><em>Acer rubrum</em></td><td class="text-left">4</td><td class="text-left"></td><td class="text-left">80</td><td class="text-left">150</td><td class="text-left">0.49</td><td class="text-left">4</td><td class="text-left">2</td><td class="text-left">9.93</td><td class="text-left">1</td></tr></tbody></table></div><div id="me62Ar65Tn" class="relative group/block"><h3 id="ranges-of-parameter-values-for-the-calibration" class="relative group"><span class="heading-text">Ranges of parameter values for the calibration</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#ranges-of-parameter-values-for-the-calibration" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="WRgD5CXKl6" class="relative group/block"><p>Table with ranges extracted from the litterature for most PnET parameters ?</p></div><div id="HFSpdSNU43" class="relative group/block"><p>From Brian’s  team (ReeseEtAl_CanJForRes_2024_supplA.docx) :</p><blockquote><p>Parameter calibrations were guided by plausible ranges for ecophysiological parameter values and species traits from the TRY Plant Trait Database (<a target="_blank" rel="noreferrer" href="https://www.try-db.org/TryWeb/Home.php" class="">https://<wbr/>www<wbr/>.try<wbr/>-db<wbr/>.org<wbr/>/TryWeb<wbr/>/Home<wbr/>.php</a>), cross-referenced against region-specific species ecology from the Fire Effects Information System (<a target="_blank" rel="noreferrer" href="https://www.feis-crs.org/feis/" class="">https://<wbr/>www<wbr/>.feis<wbr/>-crs<wbr/>.org<wbr/>/feis/</a>).</p></blockquote></div><div id="KHstM90NTO" class="relative group/block"><p>From the user guide :</p><blockquote><p>The range of <abbr aria-label="Foliar nitrogen content (in % by weight) for the leaves of the species." class="border-b border-dotted cursor-help" data-state="closed">FolN</abbr> for each species across sites, age, canopy position. This is a great starting point and helps put bounds on acceptable values, but it is important to recognize that productivity is closely related to <abbr aria-label="Foliar nitrogen content (in % by weight) for the leaves of the species." class="border-b border-dotted cursor-help" data-state="closed">FolN</abbr> in PnET, so it is more important that <abbr aria-label="Foliar nitrogen content (in % by weight) for the leaves of the species." class="border-b border-dotted cursor-help" data-state="closed">FolN</abbr> reflect relative productivity among species than matching empirical values. That said, it is usually (but not always) possible to select a value of <abbr aria-label="Foliar nitrogen content (in % by weight) for the leaves of the species." class="border-b border-dotted cursor-help" data-state="closed">FolN</abbr> that is within the range of empirically measured values. If you have empirical values of Amax, use your values of <abbr aria-label="Intercept of the relationship between foliar N and maximum net photosynthetic rate." class="border-b border-dotted cursor-help" data-state="closed">AmaxA</abbr> and <abbr aria-label="Slope of the relationship betwee foliar N and maximum net photosynthetic rate." class="border-b border-dotted cursor-help" data-state="closed">AmaxB</abbr> (or see Fig. 2 in Aber et al. 1996) to estimate the <abbr aria-label="Foliar nitrogen content (in % by weight) for the leaves of the species." class="border-b border-dotted cursor-help" data-state="closed">FolN</abbr> that produces that Amax value. NOTE: if you plan to implement dynamic <abbr aria-label="Foliar nitrogen content (in % by weight) for the leaves of the species." class="border-b border-dotted cursor-help" data-state="closed">FolN</abbr> (<abbr aria-label="Foliar nitrogen content (in % by weight) for the leaves of the species." class="border-b border-dotted cursor-help" data-state="closed">FolN</abbr>Int and <abbr aria-label="Foliar nitrogen content (in % by weight) for the leaves of the species." class="border-b border-dotted cursor-help" data-state="closed">FolN</abbr>Slope set to values other than default), then be sure to set <abbr aria-label="Foliar nitrogen content (in % by weight) for the leaves of the species." class="border-b border-dotted cursor-help" data-state="closed">FolN</abbr>Int and <abbr aria-label="Foliar nitrogen content (in % by weight) for the leaves of the species." class="border-b border-dotted cursor-help" data-state="closed">FolN</abbr>Slope to the values you will use in your final simulations while calibrating.</p></blockquote><blockquote><p>Species <abbr aria-label="Specific leaf weight at the top of the canopy." class="border-b border-dotted cursor-help" data-state="closed">SLWmax</abbr> helps determine LAI. Thicker leaves (higher SLW) reduce LAI. LAI determines the ability of a cohort to compete for light, so it is important to calibrate so that LAI produces realistic response to light. Again, it is more important to get LAI approximately right than to keep <abbr aria-label="Specific leaf weight at the top of the canopy." class="border-b border-dotted cursor-help" data-state="closed">SLWmax</abbr> within the empirical range. Out-of-range <abbr aria-label="Specific leaf weight at the top of the canopy." class="border-b border-dotted cursor-help" data-state="closed">SLWmax</abbr> values often indicate that <abbr aria-label="Fraction of the active woody biomass (above or belowground) of a cohort that determines the amount of foliage maintained each year." class="border-b border-dotted cursor-help" data-state="closed">FracFol</abbr> values are incorrect. Note that higher LAI increases within-canopy competition for light and will modestly depress growth even of a single cohort. I have found that LAI values exceeding those given in Table 1 may greatly reduce the amount of light penetrating canopy layers, thus impacting growth, competition and establishment</p></blockquote><blockquote><p>There are some published estimates of whole tree biomass through time by species groups to provide some indication of belowground biomass (e.g., Smith et al. 2006). =&gt; Que ce sois cette source ou les modèles allometriques trouvés dans R, avoir des estimations du ration above/belowground serais très précieux.</p></blockquote></div><div id="A971hN3vnl" class="relative group/block"><h3 id="competition-outcomes-between-species" class="relative group"><span class="heading-text">Competition outcomes between species</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#competition-outcomes-between-species" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="qsLOpf3Jwb" class="relative group/block"><p>Based on litterature + expert opinion, in different conditions :</p><ul><li>Baseline + Good water level</li><li>Baseline + Drought</li><li>Baseline + Waterlogging</li><li>Climate change ++</li><li>Climate change +++</li></ul></div><div id="JWb94z7xeT" class="relative group/block"><h2 id="drafts" class="relative group"><span class="heading-text">DRAFTS</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#drafts" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div></div><section id="references" class="article-grid subgrid-gap col-screen"><div><header class="text-lg font-semibold text-stone-900 dark:text-white group">References<a class="no-underline text-inherit hover:text-inherit ml-2 select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#references" title="Link to References" aria-label="Link to References">¶</a></header></div><div class="pl-3 mb-8 text-xs text-stone-500 dark:text-stone-300"><ol><li class="break-words" id="cite-Pickett_1989">Pickett, S. T. A. (1989). Space-for-Time Substitution as an Alternative to Long-Term Studies. In <i>Long-Term Studies in Ecology</i> (pp. 110–135). Springer New York. <a target="_blank" rel="noreferrer" href="https://doi.org/10.1007/978-1-4615-7358-6_5">10.1007/978-1-4615-7358-6_5</a></li><li class="break-words" id="cite-Beaudoin_2018">Beaudoin, A., Bernier, P. Y., Villemaire, P., Guindon, L., & Guo, X. J. (2018). Tracking forest attributes across Canada between 2001 and 2011 using a k nearest neighbors mapping approach applied to MODIS imagery. <i>Canadian Journal of Forest Research</i>, <i>48</i>(1), 85–93. <a target="_blank" rel="noreferrer" href="https://doi.org/10.1139/cjfr-2017-0184">10.1139/cjfr-2017-0184</a></li><li class="break-words" id="cite-Reese_2025">Reese, G. C., Sturtevant, B. R., Dymond, C. C., Quigley, K. M., Duveneck, M. J., Lucash, M. S., Gustafson, E. J., Scheller, R. M., Russell, M. B., & Miranda, B. R. (2025). Best practices for calibration of forest landscape models using fine-scaled reference information. <i>Canadian Journal of Forest Research</i>, <i>55</i>, 1–19. <a target="_blank" rel="noreferrer" href="https://doi.org/10.1139/cjfr-2024-0085">10.1139/cjfr-2024-0085</a></li><li class="break-words" id="cite-Loehle_1988">Loehle, C. (1988). Tree life history strategies: the role of defenses. <i>Canadian Journal of Forest Research</i>, <i>18</i>(2), 209–222. <a target="_blank" rel="noreferrer" href="https://doi.org/10.1139/x88-032">10.1139/x88-032</a></li></ol></div></section><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="https://klemet.github.io/Calibration_PnET_DIVERSE/startingcalibrationtest/initial-species-parameters"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Calibration of PnET Succession for the DIVERSE project</div>Initial species parameters</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="https://klemet.github.io/Calibration_PnET_DIVERSE/startingcalibrationtest/getting-climate-and-soil-data"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">Calibration of PnET Succession for the DIVERSE project</div>Getting the climate and soil data</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></main></article><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-JSE36H2O.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/root-IB5726YR.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-NBON2RSI.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/routes/$-LXLHKVOR.js"/><script>window.__remixContext = {"url":"/startingcalibrationtest/getting-the-empirical-data","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.0","options":{"logo":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/DIVERSE_PnET_Calibra-5bdc855d1747cacb3d11076efd7a4094.png","folders":true},"nav":[],"actions":[],"projects":[{"bibliography":["/calibrationFolder/calibrationJupyterBook/references.bib"],"exports":[],"title":"Calibration of PnET Succession for the DIVERSE project","authors":[{"nameParsed":{"literal":"Clément Hardy, PhD.","given":"PhD.","family":"Clément Hardy"},"name":"Clément Hardy, PhD.","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/Klemet/Calibration_PnET_DIVERSE","toc":[{"file":"intro.md"},{"children":[{"file":"StartingCalibrationTest/0.Some_important_notions.ipynb"},{"file":"StartingCalibrationTest/1.Loading_functions.ipynb"},{"file":"StartingCalibrationTest/2.Test_sim_functions.ipynb"},{"file":"StartingCalibrationTest/3.Initial_Species_Parameters.ipynb"},{"file":"StartingCalibrationTest/4.Getting_the_empirical_data.ipynb"},{"file":"StartingCalibrationTest/5.Getting_climate_and_soil_data.ipynb"},{"file":"StartingCalibrationTest/6.Monoculture_ideal_conditions.ipynb"}],"file":"StartingCalibrationTest/Intro_CalibrationTest.ipynb"}],"index":"index","pages":[{"slug":"startingcalibrationtest.intro-calibrationtest","title":"Calibration test","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"startingcalibrationtest.some-important-notions","title":"Some important notions before we start","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/eric-prouzet-n_1SH37-ccafd8a41a4b6bf2e99e3858d4b450cb.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.loading-functions","title":"Loading functions and packages","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.test-sim-functions","title":"Making a test simulation to get used to the functions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.initial-species-parameters","title":"Initial species parameters","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.getting-the-empirical-data","title":"Getting the empirical data needed fo the calibration process","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/Algorithm_GrowthCurv-fc445ac3fd5e0813654caa5495dcaf2b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.getting-climate-and-soil-data","title":"Getting the climate and soil data","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/88c4f87a42ed43465897c61d30462b63.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.monoculture-ideal-conditions","title":"Phase 1 🌳 : Calibration of species in optimal conditions (monoculture + mesic soil + average and unchanging climate)","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/14232857c4e474f60fe4aad7bf85497d.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"https://klemet.github.io/Calibration_PnET_DIVERSE"},"routes/$":{"config":{"version":2,"myst":"1.6.0","options":{"logo":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/DIVERSE_PnET_Calibra-5bdc855d1747cacb3d11076efd7a4094.png","folders":true},"nav":[],"actions":[],"projects":[{"bibliography":["/calibrationFolder/calibrationJupyterBook/references.bib"],"exports":[],"title":"Calibration of PnET Succession for the DIVERSE project","authors":[{"nameParsed":{"literal":"Clément Hardy, PhD.","given":"PhD.","family":"Clément Hardy"},"name":"Clément Hardy, PhD.","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/Klemet/Calibration_PnET_DIVERSE","toc":[{"file":"intro.md"},{"children":[{"file":"StartingCalibrationTest/0.Some_important_notions.ipynb"},{"file":"StartingCalibrationTest/1.Loading_functions.ipynb"},{"file":"StartingCalibrationTest/2.Test_sim_functions.ipynb"},{"file":"StartingCalibrationTest/3.Initial_Species_Parameters.ipynb"},{"file":"StartingCalibrationTest/4.Getting_the_empirical_data.ipynb"},{"file":"StartingCalibrationTest/5.Getting_climate_and_soil_data.ipynb"},{"file":"StartingCalibrationTest/6.Monoculture_ideal_conditions.ipynb"}],"file":"StartingCalibrationTest/Intro_CalibrationTest.ipynb"}],"index":"index","pages":[{"slug":"startingcalibrationtest.intro-calibrationtest","title":"Calibration test","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"startingcalibrationtest.some-important-notions","title":"Some important notions before we start","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/eric-prouzet-n_1SH37-ccafd8a41a4b6bf2e99e3858d4b450cb.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.loading-functions","title":"Loading functions and packages","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.test-sim-functions","title":"Making a test simulation to get used to the functions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.initial-species-parameters","title":"Initial species parameters","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.getting-the-empirical-data","title":"Getting the empirical data needed fo the calibration process","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/Algorithm_GrowthCurv-fc445ac3fd5e0813654caa5495dcaf2b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.getting-climate-and-soil-data","title":"Getting the climate and soil data","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/88c4f87a42ed43465897c61d30462b63.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.monoculture-ideal-conditions","title":"Phase 1 🌳 : Calibration of species in optimal conditions (monoculture + mesic soil + average and unchanging climate)","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/14232857c4e474f60fe4aad7bf85497d.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":2,"kind":"Notebook","sha256":"37653c4b5c2d3e0ed0b5c54567a0db0bee82024a88424cc2d82b692b328925e3","slug":"startingcalibrationtest.getting-the-empirical-data","location":"/StartingCalibrationTest/4.Getting_the_empirical_data.ipynb","dependencies":[],"frontmatter":{"title":"Getting the empirical data needed fo the calibration process","abbreviations":{"PnETSpeciesParameters":"Parameter than then calls a list of species.","FolN":"Foliar nitrogen content (in % by weight) for the leaves of the species.","SLWmax":"Specific leaf weight at the top of the canopy.","SLWDel":"Rate of change in the weight of the leaves from the top of the canopy (SLWmax) to each sublayer under the canopy.","MaxLAI":"Maximum leaf area index (LAI) that a species can achieve in its lifetime (for an age cohort ?).","TOFol":"Fraction of foliage biomass lost per year.","TORoot":"Fraction of root biomass lost per year.","TOWood":"Fraction of wood biomass lost per year.","AmaxA":"Intercept of the relationship between foliar N and maximum net photosynthetic rate.","AmaxB":"Slope of the relationship betwee foliar N and maximum net photosynthetic rate.","HalfSat":"Half saturation light level for photosynthesis.","H1":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","H2":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","H3":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","H4":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","PsnAgeRed":"Reduction factor of photosynthesis as the age of an age cohort increases.","LeafOnMinT":"Minimum temperature for activate growing season.","PsnTMin":"Minimum average daytime temperature for photosynthesis.","PsnTOpt":"Optimal average daytime temperature for photosynthesis.","PsnTMax":"Maximum average daytime temperature for photosynthesis.","ColTol":"Cold tolerance (coldest temperature that the species can survive).","k (parameter)":"Canopy light attenuation constant (light extinction coefficient).","DNSC":"Proportion of Non Structural (ressources) carbon from the total activate biomass of the cohort that will be maintained as long as net photosynthesis exceeds maintenance respiration.","FracBelowG":"Fraction of non-foliar biomass that is allocated belowground (root pool).","EstMoist":"Scaling parameter that changes the maximum expected value of fWater when computing the probability of establishment.","EstRad":"Scaling parameter that changes the maximum expected value of fRad when computing the probability of establishment.","FracFol":"Fraction of the active woody biomass (above or belowground) of a cohort that determines the amount of foliage maintained each year.","FrActWd":"Shape parameter of the negative exponential function that calculates the amount of woody biomass that has active xylem capable of supporting foliage.","CO2HalfSatEff":"Slope coefficient used to reduce HalfSat (= increase shade tolerance) as CO2 concentration increase.","CO2AMaxBEff":"Proportional change in AmaxB at 550ppm CO2 relative to 350ppm.","O3StomataSens":"Species susceptibility of the stomata to ozone-induced sluggishness.","O3GrowthSens":"Species susceptibility to ozone-induced tissue damage.","MaxFolN":"Controls the dynamic response of foliar nitrogen (FolN) to light.","FolNShape":"Controls the dynamic response of foliar nitrogen (FolN) to light.","MaxFracFol":"Controls the dynamic response of the fraction of Foliage (FracFol) to light.","FracFolShape":"Controls the dynamic response of the fraction of Foliage (FracFol) to light.","LifeFrom":"Specifies the life form (stature) of the species to determine the limits to the species major canopy layer.","MossScalar":"Unit converter from biomass to depth in the case of a pseudo species (moss).","MaxCanopyLayer":"Caps the number of canopy layers implemented in the model.","LayerThreshRatio":"Define how age cohorts of a given species are grouped together into canopy layers. Correspond to the minimum ratio of cohort woody biomass density between two cohorts that will place them in different canopy layers.","PARunits":"Indicates the units for PAR and HalfSat values. See Climate Input File for PAR and Species Parameters File for HalfSat.","IMAX":"Defines the degree of subdivision into different canopy sublayers for each age cohort.","DVPD1":"Coefficient for converting the vapor pressure deficit (VPD) into a reduction factor for photosynthesis caused by water pressure (fDVPD).","DVPD2":"Coefficient for converting the vapor pressure deficit (VPD) into a reduction factor for photosynthesis caused by water pressure (fDVPD).","BFolResp":"Define the Base Foliar Respiration Fraction (the foliar respiration as a fraction of the maximum photosynthetic rate).","MaintResp":"Represents the loss of Non Structural Carbon (NSC) due to maintenance respiration as a fraction of the active wood biomass of the cohort.","Q10":"Coefficient of the Q10 relationship to compute the foliar respiration.","FolLignin":"Mass fraction of lignin in foliage tissue.","KWdLit":"Annual decomposition rate of woody litter (decay constant k in equations).","InitialNSC":"Amount of Non Structural Carbon assigned to newly established cohorts.","CFracBiomass":"Carbon fraction of biomass by weight in an age cohort.","PrecipEvents":"Number of precipitation events during a month.","PrecipEventsWithReplacement":"Defines the logic of assignation of the precipitation from a precipitation event to the canopy sub layers.","ETExtCoeff":"Canopy extinction coefficient to reduce soil water evaporation as LAI increases (because of shadow created by the canopy ?).","RETCropCoeff":"Coefficient that scales the reference evapotranspiration (RET).","PreventEstablishment":"Turns species establishment on new cells on or off.","Wythers":"Turns the Wythers correction on or off.","DTEMP":"Turns the PnET-II DTEMP temperature reduction factor on or off.","MaxPest":"Tuning parameter to raise or lower the establishment probability of species by a same proportion.","AmaxFrac":"Fraction of the early morning instantaneous photosynthetic rate that represents the mean daily photosynthetic rate.","InvertPest":"Activates the optional inversion of the effect of fRad on the probability establishment as a function of HalfSat.","SoilIceDepth":"Activates the optional simulation of soil ice depth and its effects on water leakage.","LeakageFrostDepth":"Soil ice depth at which frozen soil no longer impedes soil drainage.","FrostFactor":"Tuning parameter to adjust soil ice depth.","InitialCommunitiesSpinup":"Specifies how the biomass of the initial age cohorts/communities in each cells are generated.","SpinupWaterStress":"Activates waterlogging stress during spin up procedures.","Parallel":"Specifies the number of CPU threads used for parallel execution.","CohortStacking":"Specifies the canopy cohort processing method.","CanopySumScale":"Scales the degree to which cumulativve canopy proportions cannot exceed 1."},"content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Clément Hardy, PhD.","given":"PhD.","family":"Clément Hardy"},"name":"Clément Hardy, PhD.","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/Klemet/Calibration_PnET_DIVERSE","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/Klemet/Calibration_PnET_DIVERSE/blob/main/calibrationJupyterBook/StartingCalibrationTest/4.Getting_the_empirical_data.ipynb","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/Algorithm_GrowthCurv-fc445ac3fd5e0813654caa5495dcaf2b.png","exports":[{"format":"ipynb","filename":"4.Getting_the_empirical_data.ipynb","url":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/4.Getting_the_empiri-025ac36a761a84c13e8fd2c4b5705327.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here, I catalog the other data needed for the calibration process, that is not the initial parameter values we will be using (for this, see ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qUsYs8TWCu"},{"type":"link","url":"/startingcalibrationtest/initial-species-parameters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vVxVifpAXj"}],"urlSource":"./3.Initial_Species_Parameters.ipynb","dataUrl":"/startingcalibrationtest.initial-species-parameters.json","internal":true,"protocol":"file","key":"POIiaKs21j"},{"type":"text","value":") or the climate and soil data used in the simulations for the calibration (see ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ws1XC4fcTW"},{"type":"link","url":"./4.Setting_up_calibration_Landscape.ipynb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J97btQeGhv"}],"urlSource":"./4.Setting_up_calibration_Landscape.ipynb","key":"M0YyHr0MnQ"},{"type":"text","value":").","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"skk2xBoiFB"}],"key":"WeMCeGNmXI"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This other data will be used to :","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GKSenqScRq"}],"key":"V3y7ibb5U4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Target values to match during the calibration (e.g. biomass growth curves)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Ll8vlgsBC1"}],"key":"snrsLuf6uS"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Determine the value of some parameters directly (e.g. maximum longevity)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"TUTYZJvO3r"}],"key":"lmQZSsHACL"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Establish ranges of parameter values in which we should remain during the calibration","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"LxprScLT37"}],"key":"TZUnGy0udN"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Expected outcomes of simulations (e.g. competition outcomes, climate change outcomes, etc.)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"BwA9mTlyqZ"}],"key":"pm20eOs4PM"}],"key":"cBEdlH637s"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"I will write here as much suggestions a possible for future researchers that will want to calibrate for their own research or study area, but I will also indicate what I will be using in these notebooks.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"jD3vsjeKIA"}],"key":"N3xVvSTKrQ"}],"visibility":"show","key":"dSNNahAgoW"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Empirical data for biomass growth curves.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kVtpt2ay95"}],"identifier":"empirical-data-for-biomass-growth-curves","label":"Empirical data for biomass growth curves.","html_id":"empirical-data-for-biomass-growth-curves","implicit":true,"key":"JU3qGFNN0U"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This is an essential part of the calibration process, especially the first step in which we will calibrate each species in “ideal” conditions of growth (mild climate, good soil water retention, etc.). These “ideal” conditions are important to isolate the effect of other parameters and other sources of mortality, so that you can focus on the basic parameters of growth and senescence for your species (see ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TxCfkxRzfs"},{"type":"link","url":"/startingcalibrationtest/monoculture-ideal-conditions","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PZGJYpN00I"}],"urlSource":"./6.Monoculture_ideal_conditions.ipynb","dataUrl":"/startingcalibrationtest.monoculture-ideal-conditions.json","internal":true,"protocol":"file","key":"irwxIZQFGe"},{"type":"text","value":").","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"W2JRTZzuAF"}],"key":"Xbipa8GZoG"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Basically, what you want is data that allows you to infer a biomass growth curve for each given species, showing the evolution of the biomass of a cohort for the species in conditions that are as ideal as possible.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JeM8ybEppe"}],"key":"PlgTbkMmAC"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"As of today, I’ve ran accross three different strategies to get this data. I’ll describe them in the following sections.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"qmH70Z6cRo"}],"key":"f5UrhZ9QBg"},{"type":"heading","depth":4,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Option 1 : Sample plot data.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"lDkXeem84e"}],"identifier":"option-1-sample-plot-data","label":"Option 1 : Sample plot data.","html_id":"option-1-sample-plot-data","implicit":true,"key":"XqZExb2GxB"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"By looking at individual tree data from sample plot data, you can infer tree biomass and tree age, making each tree or plot a point on your graph.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"N6iVsj1nU3"}],"key":"wj8MC6fzT3"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"By looking at the points that are at the top of the cloud of points that will result, you can get and idea of the maximum biomass a tree can reach for a given age, which should give you good information about the growth curve. This is a method used by many research so far.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"aClZZs5Z2b"}],"key":"USF8OFUH4R"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The problem is that sample plot data is often messy, full of outliers, biases, needing sharing agrements, etc. As such, it will require important work to clean, and several important assumptions will influence your results enormously. For example, the “tree age” data is often missing, and you’ll have to infer it from DBH; and you’ll also have to choose how to translate your individual tree biomass into biomass/surface (as all LANDIS-II biomass output is interpreted in biomass/surface, not biomass/tree).","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Bh3k7LYQZV"}],"key":"uB0zi8TFuF"},{"type":"heading","depth":4,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Option 2 : Tree growth models.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"hEuOz58Jig"}],"identifier":"option-2-tree-growth-models","label":"Option 2 : Tree growth models.","html_id":"option-2-tree-growth-models","implicit":true,"key":"GsMTxtDhy1"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"These models are complex equations develloped by foresters, industries or governmental agencies to try and predict growth or yield for different species in different conditions. These are often calibrated based on sample plot data; as such, the work of cleaning/dealing with sample plot data is often done for you. An example is the famous ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"QUHFPFsr2n"},{"type":"link","url":"www.fs.usda.gov/fvs/","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Forest Vegetation Simulator","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"znbB6ZjkSg"}],"urlSource":"www.fs.usda.gov/fvs/","key":"f6zKZQHIcx"},{"type":"text","value":" from the USDA. Other such models are simply growth curves published in the litterature, sometimes in books.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"KPAkRtTzsi"}],"key":"mOKqdHOtAT"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"The curves produced by these models are often in biomass/surface, which makes things easier to compare with LANDIS-II outputs. You can also tweak the parameters of these models so that they predict biomass growth in conditions as ideal as possible, making it close to what you’re looking for.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"gp2Sl0L2xE"}],"key":"tetlVQrOz3"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"The main issue is that these models can still produce pretty unrealistic curves; might not be available for your study area/region; and might still need parameters derived from sample plot data (e.g. Site index and maximum basal area for FVS). So while they can make your life simpler, they can still be difficult to use.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"q4S01a9UZs"}],"key":"Y8nRNFhhTp"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"FVS can be compiled into a Dockerfile and use in Python; I’ve tried it at first and will keep the functions that I’ve written in a separate document for you to re-use if necessary.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"PUTabvAnbK"}],"key":"DaTaQymAqD"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Be warned that the decreasing part of the curves produced by these often often don’t include mortality by senescence, which can make the cruve growth forever, making it difficult to identify the biomass peak which is very important for calibration purposes.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"bqpRbSnyjO"}],"key":"CadSDYc9Pn"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Tree growth models have been used by several research teams, including Brian Sturtevant’s and Eric Gustafson (the latter being the author of the calibration tips for PnET-Succession that are the basis of these documents).","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"jniaqdtjo2"}],"key":"B2YS6qq8LC"},{"type":"heading","depth":4,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Option 3 : Forest inventory data.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"BpgdqlgRYk"}],"identifier":"option-3-forest-inventory-data","label":"Option 3 : Forest inventory data.","html_id":"option-3-forest-inventory-data","implicit":true,"key":"H9phk4HjUC"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"Some forest inventories contain data that allow you to infer tree or stand age and the biomass of your species of interest. For example, the ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"fqaYmmTEIc"},{"type":"link","url":"https://nfi.nfis.org/en/","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"National Forest Inventory of Canada","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"Hid5ALCUZN"}],"urlSource":"https://nfi.nfis.org/en/","key":"umJaYEb8KO"},{"type":"text","value":" proposes raster maps of several forest attributes Canada-wide, including pixel/stand forest age, and the biomass of each individual species that are considered in the forest inventory.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"NcSmmczmUt"}],"key":"d2uaFPdx4j"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"If you use each pixel from the maps of a single year as a point and plot a cloud of points on a biomass/time axis, you might get a good estimation of a growth curve, with a growth peak and a initial growth (the two most important parts in our case). This is, in essence, a ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"nMeECmZhV1"},{"type":"cite","url":"https://link.springer.com/chapter/10.1007/978-1-4615-7358-6_5","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"“space-for-time” substitution","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"YQW5xgAnxJ"}],"kind":"narrative","label":"Pickett_1989","identifier":"https://link.springer.com/chapter/10.1007/978-1-4615-7358-6_5","enumerator":"1","key":"jy2TaiRNjw"},{"type":"text","value":", where you look at many different points in space that will be forests at different stages of growth, rather than looking at the long-term history of a few forests.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"Kyyq6xWFOT"}],"key":"Stt3q9CEsU"},{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"The big limitation of this data is that you often get one “stand age” or “pixel age” value per pixel, rather than a separate age value for the trees of a given species in the pixel. As such, in a pixel of 80 years, you cannot know if the biomass of species X comes from trees that are 80 years old, or if these trees are younger. But you can interpret the upper points of the cloud of points as “the maximum biomass that a species can reach for this stand age”, which is pretty close to the mark of what you’re looking for.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"qSHTK2DOnR"}],"key":"nXLwIw001r"},{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Another big limitation is that in most pixels (if not all), your species will be mixed with other species. This is especially true if you are calibrating a “companion” species (the type of tree species that is never abundant, but yet found in many forests). You can restrict the points of your data to only the pixels where more than 50% of the biomass comes from your species of interest; but you might not get enough points for some rarer species. In these case, you will probably need to develop a correction of biomass to try and have an estimate of the biomass that your species can reach when it composes 100% of the stand. You might do this by making a statistical model that attempts to predict the biomass of your species in a stand or pixel based on the age of the pixel, and the % of composition of the species. You might want to train your statistic model on only the top percentile of points (as you’re looking out for the most biomass your species can achieve for a given age).","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"RhcgQGgRUF"}],"key":"vndzO5W4XL"},{"type":"paragraph","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"This data is often generated through a combination of forest inventory sampling (aerial photography, etc.) and sample plot data (which are assignated to stand or pixels via assignation algorithms like the kNN method). As such, it often contains information from sample plots, but which has already been cleaned and dealt with.","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"tFhRH03cvn"}],"key":"pAX0vFIgH5"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"The biomass data is often expressed in biomass/surface, making it easy to compare to LANDIS-II outputs.","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"vWpmREMw5a"}],"key":"j3Eib7Hp08"},{"type":"paragraph","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"This is the data I will be using here. From what I heard, other teams have been using such data in the past.","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"BfsanOas99"}],"key":"m6lvyGtNo0"}],"key":"OX5QifFSkx"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"What is the spatial extent for which I should take growth data for the calibration ? And what climate data should I use depending on the origin of my growth data ?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XRxvyATNRw"}],"key":"ehcB2bj1Dh"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Short answer :","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XlzaWwNMXk"}],"key":"AQqNOpBytd"},{"type":"text","value":" I wager it’s a very complicated question, with no clear answer. You might focus only on your study area/simulated area, but there are trade-offs no matter what you choose. The important things seem to be that you need to make sure 1) you get enough empirical growth data to estimate the maximum growth initial curve and peak your species can achieve in your study area (if there is not enough data in your study area, you will need to look at a larger scale than just your study area); and 2) that the temperatures and precipitations you use during the calibration come from the area where you gathered your empirical growth data, but that they are averaged to make them mild and constant; added to a good soil type (SILO) to ensure a relatively ideal water retention; and that the temperature is a close to the optimal for your species as possible (which you can ensure by changing the ","key":"xcPB4xX8wX"},{"type":"abbreviation","title":"Optimal average daytime temperature for photosynthesis.","children":[{"type":"text","value":"PsnTOpt","key":"f3bPKNKcGh"}],"key":"rOZ0yYqvxV"},{"type":"text","value":" parameter temporarely).","key":"yLgMy8pS1G"}],"key":"fOEJsFkIdu"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Extended answer :","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SeT9pwxaHe"}],"key":"A6SIMv02T2"}],"key":"hp0FKIlmXt"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The empirical growth data you’re looking for is going to be used in the first calibration step, corresponding to growth in “ideal” conditions. This step is very important, because that’s where we are going to calibrate some of the most sensitive parameters of PnET-Succession. It’s also the step where we’re going to effectively give the “upper bound” of the performance of the tree species calibrated. It’s crucial to get this upper bound right, because the algorithm and equations of PnET-Succession are mostly based on photosynthesis reduction factors (linked to light, water, age, temperature, CO2, etc.) that are going to reduce the growth of the tree species bellow this upper bound. If this upper bound is too high, you’ll overestimate the growth of the species most of the time (if not all of the time); but you can also underestimate it by setting it too low.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FK6uXbI1hd"}],"key":"vKtbUjAyfq"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The empirical growth area you’re getting here is used to have an estimate of this upper bound. It’s possible that you have enough empirical data from measurements taken inside your study area to have some good estimates; but maybe you won’t have enough data points, or no growth models available for the conditions of your study area. In that case, you’ll have to look to a larger area to get data.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"lTT6Ak7RNc"}],"key":"d2h6wTk3Sc"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"But the larger the area where you take empirical data gets, the more you get into another problem : as you are looking at more trees of your species in a larger area, you’re also looking at a higher diversity of phenotypes or traits or variants in your trees. As such, the upper bound of growth that you will be getting from this data might be from a phenotype not present in your area; or maybe you’ll be combining measures from different trees, and so maybe different phenotypes. As such, this upper bound that you’ll be estimating might still be for your tree species; but it might become an upper bound for trees that might be quite different from the ones in your area (even thought they are from the same species). It might also become an upper bound for a “soup” of different phenotypes, making it less realistic, and introducing uncertainty or potential bias. As such, the bigger is not necesserally the better : it might be best to restrict your choice of data to your study area or to a province or state or region to avoid these issues.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"U9MZst5WkQ"}],"key":"iRm0Wo8SXZ"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"With the choice of the area from which you will take your empirical growth data also comes a second question : what climate data should you use during the calibration simulation ? Again, the goal of the first calibration step (where you will use your empirical growth data) is to make sure that your species reach the right upper bound given ideal conditions. But how do we define ideal conditions in that case ? Theoritically, these should be the climate conditions that led that this upper bound you have seen in your empirical data. Problem is, you will most likely not know what was the exact climate data associate with this growth : maybe it’s because your data is a composite of points from many different places (e.g. sample plot data or forest inventory data); or maybe it’s because your data comes from a growth model that do not provide the climate data associated to a growth curve. So, what climate data should you give ?","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"umWBkMBSPD"}],"key":"YOiUjfTesE"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The option used by ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ef6p5B1eT0"},{"type":"link","url":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/Gustafson2024PnETUse-e030ce36ecd3383f68f3a22a7353dd42.pdf","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Gustafson and Miranda (2023)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"xVPMUPgGoz"}],"urlSource":"./ReferencesAndData/Documentation/Gustafson2024PnETUserGuide.pdf","static":true,"protocol":"file","key":"TB0jJONhUB"},{"type":"text","value":" is to use an averaged historical climate data stream (same climate every year, but changes every months based on average from historical monthly data) from your study area. To ensure a relatively ideal amount of water for the species to use during the calibration, Gustafson recommands using averaged “typical” precipitations and a soil of type SILO - which will ensure that your species have a right quantity of water, not too much, and not too little. As for temperature, Gustafson recommands cheating a bit by changing the ","key":"pK1qqrj1vx"},{"type":"abbreviation","title":"Optimal average daytime temperature for photosynthesis.","children":[{"type":"text","value":"PsnTOpt","key":"Qcb678iAmV"}],"key":"hEIx1oje6K"},{"type":"text","value":" parameter of your tree species temporarely so that it matches the average of the growing season temperatures in your climate data (which would already be a constant climate every year because it would be an average climate). That, or making sure that the average growing season temperatures matches the ","key":"ePQcTQLD5Y"},{"type":"abbreviation","title":"Optimal average daytime temperature for photosynthesis.","children":[{"type":"text","value":"PsnTOpt","key":"u95WpYbCul"}],"key":"vfegDu4ZJr"},{"type":"text","value":" of your species to begin with. This ensures that the photosynthesis of your species will be maximum. However, Gustafson points out that since you’re making the climate very mild and very “ideal” for your species, this will most likely not match the less ideal and less mild climate that generated the empirical growth data you’re using to estimate this upper bound. That is why Gustafson recommands that you should try reach a growth that is a bit above the upper bound estimated from your data in this first step, if you use his methodology.","key":"rfMTrgKt4b"}],"key":"ZhQd8CFO6G"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"I think this approach makes a lot of sense : it solves the issue of not knowing the exact climate that is associated with the upper bound of growth derived from your empirical data by tweaking the climate data coming from your study area (or the area from which your empirical growth data comes from) so that it becomes “ideal”; but to compensate this, you’ll simply have to target a bit higher than the upper bound. How much higher ? There are no perfect answers here again, just approximation. 5-10% higher could be a good estimate with a rule-of-thumb approach.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"usFTGFfvfU"}],"key":"FC3goXW8en"}],"key":"ZisrjRl1XZ"}],"key":"kQ4igfAG0q"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"What data should I use to calibrate variants, like southern variants that are more adapted to heat ? And what variant I am calibrating for if I use this methodology ?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P1TmK5SFPD"}],"key":"iT3WlTDBO7"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"That’s another big question. The more local the data you use (wherever in the initial parameter values you will use, parameter range, empirical growth data, etc.), the more you will be calibrating for the local phenotypes of the area you are focusing on. Invertly, the broader the data you use spatialy (and you will most likely need to use data from many different places), the more the species you are calibrating will be a kind of “soup” of “average” of many phenotypes and variants. It won’t be the most realistic option; but that’s often the best you can do given the low density of data we have for many tree species (e.g. there is not enough data locally to get values for all parameters or good empricial growth estimates as described in the tip section above).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MHjqN7bkJ1"}],"key":"OZqGfbL81c"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Once you have calibrated your species, if you want to represent “northern” and “southern” variants that are adapted to different conditions of heat (or even different conditions of drought), you might want to change some parameters related to these aspects. In particular, by changing the parameters ","key":"nOfPWKyJbk"},{"type":"abbreviation","title":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","children":[{"type":"text","value":"H1","key":"PMd5YSz0Lr"}],"key":"TroIfTkxXZ"},{"type":"text","value":", ","key":"o8KJxOzB8i"},{"type":"abbreviation","title":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","children":[{"type":"text","value":"H2","key":"JZYTWwZFGv"}],"key":"vIbXc6XlWl"},{"type":"text","value":", ","key":"jOcPSu3i9K"},{"type":"abbreviation","title":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","children":[{"type":"text","value":"H3","key":"qTPGhmFKEC"}],"key":"WVaxBki5Dr"},{"type":"text","value":" and ","key":"og5zHWivhu"},{"type":"abbreviation","title":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","children":[{"type":"text","value":"H4","key":"fcBlhWoE4H"}],"key":"zLtnbCLL9X"},{"type":"text","value":", you will change the response of the species to different conditions of water in the soil. A variant adapted to dryier conditions will certainly have increased values of ","key":"WamznoeYEq"},{"type":"abbreviation","title":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","children":[{"type":"text","value":"H1","key":"UfsNHQDrDI"}],"key":"TrghRmOaEe"},{"type":"text","value":", ","key":"y6QCb8akbX"},{"type":"abbreviation","title":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","children":[{"type":"text","value":"H2","key":"OhXo6ReyJj"}],"key":"EYZ1gVW6nc"},{"type":"text","value":", ","key":"usvmPI5nro"},{"type":"abbreviation","title":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","children":[{"type":"text","value":"H3","key":"bU8i2QA6SY"}],"key":"yjYWYbH4Ox"},{"type":"text","value":" and ","key":"S2qpu8cAEH"},{"type":"abbreviation","title":"Water stress parameter according to Feddes et al. (1978) (Fig. 59).","children":[{"type":"text","value":"H4","key":"QBtK9hbbzQ"}],"key":"uge9moDiNo"},{"type":"text","value":" overall (can pump more water from the soil where pressure is low; but is also more sensitive to waterlogging). For temperature, you will most likely need to change ","key":"z0oZDIipmv"},{"type":"abbreviation","title":"Minimum average daytime temperature for photosynthesis.","children":[{"type":"text","value":"PsnTMin","key":"i2aR9fsECp"}],"key":"R5FLAV7WZT"},{"type":"text","value":", ","key":"aBDUn5hizL"},{"type":"abbreviation","title":"Optimal average daytime temperature for photosynthesis.","children":[{"type":"text","value":"PsnTOpt","key":"AGUMqZxRT7"}],"key":"ATA7YwZeMY"},{"type":"text","value":", and ","key":"jopYVJs44s"},{"type":"abbreviation","title":"Maximum average daytime temperature for photosynthesis.","children":[{"type":"text","value":"PsnTMax","key":"I5wDWa15rg"}],"key":"Ng0AhmIyu6"},{"type":"text","value":". Gustafson notes in ","key":"aJMW3u86h8"},{"type":"link","url":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/Gustafson2024PnETUse-e030ce36ecd3383f68f3a22a7353dd42.pdf","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Gustafson and Miranda (2023)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xAFjlrd1F6"}],"urlSource":"./ReferencesAndData/Documentation/Gustafson2024PnETUserGuide.pdf","static":true,"protocol":"file","key":"aDZgKolxwG"},{"type":"text","value":" : ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xAdIMjRraF"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"I use ","key":"Cbzdz7KsVH"},{"type":"abbreviation","title":"Maximum average daytime temperature for photosynthesis.","children":[{"type":"text","value":"PsnTMax","key":"faGsbSAK30"}],"key":"tXxFppdgCi"},{"type":"text","value":" to make more northerly species less competitive than southerly species as climate warms.","key":"hWpIOV2fih"}],"key":"yd7rQzeblZ"},{"type":"text","value":" You can also slightly change ","key":"TX5mTcJLpZ"},{"type":"abbreviation","title":"Optimal average daytime temperature for photosynthesis.","children":[{"type":"text","value":"PsnTOpt","key":"IGMFmjEBbW"}],"key":"HfwVuEOb9k"},{"type":"text","value":", which indicates the optimum temperature for the species. How much you increase or decrease these values is up to your interpretation; you can compare to other species, but you can also look at the average temperatures for the growing season at the latitude corresponding to the center of the range distribution of your variant.","key":"F00c3d7J52"}],"key":"wNzmlyKdvN"}],"key":"QjIXMYMgEI"}],"key":"RNGknO43Mg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Option used here : data from the National Forest Inventory of Canada","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nZyZdghQSJ"}],"identifier":"option-used-here-data-from-the-national-forest-inventory-of-canada","label":"Option used here : data from the National Forest Inventory of Canada","html_id":"option-used-here-data-from-the-national-forest-inventory-of-canada","implicit":true,"key":"YllUaGOGbP"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"See :","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RGZBLzyrgC"}],"key":"EbnuSKhUY8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"link","url":"https://nfi.nfis.org/en/","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[],"urlSource":"https://nfi.nfis.org/en/","key":"YkaucbZFXQ"},{"type":"text","value":" for general information and visualisation of some of the maps","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"BOoH8d39OG"}],"key":"PFpbXC7uJi"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://open.canada.ca/data/en/dataset/ec9e2659-1c29-4ddb-87a2-6aced147a990","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[],"urlSource":"https://open.canada.ca/data/en/dataset/ec9e2659-1c29-4ddb-87a2-6aced147a990","key":"IsarTa3avK"},{"type":"text","value":" to download the maps","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"EJU5hIWdjf"}],"key":"dieTQyN0hU"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"cite","url":"https://cdnsciencepub.com/doi/10.1139/cjfr-2017-0184","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Beaudoin ","key":"Fn2xAPrw61"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"cU09hDGJz8"}],"key":"mhIFuzKfUW"},{"type":"text","value":" (2018)","key":"jU6D6ZBvs6"}],"kind":"narrative","label":"Beaudoin_2018","identifier":"https://cdnsciencepub.com/doi/10.1139/cjfr-2017-0184","enumerator":"2","key":"NmdVKmRbzD"},{"type":"text","value":" for details about how the maps were generated.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"JSf0plu0Pq"}],"key":"I2hbOdG956"}],"key":"aqbT34QEI6"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Here, I’m using data from the most recent year (2011). I’m using the map ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"lt9aKBuadZ"},{"type":"inlineCode","value":"/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"fEaJmEuaaa"},{"type":"text","value":" for the stand (pixel) ages; ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"PuY7aGL4xY"},{"type":"inlineCode","value":"/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"NDKSwk8oNE"},{"type":"text","value":" for biomass of stands; and a series of rasters like ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"UUxfeq96zG"},{"type":"inlineCode","value":"/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Abie_Bal_v1.tif","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"nvVXsqwwO9"},{"type":"text","value":" that indicate the propotion of ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"k4v7SjIa2X"},{"type":"inlineCode","value":"/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"rjLlOb4HM5"},{"type":"text","value":" that corresponds to the species of interest (e.g. ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"jHWnV0Bg46"},{"type":"emphasis","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Vj9wLmD9Uy"}],"key":"oLEKisG1Jy"},{"type":"text","value":" in that case). All maps are currently in ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"RoDf1WvNFw"},{"type":"inlineCode","value":"./ReferencesAndData","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"lWlOQf3ayG"},{"type":"text","value":".","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"yU8o9kCK8n"}],"key":"vowotMZBQ5"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"I’m also using several “mask” rasters to restrict or differenciate the pixel data from different provinces in Canada (e.g. ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"F9Dq8ShkfP"},{"type":"inlineCode","value":"quebecMask.tif","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"FRm57jucKX"},{"type":"text","value":", etc., all in ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ZkVDJWcHWj"},{"type":"inlineCode","value":"./ReferencesAndData","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"o40tOKPe6M"},{"type":"text","value":").","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"IoJH3qt7Qo"}],"key":"cUMHQpd2PH"}],"key":"yVUOjfpNRp"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here, before we use this dataset, I quickly show how it looks like by focusing on the highest points of the point clouds that it produces. Focusing on these highest points will give us an idea of the “best growth” that the species can achieve through by looking at different pixels from the same year throughout all of Canada.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mRXKrI2tVF"}],"key":"FPYctgw0KE"}],"key":"dPIVOpUlkh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# We read data from the NFI for our free species, and plot the distribution of the points above 95% of the maximum value in\n# each 3 years window (which allows us to keep the top points)\nfrom functionsForCalibration import *\nimport matplotlib.pyplot as plt\n\n\n# We define the path to where the rasters are\nspecies_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Abie_Bal_v1.tif\"\nage_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif\"\nbiomass_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif\"\n# We define the paths to the mask rasters for each province\ndictOfMasks = {\"NS\":\"./ReferencesAndData/SpatialBoundaries/novaScotiaMask.tif\",\n              \"QC\":\"./ReferencesAndData/SpatialBoundaries/quebecMask.tif\",\n              \"ON\":\"./ReferencesAndData/SpatialBoundaries/ontarioMask.tif\",\n              \"MT\":\"./ReferencesAndData/SpatialBoundaries/manitobaMask.tif\",\n              \"SK\":\"./ReferencesAndData/SpatialBoundaries/saskatchewanMask.tif\",\n              \"AB\":\"./ReferencesAndData/SpatialBoundaries/albertaMask.tif\",\n              \"BC\":\"./ReferencesAndData/SpatialBoundaries/britishColumbiaMask.tif\",}\n\n\nplottingNFISpeciesUpperBiomassByProvince(species_path,\n                                         age_path,\n                                         biomass_path,\n                                         \"Abies balsamea\",\n                                         dictOfMasks)","key":"VqRj16Y9D5"},{"type":"output","id":"Q-yljt_en3PV6RiNlCF0r","data":[{"name":"stdout","output_type":"stream","text":"Reading species raster...\nReading age raster...\nReading biomass raster...\nDealing with NS\n"},{"name":"stderr","output_type":"stream","text":"/usr/local/lib/python3.10/dist-packages/numpy/ma/core.py:1020: RuntimeWarning: overflow encountered in multiply\n  result = self.f(da, db, *args, **kwargs)\n"},{"name":"stdout","output_type":"stream","text":"Dealing with QC\nDealing with ON\nDealing with MT\nDealing with SK\nDealing with AB\nDealing with BC\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"99c0650e6247135da6ad41df1b934932","path":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/99c0650e6247135da6ad41df1b934932.png"},"text/plain":{"content":"\u003cFigure size 1000x800 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"XtFUyzwdRp"}],"key":"bm2Xq3vYgJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As such, we can see that :","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QFuZAGsJEP"}],"key":"jcuGgnOuOf"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The NFI data shows some pretty clear growth patterns (initial growth, peak, senescence)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JbZBMA9lxj"}],"key":"skzz0gh7BT"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We see that the different provinces can have very different growth peaks and initial growth/senescence. Upon closer inspection (plotting again but only for points with at least 50% of biomass composed of ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ePekPAyEjq"},{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"w2Hi28DTX7"}],"key":"wqLN8kvZyl"},{"type":"text","value":"), it seems to mostly be due to the differences in the mixture/competition of the species in difference province. SK, AB, MT and BC don’t have many points where ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"YD2h6QAPjJ"},{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"TcsnQgCOV6"}],"key":"ZQedaK9pzG"},{"type":"text","value":" is dominant. Meanwhile, NS, QC and ON have a lot of it.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"v2h9lcdShj"}],"key":"BNRIlbAlij"}],"key":"tgbp8KpkJW"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Now, here are the same figures for the other species :","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ZHH9EDc3KG"}],"key":"D9I970as7F"}],"key":"QAbZSfVRge"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# We define the path to where the rasters are\nspecies_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Pice_Mar_v1.tif\"\nage_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif\"\nbiomass_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif\"\n\nplottingNFISpeciesUpperBiomassByProvince(species_path,\n                                         age_path,\n                                         biomass_path,\n                                         \"Acer rubrum\",\n                                         dictOfMasks)","key":"wxuTYvS4Aw"},{"type":"output","id":"JGWWlrrHPDgPZBuJUmjJC","data":[{"name":"stdout","output_type":"stream","text":"Reading species raster...\nReading age raster...\nReading biomass raster...\nDealing with NS\nDealing with QC\nDealing with ON\nDealing with MT\nDealing with SK\nDealing with AB\nDealing with BC\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6e3bd5072c7a270d1a580b23f221aff8","path":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/6e3bd5072c7a270d1a580b23f221aff8.png"},"text/plain":{"content":"\u003cFigure size 1000x800 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"fA9pyZdvzF"}],"key":"h2h4gdgYNZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# We define the path to where the rasters are\nspecies_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Acer_Rub_v1.tif\"\nage_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif\"\nbiomass_path = \"./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif\"\n\nplottingNFISpeciesUpperBiomassByProvince(species_path,\n                                         age_path,\n                                         biomass_path,\n                                         \"Picea mariana\",\n                                         dictOfMasks)","key":"WbYtoCQPSX"},{"type":"output","id":"TwxBs6qftbhb404ec1xAn","data":[{"name":"stdout","output_type":"stream","text":"Reading species raster...\nReading age raster...\nReading biomass raster...\nDealing with NS\nDealing with QC\nDealing with ON\nDealing with MT\nDealing with SK\nDealing with AB\nDealing with BC\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"dd07370cc1ad32d4816e922c5ccee6f2","path":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/dd07370cc1ad32d4816e922c5ccee6f2.png"},"text/plain":{"content":"\u003cFigure size 1000x800 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"oZXblAp5Kz"}],"key":"qHGCMB8KH4"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can again see some pretty clear patterns for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FjC9K2yjfd"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KPZMzeBCd9"}],"key":"GwzONtxJOg"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZOCqzqS6Qu"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Picea mariana","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"k4nQKzsznZ"}],"key":"cgz4aqAXCW"},{"type":"text","value":". As such, this dataset should do.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mY7p4Ep4Dg"}],"key":"icGo9hEFZc"}],"key":"qRYc1GZ203"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves in ideal conditions (in Canada) for our species with NFI data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BrsYLxHTNP"}],"identifier":"producing-estimated-growth-curves-in-ideal-conditions-in-canada-for-our-species-with-nfi-data","label":"Producing estimated growth curves in ideal conditions (in Canada) for our species with NFI data","html_id":"producing-estimated-growth-curves-in-ideal-conditions-in-canada-for-our-species-with-nfi-data","implicit":true,"key":"Rgl1Gy3n4n"}],"key":"mBIU90NFP8"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Based on the NFI data shown and explored in the previous section, we now have to produce estimated growth curves based on this data that we will be able to use as a “target” for the first step of the calibration of PnET-Succession, where we will try to match the curves produced by PnET-Succession with the data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MjSTzpbf4X"}],"key":"MxGWxp7em7"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We could of course simply plot the curves produced by PnET-Succession onto the data points directly, and estimate visually if the fit is good. But I prefer to produce curves that we can use to automatize the calibration process (with a curve, we can compute the difference between the PnET-Succession curve and the one we have from the data).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"f5thDFPmnR"}],"key":"FJEWZl81O0"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"I’ve ended up making two sets of curves with two different methods :","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"k853hCsszv"}],"key":"UFPyw07mQ8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The first one is a simple algorithm that builds a curve based on a set of rules to go from data point to data point, and then smooth the curve.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jvs6veOtqJ"}],"key":"rE2o4Tola6"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"The second one uses a Generalized Additive Model (GAM) fitted on pre-processed data. The GAM is then used to generate curves of biomass for different levels of abundance.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"O02TS7Q8Lu"}],"key":"DeDk9HpbvM"}],"key":"nWqrp8DQa5"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"In the next sections, I’ll briefly describe both methods and show the curves produced by each before comparing the curves from both methods.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"sojCilEPDS"}],"key":"RTDehFeor8"}],"key":"BCyw1NMMWs"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing growth curves from NFI data with a simple curve-construction algorithm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Exzrm6V66D"}],"identifier":"producing-growth-curves-from-nfi-data-with-a-simple-curve-construction-algorithm","label":"Producing growth curves from NFI data with a simple curve-construction algorithm","html_id":"producing-growth-curves-from-nfi-data-with-a-simple-curve-construction-algorithm","implicit":true,"key":"G39FsQnei0"}],"visibility":"show","key":"kMk1ottksU"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"I’ve used a relatively simple algorithim to estimate these curves based on the data :","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uk6I0MvpBx"}],"key":"a4UGX4FRsH"},{"type":"image","url":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/Algorithm_GrowthCurv-fc445ac3fd5e0813654caa5495dcaf2b.png","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yReFT2XSK2","urlSource":"./Images/Algorithm_GrowthCurves_NFI.png"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We will save these curves in ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"eZaz2M4Mhq"},{"type":"inlineCode","value":".csv","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mcMsxgx0dT"},{"type":"text","value":" files so that we can use them later during the calibration.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FExCYpEkQp"}],"key":"ATVdAdsFBK"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"To learn more, take a look at the function ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"sQxox5edGj"},{"type":"inlineCode","value":"analyze_species_growth_curves","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Mv4hriS3Tl"},{"type":"text","value":" in ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Ipja4wPLoN"},{"type":"link","url":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/functionsForCalibrat-b40081e509ffb38bec265f38bc99c65a.py","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"functionsForCalibration​.py","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"t43eYtasLT"}],"urlSource":"./functionsForCalibration.py","static":true,"protocol":"file","key":"y5weDoInDw"},{"type":"text","value":".","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xbJiiXuuGf"}],"key":"HtNlLf0cLE"}],"visibility":"show","key":"gGF40HmPD6"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"heading","depth":6,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p2eWZoW91c"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uA4JwmqhCF"}],"key":"ydJZkJmOm0"},{"type":"text","value":" with the curve-construction algorithm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gqLnGLWsFd"}],"identifier":"producing-estimated-growth-curves-for-abies-balsamea-with-the-curve-construction-algorithm","label":"Producing estimated growth curves for Abies balsamea with the curve-construction algorithm","html_id":"producing-estimated-growth-curves-for-abies-balsamea-with-the-curve-construction-algorithm","implicit":true,"key":"oRQCIPKLmp"}],"visibility":"show","key":"uX7GvXFrYc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from functionsForCalibration import *\n\nresults = analyze_species_growth_curves(\n    prevalence_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Abie_Bal_v1.tif',\n    age_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif',\n    biomass_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif',\n    species_name='Abies balsamea',\n    output_csv_path='./ReferencesAndData/Growth Curves Predictions/abies_balsamea_estimated_growth_curves_NFI.csv',\n    prevalence_thresholds=[100, 80, 60, 40, 20],\n    peak_age_min=0,\n    peak_age_max=100,\n    senescence_age_window=5,\n    outlier_age_window=5,\n    outlier_percentile=100, # Don't remove any outlier for now\n    smoothing_window=200,\n    smoothing_polyorder=5,\n    n_sample_plot=2000000,\n    create_plot=True,\n    plot_figsize=(20, 8)\n)","key":"pFOR6IDcJZ"},{"type":"output","id":"GU77IjGYILJTY2S3b8Odw","data":[{"name":"stdout","output_type":"stream","text":"=== Abies balsamea Growth Curve Analysis with Prevalence Thresholds ===\nParameters:\n  Peak search range: 0-100 years\n  Senescence age window: 5 years\n  Outlier removal: 5-year windows, 100% threshold\n  Smoothing window: 200 points\n  Prevalence thresholds: [100, 80, 60, 40, 20]\nReading raster files...\n✓ Rasters loaded successfully\nProcessing data and applying masks...\n✓ 32674827 valid pixels found\nRemoving outliers (age window: 5 years, percentile: 100%)...\nProcessing 70 age windows...\n"},{"name":"stderr","output_type":"stream","text":"Processing age windows: 100%|██████████████████████████████████████████████████████████| 70/70 [00:03\u003c00:00, 22.67it/s]\n"},{"name":"stdout","output_type":"stream","text":"✓ 32674827 pixels remaining after outlier removal\n\nProcessing curves for each prevalence threshold...\n\n--- Processing threshold 100% ---\n  Threshold 100%: 32674827 points remaining (100.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 100%: 116 raw points, 286 smoothed points\n\n--- Processing threshold 80% ---\n  Threshold 80%: 32638147 points remaining (99.9% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 80%: 119 raw points, 286 smoothed points\n\n--- Processing threshold 60% ---\n  Threshold 60%: 32479798 points remaining (99.4% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 60%: 120 raw points, 286 smoothed points\n\n--- Processing threshold 40% ---\n  Threshold 40%: 31891113 points remaining (97.6% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 40%: 129 raw points, 286 smoothed points\n\n--- Processing threshold 20% ---\n  Threshold 20%: 27611936 points remaining (84.5% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 20%: 121 raw points, 286 smoothed points\n\nCreating CSV output...\n✓ CSV saved to: ./ReferencesAndData/Growth Curves Predictions/abies_balsamea_estimated_growth_curves_NFI.csv\nSampling 2000000 points with prevalence-based weighting...\n✓ Sampled 2000000 points (avg prevalence: 21.8%)\n\nCreating visualization...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cc4cf000457ada919ca0dfabc8fadfd0","path":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/cc4cf000457ada919ca0dfabc8fadfd0.png"},"text/plain":{"content":"\u003cFigure size 2000x800 with 4 Axes\u003e","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"\n=== Analysis Complete ===\nTotal processing time: 108.3 seconds\nProcessed 32674827 pixels total\nCSV saved to: ./ReferencesAndData/Growth Curves Predictions/abies_balsamea_estimated_growth_curves_NFI.csv\n\nCurve Summary:\n  Threshold ≤20%: Peak 31.11 tons/ha at age 74.0 (27611936 points)\n  Threshold ≤40%: Peak 55.17 tons/ha at age 72.0 (31891113 points)\n  Threshold ≤60%: Peak 73.65 tons/ha at age 71.0 (32479798 points)\n  Threshold ≤80%: Peak 88.76 tons/ha at age 72.0 (32638147 points)\n  Threshold ≤100%: Peak 93.02 tons/ha at age 67.0 (32674827 points)\n"}],"key":"iIswg5sjDv"}],"key":"WsvrP0NXwk"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":6,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rzLjhIApwd"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iwgQqJCylF"}],"key":"tG3AIromb5"},{"type":"text","value":" with the curve-construction algorithm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a7YfIxMh6q"}],"identifier":"producing-estimated-growth-curves-for-acer-rubrum-with-the-curve-construction-algorithm","label":"Producing estimated growth curves for Acer rubrum with the curve-construction algorithm","html_id":"producing-estimated-growth-curves-for-acer-rubrum-with-the-curve-construction-algorithm","implicit":true,"key":"TZ9IMxeFgk"}],"key":"pDc69Muh2i"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from functionsForCalibration import *\n\nresults = analyze_species_growth_curves(\n    prevalence_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Acer_Rub_v1.tif',\n    age_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif',\n    biomass_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif',\n    species_name='Acer rubrum',\n    output_csv_path='./ReferencesAndData/Growth Curves Predictions/acer_rubrum_estimated_growth_curves_NFI.csv',\n    prevalence_thresholds=[100, 80, 60, 40, 20],\n    peak_age_min=0,\n    peak_age_max=100,\n    senescence_age_window=5,\n    outlier_age_window=5,\n    outlier_percentile=100, # Don't remove any outlier for now\n    smoothing_window=200,\n    smoothing_polyorder=5,\n    n_sample_plot=2000000,\n    create_plot=True,\n    plot_figsize=(20, 8)\n)","key":"X14kbsF2VV"},{"type":"output","id":"hO4akN8yv2mt75TUaO1d1","data":[{"name":"stdout","output_type":"stream","text":"=== Acer rubrum Growth Curve Analysis with Prevalence Thresholds ===\nParameters:\n  Peak search range: 0-100 years\n  Senescence age window: 5 years\n  Outlier removal: 5-year windows, 100% threshold\n  Smoothing window: 200 points\n  Prevalence thresholds: [100, 80, 60, 40, 20]\nReading raster files...\n✓ Rasters loaded successfully\nProcessing data and applying masks...\n✓ 8337062 valid pixels found\nRemoving outliers (age window: 5 years, percentile: 100%)...\nProcessing 51 age windows...\n"},{"name":"stderr","output_type":"stream","text":"Processing age windows: 100%|██████████████████████████████████████████████████████████| 51/51 [00:00\u003c00:00, 100.27it/s]\n"},{"name":"stdout","output_type":"stream","text":"✓ 8337062 pixels remaining after outlier removal\n\nProcessing curves for each prevalence threshold...\n\n--- Processing threshold 100% ---\n  Threshold 100%: 8337062 points remaining (100.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 100%: 96 raw points, 185 smoothed points\n\n--- Processing threshold 80% ---\n  Threshold 80%: 8337062 points remaining (100.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 80%: 96 raw points, 185 smoothed points\n\n--- Processing threshold 60% ---\n  Threshold 60%: 8337061 points remaining (100.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 60%: 96 raw points, 185 smoothed points\n\n--- Processing threshold 40% ---\n  Threshold 40%: 8312061 points remaining (99.7% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 40%: 92 raw points, 185 smoothed points\n\n--- Processing threshold 20% ---\n  Threshold 20%: 7763982 points remaining (93.1% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 20%: 93 raw points, 185 smoothed points\n\nCreating CSV output...\n✓ CSV saved to: ./ReferencesAndData/acer_rubrum_estimated_growth_curves_NFI.csv\nSampling 2000000 points with prevalence-based weighting...\n✓ Sampled 2000000 points (avg prevalence: 13.1%)\n\nCreating visualization...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"aa10c038066db7b1655fa5c903bd4517","path":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/aa10c038066db7b1655fa5c903bd4517.png"},"text/plain":{"content":"\u003cFigure size 2000x800 with 4 Axes\u003e","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"\n=== Analysis Complete ===\nTotal processing time: 67.3 seconds\nProcessed 8337062 pixels total\nCSV saved to: ./ReferencesAndData/acer_rubrum_estimated_growth_curves_NFI.csv\n\nCurve Summary:\n  Threshold ≤20%: Peak 31.89 tons/ha at age 70.0 (7763982 points)\n  Threshold ≤40%: Peak 48.14 tons/ha at age 62.0 (8312061 points)\n  Threshold ≤60%: Peak 50.80 tons/ha at age 62.0 (8337061 points)\n  Threshold ≤80%: Peak 50.77 tons/ha at age 62.0 (8337062 points)\n  Threshold ≤100%: Peak 50.77 tons/ha at age 62.0 (8337062 points)\n"}],"key":"xRISQeajBi"}],"key":"IiJFlfmNW4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":6,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kKeA5mXGaA"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Picea mariana","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ja6EL9paRc"}],"key":"I8WMuKqpys"},{"type":"text","value":" with the curve-construction algorithm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QKaoi5EdEq"}],"identifier":"producing-estimated-growth-curves-for-picea-mariana-with-the-curve-construction-algorithm","label":"Producing estimated growth curves for Picea mariana with the curve-construction algorithm","html_id":"producing-estimated-growth-curves-for-picea-mariana-with-the-curve-construction-algorithm","implicit":true,"key":"NE5JeIZxu5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We’re taking a look at our third species, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Glo5icYXKu"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Picea mariana","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OrBKSNySHm"}],"key":"XUJ5yU5LqE"},{"type":"text","value":". Same protocol as previous section with ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LFv2EqBjV3"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Gc829Vhsra"}],"key":"QS1LSk4YY5"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pcNm9jJLWB"}],"key":"aJIeVqn230"}],"key":"AU6VaMGkH0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from functionsForCalibration import *\n\nresults = analyze_species_growth_curves(\n    prevalence_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Pice_Mar_v1.tif',\n    age_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif',\n    biomass_raster_path='./ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif',\n    species_name='Picea Mariana',\n    output_csv_path='./ReferencesAndData/Growth Curves Predictions/picea_mariana_estimated_growth_curves_NFI.csv',\n    prevalence_thresholds=[100, 80, 60, 40, 20],\n    peak_age_min=0,\n    peak_age_max=200, # Peak is a bit later for Picea mariana compared to Abies balsamea and Acer rubrum\n    senescence_age_window=5,\n    outlier_age_window=5,\n    outlier_percentile=100, # Don't remove any outlier for now\n    smoothing_window=200,\n    smoothing_polyorder=5,\n    n_sample_plot=2000000,\n    create_plot=True,\n    plot_figsize=(20, 8)\n)","key":"eInRRcu1Yu"},{"type":"output","id":"H7PvevSoavZr-CnqJJqlV","data":[{"name":"stdout","output_type":"stream","text":"=== Picea Mariana Growth Curve Analysis with Prevalence Thresholds ===\nParameters:\n  Peak search range: 0-200 years\n  Senescence age window: 5 years\n  Outlier removal: 5-year windows, 100% threshold\n  Smoothing window: 200 points\n  Prevalence thresholds: [100, 80, 60, 40, 20]\nReading raster files...\n✓ Rasters loaded successfully\nProcessing data and applying masks...\n✓ 80116986 valid pixels found\nRemoving outliers (age window: 5 years, percentile: 100%)...\nProcessing 70 age windows...\n"},{"name":"stderr","output_type":"stream","text":"Processing age windows: 100%|██████████████████████████████████████████████████████████| 70/70 [00:07\u003c00:00,  9.66it/s]\n"},{"name":"stdout","output_type":"stream","text":"✓ 80116986 pixels remaining after outlier removal\n\nProcessing curves for each prevalence threshold...\n\n--- Processing threshold 100% ---\n  Threshold 100%: 80116986 points remaining (100.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 100%: 124 raw points, 295 smoothed points\n\n--- Processing threshold 80% ---\n  Threshold 80%: 71328226 points remaining (89.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 80%: 120 raw points, 295 smoothed points\n\n--- Processing threshold 60% ---\n  Threshold 60%: 58280657 points remaining (72.7% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 60%: 121 raw points, 295 smoothed points\n\n--- Processing threshold 40% ---\n  Threshold 40%: 44835036 points remaining (56.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 40%: 104 raw points, 295 smoothed points\n\n--- Processing threshold 20% ---\n  Threshold 20%: 21607588 points remaining (27.0% of original)\n  Constructing growth curve...\n  Interpolating to yearly intervals...\n  Smoothing curve...\n  ✓ Threshold 20%: 96 raw points, 281 smoothed points\n\nCreating CSV output...\n✓ CSV saved to: ./ReferencesAndData/Growth Curves Predictions/picea_mariana_estimated_growth_curves_NFI.csv\nSampling 2000000 points with prevalence-based weighting...\n✓ Sampled 2000000 points (avg prevalence: 58.9%)\n\nCreating visualization...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"aee705277451a88bc310ea1938dc9dd6","path":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/aee705277451a88bc310ea1938dc9dd6.png"},"text/plain":{"content":"\u003cFigure size 2000x800 with 4 Axes\u003e","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"\n=== Analysis Complete ===\nTotal processing time: 189.5 seconds\nProcessed 80116986 pixels total\nCSV saved to: ./ReferencesAndData/Growth Curves Predictions/picea_mariana_estimated_growth_curves_NFI.csv\n\nCurve Summary:\n  Threshold ≤20%: Peak 58.37 tons/ha at age 151.0 (21607588 points)\n  Threshold ≤40%: Peak 80.00 tons/ha at age 164.0 (44835036 points)\n  Threshold ≤60%: Peak 106.50 tons/ha at age 122.0 (58280657 points)\n  Threshold ≤80%: Peak 139.02 tons/ha at age 122.0 (71328226 points)\n  Threshold ≤100%: Peak 162.61 tons/ha at age 130.0 (80116986 points)\n"}],"key":"J0o9c6sE0X"}],"key":"jQwwzWn5tb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing growth curves from NFI data with a Generalized Additive Model (GAM)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PfROTjSPcn"}],"identifier":"producing-growth-curves-from-nfi-data-with-a-generalized-additive-model-gam","label":"Producing growth curves from NFI data with a Generalized Additive Model (GAM)","html_id":"producing-growth-curves-from-nfi-data-with-a-generalized-additive-model-gam","implicit":true,"key":"mssabaBHTx"}],"key":"VMS4lppcW1"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here, we process the data in order to identify the highest percentiles of biomass for each species for set of successive age windows and abundance windows (see figure below). Once we have identified these percentile, we use a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xJ8gFDywDn"},{"type":"link","url":"https://en.wikipedia.org/wiki/Generalized_additive_model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generalize Additive Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t9bacq3GV0"}],"urlSource":"https://en.wikipedia.org/wiki/Generalized_additive_model","data":{"page":"Generalized_additive_model","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"WtwGPLNpf4"},{"type":"text","value":" (GAM) fitted on this processed data in order to predict the percentile values as a fonction of age, but also of the percentage of abundance of the species in a cell. GAMs are dealt with using the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WfaIofQZVv"},{"type":"link","url":"https://pygam.readthedocs.io/en/latest/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"pyGAM package","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DLoVJcqtRf"}],"urlSource":"https://pygam.readthedocs.io/en/latest/","key":"InIxG4XqOY"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Muu5Z5gj4k"}],"key":"oMzRVzF7eE"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This is essential for species like ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BCSvKfxChD"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dVctcq6Koc"}],"key":"VPM3O855Nm"},{"type":"text","value":" in our dataset for which most of the pixels where the species is present do not have a high abundance for the species; for the great majority of pixels values for ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XM1jQU0SPu"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"R1Fc4F0sIE"}],"key":"k9ZHANHwTK"},{"type":"text","value":", we do not go beyond 60% of abundance of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FE1jBC69iJ"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FGCGnrTJc4"}],"key":"f0kLjbMSwB"},{"type":"text","value":" in the stand (see figures above). However, remember that our goal here is to estimate (as much as can be) the growth of the species in ideal conditions, which includes no competition for light from other species, meaning in monoculture (100% abundance).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BnZ3L5nSc4"}],"key":"QzI1jmdsi6"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The use of a GAM allows us to make predictions about what would be the growth of the species in condition of full abundance (100%)/monoculture, even though we have no data or few data points/pixels with such an abundance.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"AYdfuaG6NQ"}],"key":"RPESvDRLWL"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The issue is that fitting a GAM on the NFI data was more difficult than I expected; because of the space-for-time substitution we’re doing and the fact that we’re looking at data from the entire province, it seems that the patterns in the data (e.g. effect of age and abundance on biomass) can seem quite clear to the human eye, but can be difficult to mirror properly in a GAM. The overabundance of low-abundance pixels, and also the presence of some high-abundance pixels with relatively low biomass values and other outliers tended to create unexpected and absurd GAM behaviour.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"L9PinLLmSM"}],"key":"BCuXMcPIY2"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"I solved this issue by pre-processing the data (see figure below) to 1) reduce the number of points, 2) remove the outliers, and 3) force a monotonic increasing rule regarding the effect of abundance of the high percentiles of biomass. This pre-processing is highly customizible, allowing you to define the size of the windows, the percentile computed, or to exclude certain pixels; see the function ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"yQaNpfI6hj"},{"type":"inlineCode","value":"prepareNFIDataForGAMs","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"vwxkdjX7K3"},{"type":"text","value":". The fitting of the GAM can also be customised.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"KjbtMYo78i"}],"key":"XyuiZ8CzWL"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The best GAM structure I’ve found so far to produce these curve is the following :","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"diPymGYjv5"}],"key":"jhkLyfqvTK"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"inlineMath","value":"\\text{High Biomass Percentile} = s(age, \\text{with a concave constraint}) + interaction(age, \\% abundance, \\text{with a concave constraint})","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003eHigh Biomass Percentile\u003c/mtext\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmi\u003eg\u003c/mi\u003e\u003cmi\u003ee\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmtext\u003ewith a concave constraint\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmi\u003ee\u003c/mi\u003e\u003cmi\u003er\u003c/mi\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmi\u003ec\u003c/mi\u003e\u003cmi\u003et\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003eo\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmi\u003eg\u003c/mi\u003e\u003cmi\u003ee\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmi mathvariant=\"normal\"\u003e%\u003c/mi\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmi\u003eb\u003c/mi\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmi\u003ec\u003c/mi\u003e\u003cmi\u003ee\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmtext\u003ewith a concave constraint\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{High Biomass Percentile} = s(age, \\text{with a concave constraint}) + interaction(age, \\% abundance, \\text{with a concave constraint})\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eHigh Biomass Percentile\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003es\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eg\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ee\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003ewith a concave constraint\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ein\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003eer\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ec\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ei\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eo\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eg\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ee\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e%\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eab\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ean\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ece\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003ewith a concave constraint\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"wuOpx2Mx7t"}],"key":"UfF1iEYqyC"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The concave constrait force the effect of age and the 2D plane of the interaction effect (tensor product) of age and % abundance to be concave, which matches the biological reality that after a certain age, the biomass of the species will decrease.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"TUMeN5esDP"}],"key":"w7HiQ6fv7P"},{"type":"image","url":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/GAM_DataProessing_NF-3357e4b65ceb134f9c46dd8300697344.PNG","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"pzfsSvZHTO","urlSource":"./Images/GAM_DataProessing_NFI_Method.PNG"}],"key":"OBtT223JFv"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":6,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Tj4C353hUC"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p6K4ZBjnAM"}],"key":"nIe1Vs9wk7"},{"type":"text","value":" with a GAM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QuK85F6Mn2"}],"identifier":"producing-estimated-growth-curves-for-abies-balsamea-with-a-gam","label":"Producing estimated growth curves for Abies balsamea with a GAM","html_id":"producing-estimated-growth-curves-for-abies-balsamea-with-a-gam","implicit":true,"key":"x8O5BmpZ4a"}],"key":"l4tFPtEVlv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from functionsForCalibration import *\n\nwindowed_df = prepareNFIDataForGAMs(abundance_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Abie_Bal_v1.tif',\n                                  age_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif',\n                                  biomass_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif',\n                                  speciesName = \"Abies balsamea\",\n                                  age_window = 5,\n                                  abundance_window = 10,\n                                  percentile = 100,\n                                  mask_path = None,\n                                  printPlot = False)\n\ncreateGAMsAndPredictionsForNFIDataGrowthCurves(windowed_df,\n                                                './ReferencesAndData/Growth Curves Predictions/Abies Balsamea_gam_predictions.csv',\n                                               \"Abies balsamea\",\n                                                cutoff_age = 150,\n                                                abundance_levels = [100, 80, 60, 40, 20],\n                                                printPlot = True)","key":"k6ZgxLvUeN"},{"type":"output","id":"szB1GIYKB_YR5QgP25TtO","data":[{"name":"stdout","output_type":"stream","text":"Reading raster data...\nCreating initial dataframe...\nInitial dataframe shape: (32674827, 3)\nAge range: 0.0 - 348.4\nAbundance range: 0.0 - 100.0\n\nProcessing with parameters:\nAge window: 5\nAbundance window: 10\nPercentile: 100\n\nCreating windowed dataframe...\nApplied monotonic abundance constraint - kept 350 entries\nWindowed dataframe shape: (350, 3)\nNo data points found in the specified windows!\nFiltering data by age cutoff...\nOriginal dataframe shape: (350, 3)\nFiltered dataframe shape (Age \u003c 150): (236, 3)\nFiltered age range: 0.0 - 147.5\nFiltered abundance range: 5.0 - 95.0\n\nFitting weighted GAM model...\ndid not converge\nGAM fitted successfully with constraints and abundance weighting!\nGAM summary:\n  - Number of observations: 236\n  - R-squared (pseudo): 0.943\n  - Constraints applied:\n    * Age effect: concave\n    * Tensor product interaction: concave\n    * Intercept forced to 0\n    * Weighted toward high abundance observations\n\nGenerating predictions for abundance levels: [100, 80, 60, 40, 20]\nGenerated predictions for 100% abundance:\n  - Biomass range: 11.86 - 95.97\n  - Value at age 0: 11.856283\nGenerated predictions for 80% abundance:\n  - Biomass range: 7.58 - 91.05\n  - Value at age 0: 7.575023\nGenerated predictions for 60% abundance:\n  - Biomass range: 1.93 - 85.51\n  - Value at age 0: 1.934564\nGenerated predictions for 40% abundance:\n  - Biomass range: -4.76 - 73.33\n  - Value at age 0: -4.760048\nGenerated predictions for 20% abundance:\n  - Biomass range: -13.71 - 52.83\n  - Value at age 0: -13.714163\n\nCreating plot with multiple GAM predictions...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4e22d868c9abd32175fc1fe04e375b9c","path":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/4e22d868c9abd32175fc1fe04e375b9c.png"},"text/plain":{"content":"\u003cFigure size 1600x1000 with 2 Axes\u003e","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"\nGAM Model Information:\nCutoff age used: 150 years\nData points used for fitting: 236\nPrediction curves: 0-150 years for 5 abundance levels\nModel constraints and weighting applied successfully\nPredictions exported to ./ReferencesAndData/Growth Curves Predictions/Abies Balsamea_gam_predictions.csv\nShape: (100, 6)\nColumns: ['Age', 'GAM_Prediction_100%Abundance', 'GAM_Prediction_80%Abundance', 'GAM_Prediction_60%Abundance', 'GAM_Prediction_40%Abundance', 'GAM_Prediction_20%Abundance']\nAge range: 0.0 - 150.0\n\nPreview of exported data:\n        Age  GAM_Prediction_100%Abundance  GAM_Prediction_80%Abundance  \\\n0  0.000000                     11.856283                     7.575023   \n1  1.515152                     15.636944                    11.182145   \n2  3.030303                     19.377459                    14.753408   \n3  4.545455                     23.069911                    18.281029   \n4  6.060606                     26.706385                    21.757229   \n\n   GAM_Prediction_60%Abundance  GAM_Prediction_40%Abundance  \\\n0                     1.934564                    -4.760048   \n1                     5.252371                    -1.752317   \n2                     8.536013                     1.221635   \n3                    11.779049                     4.155960   \n4                    14.975040                     7.044810   \n\n   GAM_Prediction_20%Abundance  \n0                   -13.714163  \n1                   -10.932160  \n2                    -8.182467  \n3                    -5.470878  \n4                    -2.803186  \n"}],"key":"Mcx6WM6TZk"}],"key":"nd1XhxUPsU"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":6,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Kz7gWbEmee"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c2qHl05HuN"}],"key":"PwJW9ogtjb"},{"type":"text","value":" with a GAM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y5JD7lSGyb"}],"identifier":"producing-estimated-growth-curves-for-acer-rubrum-with-a-gam","label":"Producing estimated growth curves for Acer rubrum with a GAM","html_id":"producing-estimated-growth-curves-for-acer-rubrum-with-a-gam","implicit":true,"key":"dZbMQnC7nM"}],"key":"awuL9dXbNn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from functionsForCalibration import *\n\nwindowed_df = prepareNFIDataForGAMs(abundance_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Acer_Rub_v1.tif',\n                                  age_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif',\n                                  biomass_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif',\n                                  speciesName = \"Acer rubrum\",\n                                  age_window = 5,\n                                  abundance_window = 10,\n                                  percentile = 100,\n                                  mask_path = None,\n                                  printPlot = False)\n\ncreateGAMsAndPredictionsForNFIDataGrowthCurves(windowed_df,\n                                                './ReferencesAndData/Growth Curves Predictions/Acer rubrum_gam_predictions.csv',\n                                               \"Acer rubrum\",\n                                                cutoff_age = 150,\n                                                abundance_levels = [100, 80, 60, 40, 20],\n                                                printPlot = True)","key":"lZjjPTB5VM"},{"type":"output","id":"bro824xJA_VNeeOLshEbB","data":[{"name":"stdout","output_type":"stream","text":"Reading raster data...\nCreating initial dataframe...\nInitial dataframe shape: (8337062, 3)\nAge range: 0.0 - 251.8\nAbundance range: 0.0 - 60.9\n\nProcessing with parameters:\nAge window: 5\nAbundance window: 10\nPercentile: 100\n\nCreating windowed dataframe...\nApplied monotonic abundance constraint - kept 155 entries\nWindowed dataframe shape: (155, 3)\nNo data points found in the specified windows!\nFiltering data by age cutoff...\nOriginal dataframe shape: (155, 3)\nFiltered dataframe shape (Age \u003c 150): (118, 3)\nFiltered age range: 0.0 - 147.5\nFiltered abundance range: 5.0 - 95.0\n\nFitting weighted GAM model...\ndid not converge\nGAM fitted successfully with constraints and abundance weighting!\nGAM summary:\n  - Number of observations: 118\n  - R-squared (pseudo): 0.978\n  - Constraints applied:\n    * Age effect: concave\n    * Tensor product interaction: concave\n    * Intercept forced to 0\n    * Weighted toward high abundance observations\n\nGenerating predictions for abundance levels: [100, 80, 60, 40, 20]\nGenerated predictions for 100% abundance:\n  - Biomass range: -0.09 - 90.48\n  - Value at age 0: -0.092426\nGenerated predictions for 80% abundance:\n  - Biomass range: 0.68 - 73.15\n  - Value at age 0: 0.680676\nGenerated predictions for 60% abundance:\n  - Biomass range: 1.24 - 62.20\n  - Value at age 0: 1.237291\nGenerated predictions for 40% abundance:\n  - Biomass range: 0.88 - 51.93\n  - Value at age 0: 0.880931\nGenerated predictions for 20% abundance:\n  - Biomass range: -0.77 - 40.20\n  - Value at age 0: -0.774627\n\nCreating plot with multiple GAM predictions...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"00a2ac33f4584fed02010dce7ff226b8","path":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/00a2ac33f4584fed02010dce7ff226b8.png"},"text/plain":{"content":"\u003cFigure size 1600x1000 with 2 Axes\u003e","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"\nGAM Model Information:\nCutoff age used: 150 years\nData points used for fitting: 118\nPrediction curves: 0-150 years for 5 abundance levels\nModel constraints and weighting applied successfully\nPredictions exported to ./ReferencesAndData/Growth Curves Predictions/Acer rubrum_gam_predictions.csv\nShape: (100, 6)\nColumns: ['Age', 'GAM_Prediction_100%Abundance', 'GAM_Prediction_80%Abundance', 'GAM_Prediction_60%Abundance', 'GAM_Prediction_40%Abundance', 'GAM_Prediction_20%Abundance']\nAge range: 0.0 - 150.0\n\nPreview of exported data:\n        Age  GAM_Prediction_100%Abundance  GAM_Prediction_80%Abundance  \\\n0  0.000000                     -0.092426                     0.680676   \n1  1.515152                      2.045502                     2.709385   \n2  3.030303                      4.179371                     4.733866   \n3  4.545455                      6.307968                     6.752787   \n4  6.060606                      8.430078                     8.764815   \n\n   GAM_Prediction_60%Abundance  GAM_Prediction_40%Abundance  \\\n0                     1.237291                     0.880931   \n1                     3.142053                     2.597460   \n2                     5.042615                     4.309738   \n3                     6.937566                     6.016400   \n4                     8.825494                     7.716084   \n\n   GAM_Prediction_20%Abundance  \n0                    -0.774627  \n1                     0.686626  \n2                     2.143208  \n3                     3.593859  \n4                     5.037319  \n"}],"key":"cpmmX9gelJ"}],"key":"irmC0xS3w0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":6,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Producing estimated growth curves for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aPY2tdwJtR"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Picea mariana","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"La0k6grJ3k"}],"key":"mIIptixXGE"},{"type":"text","value":" with a GAM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZgrVTONsbi"}],"identifier":"producing-estimated-growth-curves-for-picea-mariana-with-a-gam","label":"Producing estimated growth curves for Picea mariana with a GAM","html_id":"producing-estimated-growth-curves-for-picea-mariana-with-a-gam","implicit":true,"key":"sKLKHp3Oig"}],"key":"CrE12gLS0w"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from functionsForCalibration import *\n\nwindowed_df = prepareNFIDataForGAMs(abundance_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Species_Pice_Mar_v1.tif',\n                                  age_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Stand_Age_v1.tif',\n                                  biomass_path = './ReferencesAndData/NFI_Data/NFI_MODIS250m_2011_kNN_Structure_Biomass_TotalLiveAboveGround_v1.tif',\n                                  speciesName = \"Picea mariana\",\n                                  age_window = 5,\n                                  abundance_window = 10,\n                                  percentile = 100,\n                                  mask_path = None,\n                                  printPlot = False)\n\ncreateGAMsAndPredictionsForNFIDataGrowthCurves(windowed_df,\n                                                './ReferencesAndData/Growth Curves Predictions/Picea mariana_gam_predictions.csv',\n                                               \"Picea mariana\",\n                                                cutoff_age = 200, # The take more data as the pic of Picea mariana seems to be later than for Abies balsamea and Acer rubrum\n                                                abundance_levels = [100, 80, 60, 40, 20],\n                                                printPlot = True)","key":"YpZzBIw0VU"},{"type":"output","id":"TKRgX2MuA8UMVjYpwQbrd","data":[{"name":"stdout","output_type":"stream","text":"Reading raster data...\nCreating initial dataframe...\nInitial dataframe shape: (80116986, 3)\nAge range: 0.0 - 348.4\nAbundance range: 0.0 - 100.0\n\nProcessing with parameters:\nAge window: 5\nAbundance window: 10\nPercentile: 100\n\nCreating windowed dataframe...\nApplied monotonic abundance constraint - kept 404 entries\nWindowed dataframe shape: (404, 3)\nNo data points found in the specified windows!\nFiltering data by age cutoff...\nOriginal dataframe shape: (404, 3)\nFiltered dataframe shape (Age \u003c 200): (310, 3)\nFiltered age range: 0.0 - 197.5\nFiltered abundance range: 5.0 - 95.0\n\nFitting weighted GAM model...\nGAM fitted successfully with constraints and abundance weighting!\nGAM summary:\n  - Number of observations: 310\n  - R-squared (pseudo): 0.986\n  - Constraints applied:\n    * Age effect: concave\n    * Tensor product interaction: concave\n    * Intercept forced to 0\n    * Weighted toward high abundance observations\n\nGenerating predictions for abundance levels: [100, 80, 60, 40, 20]\nGenerated predictions for 100% abundance:\n  - Biomass range: 1.62 - 162.79\n  - Value at age 0: 1.619057\nGenerated predictions for 80% abundance:\n  - Biomass range: 4.53 - 137.91\n  - Value at age 0: 4.533635\nGenerated predictions for 60% abundance:\n  - Biomass range: 5.99 - 111.49\n  - Value at age 0: 5.992570\nGenerated predictions for 40% abundance:\n  - Biomass range: 3.08 - 83.63\n  - Value at age 0: 3.082758\nGenerated predictions for 20% abundance:\n  - Biomass range: -6.66 - 54.52\n  - Value at age 0: -6.659307\n\nCreating plot with multiple GAM predictions...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a8b37048c3f11cefcd5b9c3276408f07","path":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/a8b37048c3f11cefcd5b9c3276408f07.png"},"text/plain":{"content":"\u003cFigure size 1600x1000 with 2 Axes\u003e","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"\nGAM Model Information:\nCutoff age used: 200 years\nData points used for fitting: 310\nPrediction curves: 0-200 years for 5 abundance levels\nModel constraints and weighting applied successfully\nPredictions exported to ./ReferencesAndData/Growth Curves Predictions/Picea mariana_gam_predictions.csv\nShape: (100, 6)\nColumns: ['Age', 'GAM_Prediction_100%Abundance', 'GAM_Prediction_80%Abundance', 'GAM_Prediction_60%Abundance', 'GAM_Prediction_40%Abundance', 'GAM_Prediction_20%Abundance']\nAge range: 0.0 - 200.0\n\nPreview of exported data:\n        Age  GAM_Prediction_100%Abundance  GAM_Prediction_80%Abundance  \\\n0  0.000000                      1.619057                     4.533635   \n1  2.020202                      5.081319                     7.759642   \n2  4.040404                      8.529249                    10.973141   \n3  6.060606                     11.962244                    14.173377   \n4  8.080808                     15.379699                    17.359592   \n\n   GAM_Prediction_60%Abundance  GAM_Prediction_40%Abundance  \\\n0                     5.992570                     3.082758   \n1                     8.864901                     5.428215   \n2                    11.722846                     7.755498   \n3                    14.565205                    10.063526   \n4                    17.390782                    12.351221   \n\n   GAM_Prediction_20%Abundance  \n0                    -6.659307  \n1                    -4.793040  \n2                    -2.943452  \n3                    -1.111152  \n4                     0.703252  \n"}],"key":"JHotpcPSX2"}],"key":"C0BYd96Fe3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Values needed to estimate certain parameters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kou8jPQMlG"}],"identifier":"values-needed-to-estimate-certain-parameters","label":"Values needed to estimate certain parameters","html_id":"values-needed-to-estimate-certain-parameters","implicit":true,"key":"QVgM3sYaSf"}],"key":"sbEaW99ElL"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Longevity and Max Longevity","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DmXV1SL8iv"}],"identifier":"longevity-and-max-longevity","label":"Longevity and Max Longevity","html_id":"longevity-and-max-longevity","implicit":true,"key":"Xle9DsHExO"}],"key":"C5BM96kqjC"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What we will call here “Longevity” and “Max Longevity” are necessary to calibrate the senescence part of the growth curve for our species.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o9gtweiu4L"}],"key":"K4kg7m8Zn5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The difference between the two is this, per the team of Brian Sturtevant who explained their methodology to me :","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Zq9dnxEEnj"}],"key":"EKCGGVLkfp"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Longevity is the rule-of-thumb, expert opinion longevity for a given tree species. This is the age at which it’s expected that a tree of a given species will die, in a give region. These are the number often reported in the litterature, and also used in the core species parameter file of LANDIS-II as its “Longevity” parameter for each tree species used.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PShouQUlju"}],"key":"x9LYXauoi3"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Max Longevity is the real, empirical maximum age that a tree species can reach in the study area. It’s often not reported and difficult to find. A good way to find it is to look at sample plot data and find the oldest trees ever found for a given species (which can be difficult to find as the “age” data is often not directly available in sample plots data).","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"P2u1xj867m"}],"key":"eJNFYfzAPz"}],"key":"oLbJqP4kO2"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Brian Sturtevant and his team have used these two notions to calibrate the senescence part of the growth curves in ideal conditions as explained in ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"OsoCSfjq6f"},{"type":"link","url":"./6.Monoculture_ideal_conditions.py","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[],"urlSource":"./6.Monoculture_ideal_conditions.py","key":"iPB3QlWa2K"},{"type":"text","value":".  This part from ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"VYvv5Y20Ow"},{"type":"cite","url":"https://cdnsciencepub.com/doi/suppl/10.1139/cjfr-2024-0085/suppl_file/cjfr-2024-0085suppla.docx","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"this supplementary material of Reese et al. (2025)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"CqkGaSd76c"}],"kind":"narrative","label":"Reese_2025","identifier":"https://cdnsciencepub.com/doi/suppl/10.1139/cjfr-2024-0085/suppl_file/cjfr-2024-0085suppla.docx","enumerator":"3","key":"edQekrQqmF"},{"type":"text","value":" describes Brian’s methodology of explains it all :","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"wCvKQdNIkb"}],"key":"wL5RDrN8ul"},{"type":"blockquote","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"We used an unpublished review and analysis led by John Du Plissis at the University of Minnesota-Duluth to define both tree species longevity (the age at which a species age cohort can no longer persist) and the initiation of decline that is defined by the age-related photosynthesis reduction factor (","key":"EDQCu43Jl4"},{"type":"abbreviation","title":"Reduction factor of photosynthesis as the age of an age cohort increases.","children":[{"type":"text","value":"PsnAgeRed","key":"siexYTPWB2"}],"key":"upmSvnEtr4"},{"type":"text","value":") parameter in PnET Succession. In general, the maximum species longevity of Loehle (1988) corresponds with the tree species longevity parameter, while the typical species’ longevity from the same publication determines the initiation of decline, where ","key":"QBWKSUW08H"},{"type":"abbreviation","title":"Reduction factor of photosynthesis as the age of an age cohort increases.","children":[{"type":"text","value":"PsnAgeRed","key":"XUIOg4LF7f"}],"key":"JhAvHJhQyz"},{"type":"text","value":" is calibrated such that the fAGE (age reduction factor) begins to decline (~0.99) at the Typical Mortality age of the species.","key":"Antc5SIFWt"}],"key":"MtVpl1EaWb"}],"key":"jSJf84czvL"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"The data used by Brian’s team for Typical Longevity and Max Longevity are cited as coming from ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"PO4ghThqFY"},{"type":"cite","url":"https://sci-hub.st/https://cdnsciencepub.com/doi/10.1139/x88-032","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Loehle (1988)","key":"Ks2FDUHMek"}],"kind":"narrative","label":"Loehle_1988","identifier":"https://sci-hub.st/https://cdnsciencepub.com/doi/10.1139/x88-032","enumerator":"4","key":"KYnAk99LkY"},{"type":"text","value":" in ReeseEtAl_CanJForRes_2024_supplA.docx ; it’s an article that seem to compute them based on several characteristics of tree species.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"G6LEWce5nf"}],"key":"NZH87YjJH0"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"In the end, Brian’s team is using a combination of data from ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"jyAZ7IoMUB"},{"type":"cite","url":"https://cdnsciencepub.com/doi/10.1139/x88-032","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Loehle (1988)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"hnb1nBsANF"}],"kind":"narrative","label":"Loehle_1988","identifier":"https://cdnsciencepub.com/doi/10.1139/x88-032","enumerator":"4","key":"fHuQjHJSX5"},{"type":"text","value":" and estimates found by John Du Plissis (yet unpublished). I’m going to use the data from ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"tZsc5ZASPw"},{"type":"cite","url":"https://cdnsciencepub.com/doi/10.1139/x88-032","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Loehle (1988)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"YP0OvopukI"}],"kind":"narrative","label":"Loehle_1988","identifier":"https://cdnsciencepub.com/doi/10.1139/x88-032","enumerator":"4","key":"BGRJ4wC9qd"},{"type":"text","value":", which should be enough for our goals until the data from Du Plissis is published.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"er3hnWwXdg"}],"key":"SsTVz4rjsi"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"cite","url":"https://cdnsciencepub.com/doi/10.1139/x88-032","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Loehle (1988)","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"lPjNMMKRYj"}],"kind":"narrative","label":"Loehle_1988","identifier":"https://cdnsciencepub.com/doi/10.1139/x88-032","enumerator":"4","key":"J3lzZ6DuIg"},{"type":"text","value":", defines “Typical” versus “Maximum” longevity in the following terms :","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"k9qFBPLAOK"}],"key":"LdTXbxeRU8"},{"type":"blockquote","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Typical longevity is the age of the older trees in an old-growth stand, whereas maximum longevity is the upper known maximum above which very few trees are found.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"TroHn3hAcn"}],"key":"Pq1DKs9H7m"}],"key":"Bh3m2eQsdO"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"We can find the value of typical longevity and maximum longevity from Loehle in the Appendix 1. Here are the values for our three species :","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"lpsBxFeQEw"}],"key":"N2NpU3qZiz"}],"key":"RPTj38i99F"},{"type":"block","kind":"notebook-content","children":[{"type":"table","position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Species","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wT5c1aiNx5"}],"key":"Qyq9CrXThX"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"MINREP (years)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dbwNcKOx8D"}],"key":"s4iIyfLeS3"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"AVEREP (years)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FR4BtuxBvQ"}],"key":"pyFuwXP2aj"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"TYPMORT (years)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y4qGhdaVKh"}],"key":"XKSlfBC3PZ"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"MAXMORT (years)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dueQ9MeCf7"}],"key":"XhApjqj0fT"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Specific gravity","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qlg9bkWgqh"}],"key":"mtujaDu6MM"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Growth rate","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mLE3hCE7IJ"}],"key":"P19ivUxWps"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Shade tolerance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uDgs5JjeKq"}],"key":"IkFFm3RY19"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Volumetric heat (J·cm⁻³)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NguA4q8Nlm"}],"key":"cfje0NZODy"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Decay resistance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xOKm5MIG3H"}],"key":"kpK6XZ20zW"}],"key":"Vb2EREVvm6"},{"type":"tableRow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Abies balsamea","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"blpat0lkIP"}],"key":"m2QvsgSO5k"}],"key":"t2HR09lZ5F"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"15","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Q3JOt8Ozc1"}],"key":"VhEXgCp17X"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"30","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WHHnebOrQQ"}],"key":"V6pYjglvSj"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"125","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SKKa5IJ9SQ"}],"key":"pFNNjHlnbe"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"150","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jGC1Pcm0HG"}],"key":"QfFdmsEdp3"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"0.34","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KVIDZhTz4f"}],"key":"NqqSX6Hejx"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hjwJ4V2WyA"}],"key":"PCU5gmLhVw"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HfIA4SWxN0"}],"key":"ihqbmyo6cX"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"6.42","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Gzce411PnN"}],"key":"YZynsi03QL"},{"type":"tableCell","align":"left","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AtM8IWW47m"}],"key":"XRMUYzUdF5"}],"key":"p1BKzBAYUL"},{"type":"tableRow","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Picea mariana","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Vcd68cODcK"}],"key":"a9XWGc9aMx"}],"key":"xGWZ7I5dvk"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"10","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"JkhHnllPLx"}],"key":"zXlIJWYKW7"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"18","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Tnz5nXOK1Q"}],"key":"u3NpR4vvbc"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"150","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PtwRfDSVVk"}],"key":"WKCPjVYXEU"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"250","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"KOOTIAeZNm"}],"key":"Yr1WIRF39j"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"0.43","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"U28lGnAV9a"}],"key":"xKjLU8hb9m"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"sd1o6SYQ9K"}],"key":"RdNwAM822l"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ojCKcmJ071"}],"key":"CuKyvbCfpD"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"7.91","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"CoP7ak1WAs"}],"key":"z8PELvHWg4"},{"type":"tableCell","align":"left","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ztjWY4wVSZ"}],"key":"KRlE0DRVa0"}],"key":"qoAe7dVDIT"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Acer rubrum","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"vXPkyhg4Rf"}],"key":"X8PtQ0rzHY"}],"key":"PdRvvKTEgZ"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"AC1p2C3kh0"}],"key":"ywE73oMJSb"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[],"key":"FeSPjx1V2S"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"80","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"k7ByWuBWue"}],"key":"Yu9WG5Rrxf"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"150","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"E9jWZk7mMq"}],"key":"ho8u5zZZt1"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"0.49","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"I6qjOOQCUp"}],"key":"OwRHnnV7M7"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SizKT4VqhC"}],"key":"ER2K6t7NH1"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"P3x7f9V8O8"}],"key":"KQe3RzUbXD"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"9.93","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BVnDOElAMm"}],"key":"BaaJ5ptb6c"},{"type":"tableCell","align":"left","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YwbSq2pDHk"}],"key":"H8iBOd7Ycr"}],"key":"qKqccb6tcU"}],"key":"uo5OH9zUPm"}],"key":"BLXiX4oNeT"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Ranges of parameter values for the calibration","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UfcQevK9PY"}],"identifier":"ranges-of-parameter-values-for-the-calibration","label":"Ranges of parameter values for the calibration","html_id":"ranges-of-parameter-values-for-the-calibration","implicit":true,"key":"C76TTu7JXn"}],"key":"me62Ar65Tn"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Table with ranges extracted from the litterature for most PnET parameters ?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zOiop2MPRY"}],"key":"vzFpSG9onh"}],"key":"WRgD5CXKl6"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From Brian’s  team (ReeseEtAl_CanJForRes_2024_supplA.docx) :","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dsD9ksprFV"}],"key":"glydFvFGVy"},{"type":"blockquote","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Parameter calibrations were guided by plausible ranges for ecophysiological parameter values and species traits from the TRY Plant Trait Database (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RWNcizwTCl"},{"type":"link","url":"https://www.try-db.org/TryWeb/Home.php","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"https://​www​.try​-db​.org​/TryWeb​/Home​.php","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vZ4pz4jOOW"}],"urlSource":"https://www.try-db.org/TryWeb/Home.php","key":"ti4WhMWatq"},{"type":"text","value":"), cross-referenced against region-specific species ecology from the Fire Effects Information System (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vDMUGcBGrc"},{"type":"link","url":"https://www.feis-crs.org/feis/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"https://​www​.feis​-crs​.org​/feis/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ABJRIqHEm8"}],"urlSource":"https://www.feis-crs.org/feis/","key":"jemJOqtbZ7"},{"type":"text","value":").","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fzlyJVluh7"}],"key":"MLRa4xiKVq"}],"key":"OFoGFysy9R"}],"key":"HFSpdSNU43"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From the user guide :","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xbH3kKLXYm"}],"key":"ZNkCzwxbc6"},{"type":"blockquote","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The range of ","key":"H7W4YYmBcN"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"Jrn9SlfxMb"}],"key":"oMFMQOiUHZ"},{"type":"text","value":" for each species across sites, age, canopy position. This is a great starting point and helps put bounds on acceptable values, but it is important to recognize that productivity is closely related to ","key":"umSSg4pRgK"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"t7MwwhiWBI"}],"key":"tBwVunPC9J"},{"type":"text","value":" in PnET, so it is more important that ","key":"gaHCXcM2E1"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"rOZ0kfZ64S"}],"key":"AW0FNvpdyT"},{"type":"text","value":" reflect relative productivity among species than matching empirical values. That said, it is usually (but not always) possible to select a value of ","key":"k3DBOsCQtA"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"fgOVvIN74v"}],"key":"viEbw4Kr3n"},{"type":"text","value":" that is within the range of empirically measured values. If you have empirical values of Amax, use your values of ","key":"lewySVEZE9"},{"type":"abbreviation","title":"Intercept of the relationship between foliar N and maximum net photosynthetic rate.","children":[{"type":"text","value":"AmaxA","key":"apREAmoS3L"}],"key":"CbMKyV42mH"},{"type":"text","value":" and ","key":"Flipp3CLMz"},{"type":"abbreviation","title":"Slope of the relationship betwee foliar N and maximum net photosynthetic rate.","children":[{"type":"text","value":"AmaxB","key":"AEQ6QXJCGK"}],"key":"UpqdQ2MTMm"},{"type":"text","value":" (or see Fig. 2 in Aber et al. 1996) to estimate the ","key":"dfeDjFmTbv"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"CNzntmweZh"}],"key":"XsPBwWETjZ"},{"type":"text","value":" that produces that Amax value. NOTE: if you plan to implement dynamic ","key":"E2jZYVUzsm"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"u7E4y6Brdx"}],"key":"uZLjGZMuxv"},{"type":"text","value":" (","key":"Av8HUcMRfK"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"Sh4NqcZJ2x"}],"key":"RH5XwFqZdV"},{"type":"text","value":"Int and ","key":"nWtSI3847h"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"KHv3epXtCd"}],"key":"Wog4FM5kQY"},{"type":"text","value":"Slope set to values other than default), then be sure to set ","key":"LH0moqYkDI"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"c2rUfe44O6"}],"key":"YLDr7HnWa1"},{"type":"text","value":"Int and ","key":"kKXmc3Cdy7"},{"type":"abbreviation","title":"Foliar nitrogen content (in % by weight) for the leaves of the species.","children":[{"type":"text","value":"FolN","key":"gEpI6ixfNa"}],"key":"mijYzanKWS"},{"type":"text","value":"Slope to the values you will use in your final simulations while calibrating.","key":"vs3n9UXIfu"}],"key":"ljVFKDS6FU"}],"key":"c13ZMXpgcb"},{"type":"blockquote","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Species ","key":"TweuZXgvd3"},{"type":"abbreviation","title":"Specific leaf weight at the top of the canopy.","children":[{"type":"text","value":"SLWmax","key":"xQtWyuXDEd"}],"key":"OvnVbQbIvy"},{"type":"text","value":" helps determine LAI. Thicker leaves (higher SLW) reduce LAI. LAI determines the ability of a cohort to compete for light, so it is important to calibrate so that LAI produces realistic response to light. Again, it is more important to get LAI approximately right than to keep ","key":"EF2o34huKt"},{"type":"abbreviation","title":"Specific leaf weight at the top of the canopy.","children":[{"type":"text","value":"SLWmax","key":"DdysdDjqGK"}],"key":"axxZnRcVbY"},{"type":"text","value":" within the empirical range. Out-of-range ","key":"rVAFdsnbza"},{"type":"abbreviation","title":"Specific leaf weight at the top of the canopy.","children":[{"type":"text","value":"SLWmax","key":"WYE3XnKpDc"}],"key":"T0W6GJv7a4"},{"type":"text","value":" values often indicate that ","key":"WISGQh50Sk"},{"type":"abbreviation","title":"Fraction of the active woody biomass (above or belowground) of a cohort that determines the amount of foliage maintained each year.","children":[{"type":"text","value":"FracFol","key":"XE2Cylq5L5"}],"key":"dNFVgKMbrg"},{"type":"text","value":" values are incorrect. Note that higher LAI increases within-canopy competition for light and will modestly depress growth even of a single cohort. I have found that LAI values exceeding those given in Table 1 may greatly reduce the amount of light penetrating canopy layers, thus impacting growth, competition and establishment","key":"ed130aQbVg"}],"key":"lweraxVtCZ"}],"key":"oeE5FxUEQP"},{"type":"blockquote","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"There are some published estimates of whole tree biomass through time by species groups to provide some indication of belowground biomass (e.g., Smith et al. 2006). =\u003e Que ce sois cette source ou les modèles allometriques trouvés dans R, avoir des estimations du ration above/belowground serais très précieux.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"FaNgisPJ44"}],"key":"jSp2ZZLQ1d"}],"key":"IN0PNGoJx3"}],"key":"KHstM90NTO"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Competition outcomes between species","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fo1yNJNUEJ"}],"identifier":"competition-outcomes-between-species","label":"Competition outcomes between species","html_id":"competition-outcomes-between-species","implicit":true,"key":"mZSMajNDlu"}],"key":"A971hN3vnl"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Based on litterature + expert opinion, in different conditions :","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wXOqMnM8Lt"}],"key":"FJBjloas1n"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Baseline + Good water level","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"laXxNGMiac"}],"key":"EiqfwitBIj"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Baseline + Drought","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PONgHQ3v4H"}],"key":"irAl0W1wCW"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Baseline + Waterlogging","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xzur7UwIkD"}],"key":"NcYBo4hDwn"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Climate change ++","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Q5shUwqKqF"}],"key":"BXvvedPGuW"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Climate change +++","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vPPss2g4Wg"}],"key":"z6eSFNpRlh"}],"key":"r6mOAgK1X0"}],"key":"qsLOpf3Jwb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"DRAFTS","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ojlwfhg415"}],"identifier":"drafts","label":"DRAFTS","html_id":"drafts","implicit":true,"key":"AfE0mUEbAa"}],"key":"JWb94z7xeT"}],"key":"OqkAukQsvM"},"references":{"cite":{"order":["Pickett_1989","Beaudoin_2018","Reese_2025","Loehle_1988"],"data":{"Pickett_1989":{"label":"Pickett_1989","enumerator":"1","doi":"10.1007/978-1-4615-7358-6_5","html":"Pickett, S. T. A. (1989). Space-for-Time Substitution as an Alternative to Long-Term Studies. In \u003ci\u003eLong-Term Studies in Ecology\u003c/i\u003e (pp. 110–135). Springer New York. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/978-1-4615-7358-6_5\"\u003e10.1007/978-1-4615-7358-6_5\u003c/a\u003e","url":"https://doi.org/10.1007/978-1-4615-7358-6_5"},"Beaudoin_2018":{"label":"Beaudoin_2018","enumerator":"2","doi":"10.1139/cjfr-2017-0184","html":"Beaudoin, A., Bernier, P. Y., Villemaire, P., Guindon, L., \u0026 Guo, X. J. (2018). Tracking forest attributes across Canada between 2001 and 2011 using a k nearest neighbors mapping approach applied to MODIS imagery. \u003ci\u003eCanadian Journal of Forest Research\u003c/i\u003e, \u003ci\u003e48\u003c/i\u003e(1), 85–93. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1139/cjfr-2017-0184\"\u003e10.1139/cjfr-2017-0184\u003c/a\u003e","url":"https://doi.org/10.1139/cjfr-2017-0184"},"Reese_2025":{"label":"Reese_2025","enumerator":"3","doi":"10.1139/cjfr-2024-0085","html":"Reese, G. C., Sturtevant, B. R., Dymond, C. C., Quigley, K. M., Duveneck, M. J., Lucash, M. S., Gustafson, E. J., Scheller, R. M., Russell, M. B., \u0026 Miranda, B. R. (2025). Best practices for calibration of forest landscape models using fine-scaled reference information. \u003ci\u003eCanadian Journal of Forest Research\u003c/i\u003e, \u003ci\u003e55\u003c/i\u003e, 1–19. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1139/cjfr-2024-0085\"\u003e10.1139/cjfr-2024-0085\u003c/a\u003e","url":"https://doi.org/10.1139/cjfr-2024-0085"},"Loehle_1988":{"label":"Loehle_1988","enumerator":"4","doi":"10.1139/x88-032","html":"Loehle, C. (1988). Tree life history strategies: the role of defenses. \u003ci\u003eCanadian Journal of Forest Research\u003c/i\u003e, \u003ci\u003e18\u003c/i\u003e(2), 209–222. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1139/x88-032\"\u003e10.1139/x88-032\u003c/a\u003e","url":"https://doi.org/10.1139/x88-032"}}}},"footer":{"navigation":{"prev":{"title":"Initial species parameters","url":"/startingcalibrationtest/initial-species-parameters","group":"Calibration of PnET Succession for the DIVERSE project"},"next":{"title":"Getting the climate and soil data","url":"/startingcalibrationtest/getting-climate-and-soil-data","group":"Calibration of PnET Succession for the DIVERSE project"}}},"domain":"http://localhost:3000"},"project":{"bibliography":["/calibrationFolder/calibrationJupyterBook/references.bib"],"exports":[],"title":"Calibration of PnET Succession for the DIVERSE project","authors":[{"nameParsed":{"literal":"Clément Hardy, PhD.","given":"PhD.","family":"Clément Hardy"},"name":"Clément Hardy, PhD.","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/Klemet/Calibration_PnET_DIVERSE","toc":[{"file":"intro.md"},{"children":[{"file":"StartingCalibrationTest/0.Some_important_notions.ipynb"},{"file":"StartingCalibrationTest/1.Loading_functions.ipynb"},{"file":"StartingCalibrationTest/2.Test_sim_functions.ipynb"},{"file":"StartingCalibrationTest/3.Initial_Species_Parameters.ipynb"},{"file":"StartingCalibrationTest/4.Getting_the_empirical_data.ipynb"},{"file":"StartingCalibrationTest/5.Getting_climate_and_soil_data.ipynb"},{"file":"StartingCalibrationTest/6.Monoculture_ideal_conditions.ipynb"}],"file":"StartingCalibrationTest/Intro_CalibrationTest.ipynb"}],"index":"index","pages":[{"slug":"startingcalibrationtest.intro-calibrationtest","title":"Calibration test","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"startingcalibrationtest.some-important-notions","title":"Some important notions before we start","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/eric-prouzet-n_1SH37-ccafd8a41a4b6bf2e99e3858d4b450cb.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.loading-functions","title":"Loading functions and packages","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.test-sim-functions","title":"Making a test simulation to get used to the functions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.initial-species-parameters","title":"Initial species parameters","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.getting-the-empirical-data","title":"Getting the empirical data needed fo the calibration process","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/Algorithm_GrowthCurv-fc445ac3fd5e0813654caa5495dcaf2b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.getting-climate-and-soil-data","title":"Getting the climate and soil data","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/88c4f87a42ed43465897c61d30462b63.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.monoculture-ideal-conditions","title":"Phase 1 🌳 : Calibration of species in optimal conditions (monoculture + mesic soil + average and unchanging climate)","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/14232857c4e474f60fe4aad7bf85497d.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "https://klemet.github.io/Calibration_PnET_DIVERSE/build/manifest-B2B2E6A5.js";
import * as route0 from "https://klemet.github.io/Calibration_PnET_DIVERSE/build/root-IB5726YR.js";
import * as route1 from "https://klemet.github.io/Calibration_PnET_DIVERSE/build/routes/$-LXLHKVOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("https://klemet.github.io/Calibration_PnET_DIVERSE/build/entry.client-UNPC4GT3.js");</script></body></html>