<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Setting up the calibration landscape (ecoregions, initial communities, climate etc.) - Calibration of PnET Succession for the DIVERSE project</title><meta property="og:title" content="Setting up the calibration landscape (ecoregions, initial communities, climate etc.) - Calibration of PnET Succession for the DIVERSE project"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="https://klemet.github.io/Calibration_PnET_DIVERSE/build/88c4f87a42ed43465897c61d30462b63.png"/><meta property="og:image" content="https://klemet.github.io/Calibration_PnET_DIVERSE/build/88c4f87a42ed43465897c61d30462b63.png"/><link rel="stylesheet" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="https://klemet.github.io/Calibration_PnET_DIVERSE/favicon.ico"/><link rel="stylesheet" href="https://klemet.github.io/Calibration_PnET_DIVERSE/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="https://klemet.github.io/Calibration_PnET_DIVERSE/"><div class="p-1 mr-3 dark:bg-white dark:rounded"><img src="https://klemet.github.io/Calibration_PnET_DIVERSE/build/DIVERSE_PnET_Calibra-5bdc855d1747cacb3d11076efd7a4094.png" class="h-9" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="Calibration of PnET Succession for the DIVERSE project" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="https://klemet.github.io/Calibration_PnET_DIVERSE/">Calibration of PnET Succession for the DIVERSE project</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Calibration test" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="https://klemet.github.io/Calibration_PnET_DIVERSE/startingcalibrationtest/intro-calibrationtest">Calibration test</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap"><main class="article-grid subgrid-gap col-screen"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://github.com/Klemet/Calibration_PnET_DIVERSE" title="GitHub Repository: Klemet/Calibration_PnET_DIVERSE" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><a href="https://github.com/Klemet/Calibration_PnET_DIVERSE/blob/main/calibrationJupyterBook_JupyterBookv2/StartingCalibrationTest/4.Setting_up_calibration_Landscape.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Setting up the calibration landscape (ecoregions, initial communities, climate etc.)</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78top:" data-state="closed">Clément Hardy, PhD.</button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="TBLlF4V9TI" class="relative group/block"><p>Now that we have initial parameters for our species, we need to define the landscape in which the calibration will take place.</p><p>To adapt to the Python functions I’ve made for these Jupyter Notebooks (see <a target="_blank" rel="noreferrer" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/functionsForCalibrat-a190472a056d25729f0d91b00d14f170.py" class="">here</a>), simulations will take place on a single cell.</p><p>What we need is :</p><ul><li>The climate file</li><li>The ecoregion file and PnET ecoregion parameters</li><li>Initial communities files</li></ul></div><div id="BIi5gloYsD" class="relative group/block"><h2 id="the-climate-file" class="relative group"><span class="heading-text">The climate file</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#the-climate-file" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="jOduuOEtp5" class="relative group/block"><p>See <a target="_blank" rel="noreferrer" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/Gustafson2024PnETUse-7c7e00ce7aeac2200bc2ccf640766abf.pdf" class="">Gustafson and Miranda (2023)</a> for detailed information about what the climate file used in PnET simulations must contain.</p><p><a target="_blank" rel="noreferrer" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/Gustafson2024PnETUse-7c7e00ce7aeac2200bc2ccf640766abf.pdf" class="">Gustafson and Miranda (2023)</a> recommends using a constant climate for calibrating (p. 69). Gustafson also recommends using an “ideal” climate at some points, but deciding what is an ideal climate for a given species is a difficult proposition. As we are going to compare the growth curves generated by PnET Succession with the growth curves estimated from data of the National Forest Inventory (NFI) of Canada (see <a class="" href="https://klemet.github.io/Calibration_PnET_DIVERSE/startingcalibrationtest/other-important-data-before-starting">Other data needed for the calibration process</a>), the idea will be rather to get long-term monthly averages (as recommanded by <a target="_blank" rel="noreferrer" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/Gustafson2024PnETUse-7c7e00ce7aeac2200bc2ccf640766abf.pdf" class="">Gustafson and Miranda (2023)</a> p. 73) <strong>in the region of the FVS variant that we are going to use</strong> (or, if something else than FVS is used, long-term averages for the region where the empirical data comes from).</p><p>We have 5 variables that we need to gather :</p><ul><li>Maximum Monthly temperature (°C)</li><li>Minimum Monthly temperature (°C)</li><li>Photosynthetically Active Radiation (umol/m2/s)</li><li>Sum of precipitations during the month (mm)</li><li>Mean monthly atmospheric CO2 concentration (ppm)</li></ul></div><div id="qnOJnTuEm9" class="relative group/block"><h3 id="climate-data-location-for-the-calibration" class="relative group"><span class="heading-text">Climate data location for the calibration</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#climate-data-location-for-the-calibration" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="s72OA5YN01" class="relative group/block"><p>Since we’re doing calibration simulation here, we don’t have a particular place where our simulation take place. It’s up to us to choose where the climate data comes from, and there is not a “best” way to do things.</p><p>It’s surely most likely better to use climate conditions that are closer to the average of the conditions we want to simulate in other LANDIS-II simulation rather than to extremes (especially for this first step of calibration). We also want to make sure that the location we use ca be inputted in FVSon.</p><p>I propose that we use an area near the border between the boral and temperate forest, and near the center of Ontario. It will be arbitrary.</p><p>Here is a map from of the forests of Ontario from the 2016 forest report of Ontario :</p><img id="ZJzXTTtR04" style="margin:0 auto" src="https://klemet.github.io/Calibration_PnET_DIVERSE/build/88c4f87a42ed43465897c61d30462b63.png" data-canonical-url="https://files.ontario.ca/1a-forestregion-map_e_1.png" class=""/><p>The city of <a target="_blank" rel="noreferrer" href="https://www.openstreetmap.org/#map=12/47.8416/-83.4106" class="">Chapleau</a> seems to be located near the limit between the boreal and temperate forest. I created a simple shapefile polygon around the city that will serve to clip the climate data we want. See the next cell for a map.</p></div><div id="Ou7KKwj1w9" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><details class="myst-dropdown rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="myst-dropdown-header m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="myst-dropdown-header-title text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-dropdown-header-icon inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Source</span></summary><div class="myst-dropdown-body px-4 py-1 details-body"><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Displays a map where the shapefile that defines the boundaries of the climate data we wanna use is
import geopandas as gpd
import folium
from folium.features import GeoJsonPopup, GeoJsonTooltip

# Load the shapefile
# Replace &#x27;path_to_shapefile.shp&#x27; with your actual shapefile path
gdf = gpd.read_file(&quot;./ReferencesAndData/SpatialBoundaries/ChapleauBoundariesClimate.shp&quot;)

# Check the CRS (Coordinate Reference System) of the shapefile
# If not in WGS84 (EPSG:4326), reproject it
if gdf.crs != &#x27;EPSG:4326&#x27;:
    gdf = gdf.to_crs(&#x27;EPSG:4326&#x27;)

# Create a map centered on the mean of the shapefile bounds
center_lat = gdf.unary_union.centroid.y
center_lon = gdf.unary_union.centroid.x
m = folium.Map(location=[center_lat, center_lon], zoom_start=10)

# Add the GeoJSON data to the map with some styling
folium.GeoJson(
    gdf,
    name=&#x27;Polygons&#x27;,
    style_function=lambda x: {
        &#x27;fillColor&#x27;: &#x27;#ebcb8b&#x27;,
        &#x27;color&#x27;: &#x27;#2e3440&#x27;,
        &#x27;weight&#x27;: 1,
        &#x27;fillOpacity&#x27;: 0.4
    }
).add_to(m)

# Add layer control
folium.LayerControl().add_to(m)

# Alternatively, you can use this simpler approach which works in newer versions of JupyterLab
display(m)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div></div></details><div data-mdast-node-id="ipvdJVUh8u0h3ymf-LnTK" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="CzipRYVSS0" class="relative group/block"><h3 id="climate-data-source-for-temperature-precipitation-and-solar-radiation" class="relative group"><span class="heading-text">Climate data source for 🌡️ temperature, 🌧️ precipitation and ☀ solar radiation</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#climate-data-source-for-temperature-precipitation-and-solar-radiation" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="C4ZHeww7tU" class="relative group/block"><h4 id="choosing-the-right-source-going-with-esgf-data" class="relative group"><span class="heading-text">Choosing the right source - going with ESGF data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#choosing-the-right-source-going-with-esgf-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>There are many potential sources of climate data. I’ve had to juggle with many of them before finding something that fitted our objective here, but also looking more at the long term of the DIVERSE project.</p><p>I first wanted to use data from Climate Canada, as they produce outputs of several Global Climate models from CMIP6 at a very small resolution (downscaled), and accessible through the OpenDAP protocol (which allow us to only download the chunks of the data we need). However, their model lacked some of the variables needed for PnET-Succession, especially the solar radiation. This required to use statistical models to predict this variable based on other datasets, which was really not ideal. In addition, their data was monthly, and we were going to require daily data to accomodate some LANDIS-II extensions we were going to use with PnET-Succession further down the road (e.g. BFOLDS Fire).</p><p>I then went on to use data from the ESGF (Earth System Grid Federation); first manually from their “<a target="_blank" rel="noreferrer" href="https://esgf.github.io/nodes.html" class="">Metagrid</a>” online interface, and then via scripts using their <a target="_blank" rel="noreferrer" href="https://github.com/esgf2-us/intake-esgf" class="">intake-esgf</a> python package. This allowed us to access outputs from a very large array of GCMs, different variables, etc, at a daily scale, and with the OpenDAP protocol. However, the gridded data here is 100 x 100km of resolution, which is pretty coarse.</p><p>I will keep on going with this data from the ESGF in this notebook, so that it is easily re-usable for research teams in other parts of the world (since data from the ESGF covers all of the world). However, for the DIVERSE project, we will most likely use the BioSIM canadian model to downscale climate data, and specially get different climate data for areas with a slope/aspect that can affect local temperature and solar radiation that is received by trees.</p><h4 id="climate-model-that-we-are-using-here" class="relative group"><span class="heading-text">Climate model that we are using here</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#climate-model-that-we-are-using-here" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>There are many Global Climate Models (GCMs), and it’s sometimes difficult to choose the right one. Here, I’ve choosen to go with TaiESM1, which was the closest to the median accross models from CMIP6 for the temperature and precipitations for our first tests with the CanDCS-M6 dataset (see above). According to the litterature, TaiESM1 also seems to have a pretty good performance overall when compared in GCM ensembles (see <cite class="" data-state="closed"><a href="https://doi.org/10.1029/2020ms002353" target="_blank" rel="noreferrer" class="hover-link">here</a></cite>). TaiESM1 also have a lot of data for different SSPs scenarios on the ESGF data repositories, which will be useful for the later steps of the calibration, but also for the DIVERSE project.</p></div><div id="mjFQW1ea27" class="relative group/block"><aside class="myst-admonition myst-admonition-tip my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-green-600"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Why we are using a single climate model (instead of several together) here</div></div><div class="myst-admonition-body px-4 py-1"><p>Climate scientists often recommand to use the results from several climate models (GCMs) at once so as to explore the influence of the variability in results that exists between models, and the incertainty that results from it.</p><p>Here, I choose to use the results from a single climate model for several reasons :</p><ul><li>The goal of this calibration is not to explore climate change predictions, but simply to calibrate the growth and dynamic of our tree species. For that, we will use historical data simulated by the model we chose (TaiESM1).</li><li>This calibration is already quite complex, and I’d like to keep it as simple as possible.</li><li>Using several models at once requires one of two things : either using a single climate file whose values are averaged along the values simulated by the different GCMs, which results in very, very “mild” climate conditions (since all extreme variations are not synchronized between models); or to use several climate files and create several PnET-Succession growth curves at each point (which makes things quite complicated).</li></ul><p>However, once you have calibrated PnET and will use it in your simulation, it might be good to generate different climate files based on different climate models in order to create “climate replicates” for your LANDIS-II simulation that will allow you to generate an envellope of variability/uncertainty on your LANDIS-II results. To that end, you can use the scripts of this page to generate several climate files for different climate models available in ESGF (be warned that not all models have all of the variables you will need for all of the climate scenario you will want to explore). You can also use the functions from the Xclim python package that will allow you to select a smaller number of models that will represent your climate data properly (see <a target="_blank" rel="noreferrer" href="https://xclim.readthedocs.io/en/stable/apidoc/xclim.ensembles.html#xclim.ensembles._reduce.kmeans_reduce_ensemble" class="">here</a>; you will need to create a large ensemble of climate data to use these functions).</p></div></aside></div><div id="t9ilzHIJvm" class="relative group/block"><h4 id="extraction-of-temperature-precipitation-and-solar-radiation-data-for-ontario-1950-2100-from-esgf" class="relative group"><span class="heading-text">Extraction of 🌡️ temperature, 🌧️ precipitation and ☀ solar radiation data for Ontario, 1950-2100 from <a target="_blank" rel="noreferrer" href="https://esgf.github.io/nodes.html" class="">ESGF</a></span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#extraction-of-temperature-precipitation-and-solar-radiation-data-for-ontario-1950-2100-from-esgf" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="vuC82ZCGI0" class="relative group/block"><p>The goal here is to extract the data for :</p><ul><li>The TaiESM1 model</li><li>4 variables (Tmax, Tmin, precip, PAR)</li><li>Historical range (1950-2100)</li><li>At a daily frequency</li><li>At a 100x100km resolution, but only inside our polygon (see above), and only for a single cell that is closest to the polygon centroid in the end (since we will only simulate one cell at a time during the calibration, we don’t need more than one climate stream for one ecoregion)</li></ul><p>We extract the raw variables first for each, who each have particular names for CMIP6 data like this one :</p><ul><li>tasmax = maximum daily temperature in kelvin</li><li>tasmin = minimum daily temperature in kelvin</li><li>prc = daily precipitations in kg m-2 s-1</li><li>rsds = average daily downwelling shortwave solar radiation in W/m2</li></ul><p>To be certain of these units, we can check the metadata/attributes of the objects manipulated during this script, or on the ESGF metagrid.</p><p>Other variables are available at a daily frequency that can be used for other LANDIS-II extensions if you need them. For example, the variables necessary for BFOLDS fire :</p><ul><li>hur, the relative humidty in percentage</li><li>ua, the eastward wind speed in m/s</li><li>va, the northward wind speed in m/s</li></ul><p>For other variables codes, see sites such as <a target="_blank" rel="noreferrer" href="https://pcmdi.llnl.gov/mips/cmip3/variableList.html" class="">this one</a>.</p></div><div id="hb0lNbnk5Q" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Here, we get the URLs to download the data we need through the OpenDAP protocol,
# by looking at the datasets available in the ESGF nodes
# WARNING : if you have a VPN on, this might result in error as nodes might refuse the connection.
# Simply disable the VPN and try again.

from functionsForCalibration import *
from intake_esgf import ESGFCatalog
import intake_esgf

# Initialize catalog
cat = ESGFCatalog()

# Search for the variables we need for TaiESM1, historical data, and daily frequency
# See cell above for infos about the variables
cat.search(
    experiment_id=&quot;historical&quot;,
    source_id=&quot;TaiESM1&quot;,
    frequency=&quot;day&quot;,
    # variable_id=[&quot;rsds&quot;, &quot;prc&quot;, &quot;tasmin&quot;, &quot;tasmax&quot;, &quot;hur&quot;, &quot;ua&quot;, &quot;va&quot;], # Variables for BFOLDS added
    variable_id=[&quot;rsds&quot;, &quot;prc&quot;, &quot;tasmin&quot;, &quot;tasmax&quot;]
)

# Making a dictionnary with the path to then access the data in xarray with OpenDAP,
# we can see that the function only return one single .nc file per dataset, for a single
# time period. The time period for each variable seems to be pretty random.
paths = cat.to_path_dict(prefer_streaming=True)
# print(paths)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="YVMUz0bNOft69G83BGJsw" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="xmJts2nMqw" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Now, we&#x27;re going to loop around the OpenDAP paths and extract the data for the years we want and in
# the polygon we defined earlier, thanks to a custom function.
# WARNING : you might get errors if there are paths in the &quot;paths&quot; object that we created just before that
# are not OpenDAP URL paths. It might happen since the to_path_dict function of intake_esgf is still experimental.
# If this happens, you need to clean the dictionnary to only have the OpenDAP URLs you need.
from functionsForCalibration import *

# We initialize the dictionnary that are going to fill
# A key = one variable. The value will be a dataframe filled with the data from the variable.
dictOfDataFrames = dict()

for variable in paths.keys():
    # Since the data is often fragmented accross several .nc files that correspond to different ranges of year
    # for the data, we need to first initialize a panda dataframe, and then add rows to it.
    # That&#x27;s what we do here.
    variableInitialized = False
    for path in paths[variable]:
        if not variableInitialized:
            dictOfDataFrames[variable] = GetDataFromESGFdataset(path,
                                            yearStart = 1950,
                                            yearStop = 2010,
                                            pathOfShapefileForSubsetting = &quot;./ReferencesAndData/SpatialBoundaries/ChapleauBoundariesClimate.shp&quot;,
                                            nameOfVariable = variable,
                                            verbose = False,
                                            enableWarnings = False)
            if not dictOfDataFrames[variable].empty:
                variableInitialized = True
        else:
            additionalData = GetDataFromESGFdataset(path,
                                            yearStart = 1950,
                                            yearStop = 2010,
                                            pathOfShapefileForSubsetting = &quot;./ReferencesAndData/SpatialBoundaries/ChapleauBoundariesClimate.shp&quot;,
                                            nameOfVariable = variable,
                                            verbose = False,
                                            enableWarnings = False)
            # The complex thing in pd.concat is used to deal with cases when GetDataFromESGFdataset returned an empty dataframe,
            # which happens when the .nc file didn&#x27;t corresponded to the years we wanted.
            dictOfDataFrames[variable] = pd.concat([dictOfDataFrames[variable], additionalData if not additionalData.empty else None], ignore_index=True)
        # We sort the values by day, because they might be out of order.
        dictOfDataFrames[variable] = dictOfDataFrames[variable].sort_values([&#x27;year&#x27;, &#x27;month&#x27;, &#x27;day&#x27;])
        # print(dictOfDataFrames[variable])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="VlODf_Bb4sg1tZGxZ_Vvt" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="db4qYa5SCh" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Now that we have the raw data accross several 100x100km grid cells for all variables necessary for PnET,
# we simply have to transform the measures if needed (e.g. PAR into umol/m2.s for the right radiation range instead of rsds which is W/m2)
# and then put everything in the right format for the LANDIS-II v8 climate library, and finally output things as .csv
# for latter use
import copy

##################################
# Restricting data to only one grid cell
# (since we will only simulate on cell in our monocultures)
##################################

# We get the unique coordinates in the dataframe
uniqueCoordinatesInDataFrames = extract_unique_coordinates(dictOfDataFrames[&quot;rsds&quot;])
# Then, we choose the cell that is closest to the centroid of our chapleau region we&#x27;ve been using
bestCoordinatePair = find_closest_coordinate_to_polygon_center(&quot;./ReferencesAndData/SpatialBoundaries/ChapleauBoundariesClimate.shp&quot;,
                                                                uniqueCoordinatesInDataFrames)
# Then, we remove all references to other coordinate pairs
# Extract the latitude and longitude from the target coordinate
target_lat, target_lon = bestCoordinatePair
dictOfDataFramesSubset = copy.deepcopy(dictOfDataFrames)
for variable in dictOfDataFramesSubset.keys():
    # Create a mask for rows matching the target coordinate
    mask = (dictOfDataFramesSubset[variable][&#x27;lat&#x27;] == target_lat) &amp; (dictOfDataFramesSubset[variable][&#x27;lon&#x27;] == target_lon)
    dictOfDataFramesSubset[variable] = dictOfDataFramesSubset[variable][mask]

# Now, we put all dataframes together in a single dataframe
mergedDataframe = pd.merge(dictOfDataFramesSubset[&quot;rsds&quot;], dictOfDataFramesSubset[&quot;prc&quot;], on = [&quot;lat&quot;, &quot;lon&quot;, &quot;year&quot;, &quot;month&quot;, &quot;day&quot;], how=&#x27;left&#x27;)
mergedDataframe = pd.merge(mergedDataframe, dictOfDataFramesSubset[&quot;tasmax&quot;], on = [&quot;lat&quot;, &quot;lon&quot;, &quot;year&quot;, &quot;month&quot;, &quot;day&quot;], how=&#x27;left&#x27;)
mergedDataframe = pd.merge(mergedDataframe, dictOfDataFramesSubset[&quot;tasmin&quot;], on = [&quot;lat&quot;, &quot;lon&quot;, &quot;year&quot;, &quot;month&quot;, &quot;day&quot;], how=&#x27;left&#x27;)

# WARNING : prc values are often 0. It&#x27;s because it&#x27;s daily precipitation data, it&#x27;s normal !
# print(mergedDataframe)

##################################
# Transforming units (important !)
# And also variable names, to fit what is needed for the
# LANDIS-II v8 climate library
##################################

# tasmin and tasmax are in kelvin. We put then in celcius.
mergedDataframe[&#x27;Tmin&#x27;] = mergedDataframe[&#x27;tasmin&#x27;].apply(kelvin_to_celsius)
mergedDataframe[&#x27;Tmax&#x27;] = mergedDataframe[&#x27;tasmax&#x27;].apply(kelvin_to_celsius)

# Precipitations are in kg m-2 s-1 (see ESGF metagrid metadata for validation : https://esgf.nci.org.au/search?project=CMIP6&amp;activeFacets=%7B%22nominal_resolution%22%3A%22100+km%22%2C%22frequency%22%3A%22day%22%2C%22experiment_id%22%3A%22historical%22%2C%22source_id%22%3A%22TaiESM1%22%2C%22variable_id%22%3A%22prc%22%7D)
# Transforming precipitations from their original unit - kg m-2 s-1 - into cm per day
mergedDataframe[&#x27;precip&#x27;] = mergedDataframe[&#x27;prc&#x27;]*8640 # Going from seconds to days (86400 seconds in a day) and from mm (kg m-2) into cm (/10)

# For solar radiation : we first need to transform it from daily average to daytime average.
# Daily is on 24h (includes night); daily is average from sunrise to sunset.
# The data pulled from ESGF is daily; it has been validated to me in an email exchange by 
# Gary Strand, data maintener of the dataset i used at first : http://doi.org/10.22033/ESGF/CMIP6.10071
# We do that through a function that will calculate daytime hours based on the day of the year and the latitude/longitude.
mergedDataframe[&quot;rsds_daytimeAverage&quot;] = [daylight_hour_average(row[&quot;rsds&quot;], row[&quot;lat&quot;], row[&quot;lon&quot;], row[&quot;year&quot;], row[&quot;month&quot;], row[&quot;day&quot;]) for index, row in mergedDataframe.iterrows()]

# Transforming downwelling shortwave radiation from W/m2 to umol.m2/s-1
# Based on the PnET User Guide&#x27;s instructions
# Downwelling shortwave radiation (rsds which we have here) is often refered as global solar radiation.
# See https://library.wmo.int/viewer/68695/?offset=3#page=298&amp;viewer=picture&amp;o=search&amp;n=0&amp;q=shortwave . But other references exist.
# So, Downwelling shortave radiation is for wavelengths of 0.2–4.0 μm; PAR is for 0.4–0.7 μm.
# As such, to convert our Downwelling Shortwave Radiation in W/m2 to PAR in umol.m2/s-1, 
# we must multiply it by 2.02 as indicated in the user guide of PnET Succession.
mergedDataframe[&#x27;PAR&#x27;] = mergedDataframe[&#x27;rsds&#x27;]*2.02 # Going from seconds to days (86400 seconds in a day)

# We remove the old columns
mergedDataframe.drop(&#x27;tasmin&#x27;, axis=1, inplace=True)
mergedDataframe.drop(&#x27;tasmax&#x27;, axis=1, inplace=True)
mergedDataframe.drop(&#x27;prc&#x27;, axis=1, inplace=True)
mergedDataframe.drop(&#x27;rsds&#x27;, axis=1, inplace=True)
mergedDataframe.drop(&#x27;rsds_daytimeAverage&#x27;, axis=1, inplace=True)

# We print the result
# print(mergedDataframe)

##################################
# Giving the dataframe the right columns
# for the LANDIS-II v8 climate library
##################################

# Create a unique identifier for each lat/lon pair
mergedDataframe[&#x27;lat_lon&#x27;] = mergedDataframe[&#x27;lat&#x27;].astype(str) + &#x27;_&#x27; + mergedDataframe[&#x27;lon&#x27;].astype(str)

# Melt the dataframe to convert variables into rows
melted_df = pd.melt(
    mergedDataframe, 
    id_vars=[&#x27;year&#x27;, &#x27;month&#x27;, &#x27;day&#x27;, &#x27;lat_lon&#x27;],
    value_vars=[&#x27;Tmin&#x27;, &#x27;Tmax&#x27;, &quot;PAR&quot;, &quot;precip&quot;],
    var_name=&#x27;Variable&#x27;,
    value_name=&#x27;value&#x27;
)

# Pivot the table to get lat_lon as columns (which can then be used as ecoregions)
result_df = melted_df.pivot_table(
    index=[&#x27;year&#x27;, &#x27;month&#x27;, &#x27;day&#x27;, &#x27;Variable&#x27;],
    columns=&#x27;lat_lon&#x27;,
    values=&#x27;value&#x27;
).reset_index()

# Convert the column index from MultiIndex to regular Index
result_df.columns.name = None
result_df = result_df.sort_values(by=[&#x27;Variable&#x27;, &#x27;year&#x27;, &#x27;month&#x27;, &#x27;day&#x27;])

# We replace the name of the column that has the lat_lon pairing into an 
# ecoregion name (the one used in our PnET one cell scenario, eco1)
result_df = result_df.rename(columns={result_df.columns[-1]: &#x27;eco1&#x27;})
# print(result_df)

# We print as .csv
result_df.to_csv(&quot;./ReferencesAndData/Climate Data/dataFrameClimate_historicalDaily.csv&quot;, sep=&#x27;,&#x27;, index=False, encoding=&#x27;utf-8&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="SEIexFiHMtLC7TWKoLAgq" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="QWj4J90XMO" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># We finish by averaging the values (which is recommanded by the PnET User to use in the first steps of the calibration,
# to have a very mild and stable climate with no extremes.
# As a result, we will still have a climate stream with daily data from 1950 to 2010,
# but every january 1st data for a given variable will the same, and will be the average of all january 1st in the original
# non-averaged data, etc.
from functionsForCalibration import *

dataFrameClimate_historicalDaily = pd.read_csv(&quot;./ReferencesAndData/Climate Data/dataFrameClimate_historicalDaily.csv&quot;)

dataFrameClimate_historicalAveraged = transform_to_historical_averages_vectorized(dataFrameClimate_historicalDaily)

# print(dataFrameClimate_historicalDaily)
# print(dataFrameClimate_historicalAveraged)

dataFrameClimate_historicalAveraged.to_csv(&quot;./ReferencesAndData/Climate Data/dataFrameClimate_historicalAveraged.csv&quot;, sep=&#x27;,&#x27;, index=False, encoding=&#x27;utf-8&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="bDsP1i1VMyJxID8Jpd_ly" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="UaKiZSIaZy" class="relative group/block"><h3 id="climate-source-for-co2-concentrations" class="relative group"><span class="heading-text">Climate source for ☁️ CO2 concentrations</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#climate-source-for-co2-concentrations" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="aDM7kMPELL" class="relative group/block"><p>PnET-Succession needs CO2 concentrations in the air to simulation vegetation dynamic. However, it doesn’t seem to be a variable that is generated by the GCMs of the CMIP6. It looks like it’s because CO2 concentration are often assumed homogeneous on earth since it’s a well-mixed gas, because it’s an intrant/restriction to the models rather than an output, etc.</p><p>Still, there are local variations around the atmosphere in CO2 concentrations (see <a target="_blank" rel="noreferrer" href="https://earthobservatory.nasa.gov/images/82142/global-patterns-of-carbon-dioxide" class="">here</a>). The differences are small, and it seems like global values can be used (see <a target="_blank" rel="noreferrer" href="https://earthobservatory.nasa.gov/blogs/earthmatters/2016/12/05/reader-question-does-co2-disperse-evenly-around-the-earth/" class="">here</a>). But I’m choosing here to try to get more nuanced data.</p></div><div id="CTHeXB8Y9E" class="relative group/block"><p>Data from <a target="_blank" rel="noreferrer" href="https://www.nature.com/articles/s41597-022-01196-7#Sec5" class="">https://<wbr/>www<wbr/>.nature<wbr/>.com<wbr/>/articles<wbr/>/s41597<wbr/>-022<wbr/>-01196<wbr/>-7<wbr/>#Sec5</a> seems very promising : available at <a target="_blank" rel="noreferrer" href="https://zenodo.org/records/5021361" class="">https://<wbr/>zenodo<wbr/>.org<wbr/>/records<wbr/>/5021361</a>, not too big, allows for local variations in CO2 concentration. Would need to script the download and treatment of the files here. Timestep is monthly, but we can downscale it to daily and still at least have some monthly variation. Goes to 2150, so perfect for our uses.</p></div><div id="D80Wqp4ury" class="relative group/block"><p>Justification for using the dataset :</p><ul><li>We know that this CO2 dataset does not come from the same GCM that generated our climate data, and there could be variability between the variability of climate variables in one dataset versus the climate variables in the models that generated these CO2 estimates at each given timestep.</li><li>However, We thought it better to use this dataset to approximate CO2 spatial and temporal variations in our simulations rather than using latitudinal or global averages.</li></ul></div><div id="PNArEyE9or" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># First, we download the CO2 data from https://zenodo.org/records/5021361 

from functionsForCalibration import *
import pandas as pd
import urllib.request
import subprocess
import os

# We use the zenodo_get library to download files from Zenodo very fast; other methods tend to be slow.
# See https://github.com/dvolgyes/zenodo_get . It is installed in the Docker image.
# WARNING : will take around 1.5GB of space for the data from 1950 to 2150 for a full climate scenario.

# We download the file with historical data
os.system(&quot;cd ReferencesAndData &amp;&amp; zenodo_get 5021361 -g CO2_1deg_month_1850-2013.nc&quot;)

# We can also download data for future conditions, like this :
# os.system(&quot;cd ReferencesAndData &amp;&amp; zenodo_get 5021361 -g CO2_SSP126_2015_2150.nc&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="MOceX4HKjdQbYABKBAiF4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Title: Global monthly distributions of atmospheric CO2 concentrations under the historical and future scenarios
Keywords: Atmospheric chemistry, Atmospheric dynamics, Climate and Earth system modelling
Publication date: 2021-06-23
DOI: 10.5281/zenodo.5021361
Total size: 1.0 GB

Link: https://zenodo.org/records/5021361/files/CO2_1deg_month_1850-2013.nc   size: 1.0 GB

Checksum is correct. (b11db6cc374ce23fd41b3b078cc8ebdd)
All files have been downloaded.
</span></code></pre></div><div class="font-mono text-sm whitespace-pre-wrap"><code><span>0</span></code></div></div></div><div id="WVNEWHpo4V" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from functionsForCalibration import *

historical_ds = xr.open_dataset(&quot;./ReferencesAndData/CO2_1deg_month_1850-2013.nc&quot;)
# future_ds = xr.open_dataset(&quot;./ReferencesAndData/CO2_SSP126_2015_2150.nc&quot;)

# Shapefile to select where we take our values; if several climate cells are in the shapefile,
# then the CO2 values in all cells will be averaged (see function process_co2_data)
shapefile = &quot;./ReferencesAndData/SpatialBoundaries/ChapleauBoundariesClimate.shp&quot;

# We load the dataframe
# We prepare the dataframe in a format that matches the older function I made
# When I was using monthly data and LANDIS-II v7.
# We load the file created previously
df_climate = pd.read_csv(&quot;./ReferencesAndData/Climate Data/dataFrameClimate_historicalDaily.csv&quot;)
# Convert to year month day to string
df_climate[&#x27;date_string&#x27;] = (df_climate[&#x27;year&#x27;].astype(str) + &#x27;-&#x27; + 
                     df_climate[&#x27;month&#x27;].astype(str) + &#x27;-&#x27; + 
                     df_climate[&#x27;day&#x27;].astype(str))
# Get unique dates
uniqueDates = df_climate[&#x27;date_string&#x27;].unique()
# Create the new dataframe
dfToFill = pd.DataFrame(columns=[&quot;year&quot;, &quot;month&quot;, &quot;day&quot;, &quot;Variable&quot;])
# Put the dates in
dfToFill[&quot;date_string&quot;] = uniqueDates
# extract the dates correctly
dfToFill[&#x27;year&#x27;] = dfToFill[&quot;date_string&quot;].str.split(&#x27;-&#x27;).str[0].astype(int)
dfToFill[&#x27;month&#x27;] = dfToFill[&quot;date_string&quot;].str.split(&#x27;-&#x27;).str[1].astype(int)
dfToFill[&#x27;day&#x27;] = dfToFill[&quot;date_string&quot;].str.split(&#x27;-&#x27;).str[2].astype(int)
# Add variable name
dfToFill[&quot;Variable&quot;] = [&quot;CO2&quot;] * len(dfToFill)
# Remove the date_string column
dfToFill.drop(&#x27;date_string&#x27;, axis=1, inplace=True)
df_climate.drop(&#x27;date_string&#x27;, axis=1, inplace=True)
# Now, the dataframe is ready to be filled with CO2 values with the old function !
# print(dfToFill)

dfToFill = process_co2_data(historical_ds, shapefile, dfToFill)

# Display the updated dataframe
print(dfToFill.head())
print(dfToFill.tail())</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_trqKJgitZQwt1X0ubBlR" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>No points found inside the polygon for historical data. Finding closest point...
Closest point to polygon centroid for historical data: Lon=-83.5, Lat=47.5
   year  month  day Variable  CO2_Concentration
0  1950      1    1      CO2         317.369324
1  1950      1    2      CO2         317.369324
2  1950      1    3      CO2         317.369324
3  1950      1    4      CO2         317.369324
4  1950      1    5      CO2         317.369324
       year  month  day Variable  CO2_Concentration
22260  2010     12   27      CO2         399.926788
22261  2010     12   28      CO2         399.926788
22262  2010     12   29      CO2         399.926788
22263  2010     12   30      CO2         399.926788
22264  2010     12   31      CO2         399.926788
</span></code></pre></div></div></div><div id="Hn1KBMgVn8" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Finally, we add this CO2 data to the previous data, and re-average it if needed

# First, we have to rename the CO2 column in the dataframe we just filled so that it corresponds to an ecoregion now
# (this is due to the difference in the climate library formats with LANDIS-II v8 and the old functions I was using before switching)
# The column name CO2_Concentration is created by the function process_co2_data
dfToFill = dfToFill.rename(columns={&#x27;CO2_Concentration&#x27;: &#x27;eco1&#x27;})

# We concatenate the dataframes
df_climate = pd.concat([df_climate, dfToFill], ignore_index=True)

# We check if needed
print(df_climate)

# We average
dataFrameClimate_historicalAveraged = transform_to_historical_averages_vectorized(df_climate)
# We save everything
dataFrameClimate_historicalAveraged.to_csv(&quot;./ReferencesAndData/Climate Data/dataFrameClimate_historicalAveraged.csv&quot;, sep=&#x27;,&#x27;, index=False, encoding=&#x27;utf-8&#x27;)

# Now that everything is done, we can remove the CO2 files downloaded
os.remove(&quot;./ReferencesAndData/CO2_1deg_month_1850-2013.nc&quot;)
# os.remove(&quot;./ReferencesAndData/CO2_SSP126_2015_2150.nc&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="lI82JkEF0Ycoia5m0r62Z" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>        year  month  day Variable        eco1
0       1950      1    1      PAR   37.535774
1       1950      1    2      PAR  108.757004
2       1950      1    3      PAR   72.965851
3       1950      1    4      PAR  110.865730
4       1950      1    5      PAR   92.960808
...      ...    ...  ...      ...         ...
155850  2010     12   27      CO2  399.926788
155851  2010     12   28      CO2  399.926788
155852  2010     12   29      CO2  399.926788
155853  2010     12   30      CO2  399.926788
155854  2010     12   31      CO2  399.926788

[155855 rows x 5 columns]
</span></code></pre></div></div></div><div id="eqI0R7832K" class="relative group/block"><h2 id="soils" class="relative group"><span class="heading-text">Soils</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#soils" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="dHKSclOpEt" class="relative group/block"><p>Gustafon recommands SILO (Silty Loam/Silt Loam) soil from the default PnET Succession SaxtonAndRawls file (<code>C:\Program Files\LANDIS-II-v7\extensions\Defaults\SaxtonAndRawlsParameters.txt</code>) as a soil that retains water well. This is because the first calibration step should use an “ideal soil” where water is well-retained so that lack of water (or watterlogging) does not influence growth at this calibration step.</p><p>We can use the SILO soil type easily by modifying the SoilType of <code>eco1</code> in the PnET One Cell Scenario that we will use (see <code>SimulationFiles/PnETGitHub_OneCellSim_v8/</code>). So, nothing more to do here.</p></div><div id="GhHav7G6YD" class="relative group/block"><h2 id="clues-for-future-data" class="relative group"><span class="heading-text">CLUES FOR FUTURE DATA</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#clues-for-future-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><ul><li>Alex Chubaty might have scripts to generate initial data in BC and Alberta, and even other provinces ?</li><li>Caren Dymonc for initial data in BC ?</li><li>Yan Boulanger : BioSIM climate data for small scale/downscaled climate data for PnET + BFOLDS ? Needed so that we can have PnET Climate input that change according to slope and topography in particular. Will need to create many smaller ecoregions that are combo of soils + climate “zones” in the area + classes of slopes/aspect. BioSIM might help in generating those things.</li></ul></div><div></div><section id="references" class="article-grid subgrid-gap col-screen"><div><header class="text-lg font-semibold text-stone-900 dark:text-white group">References<a class="no-underline text-inherit hover:text-inherit ml-2 select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#references" title="Link to References" aria-label="Link to References">¶</a></header></div><div class="pl-3 mb-8 text-xs text-stone-500 dark:text-stone-300"><ol><li class="break-words" id="cite-Wang_2021">Wang, Y., Hsu, H., Chen, C., Tseng, W., Hsu, P., Lin, C., Chen, Y., Jiang, L., Lee, Y., Liang, H., Chang, W., Lee, W., & Shiu, C. (2021). Performance of the Taiwan Earth System Model in Simulating Climate Variability Compared With Observations and CMIP6 Model Simulations. <i>Journal of Advances in Modeling Earth Systems</i>, <i>13</i>(7). <a target="_blank" rel="noreferrer" href="https://doi.org/10.1029/2020ms002353">10.1029/2020ms002353</a></li></ol></div></section><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="https://klemet.github.io/Calibration_PnET_DIVERSE/startingcalibrationtest/initial-species-parameters"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Calibration of PnET Succession for the DIVERSE project</div>Initial species parameters</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="https://klemet.github.io/Calibration_PnET_DIVERSE/startingcalibrationtest/other-important-data-before-starting"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">Calibration of PnET Succession for the DIVERSE project</div>Other data needed for the calibration process</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></main></article><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-JSE36H2O.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/root-IB5726YR.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/_shared/chunk-NBON2RSI.js"/><link rel="modulepreload" href="https://klemet.github.io/Calibration_PnET_DIVERSE/build/routes/$-LXLHKVOR.js"/><script>window.__remixContext = {"url":"/startingcalibrationtest/setting-up-calibration-landscape","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.5.1","options":{"logo":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/DIVERSE_PnET_Calibra-5bdc855d1747cacb3d11076efd7a4094.png","folders":true},"nav":[],"actions":[],"projects":[{"bibliography":["/calibrationFolder/calibrationJupyterBook_JupyterBookv2/references.bib"],"exports":[],"title":"Calibration of PnET Succession for the DIVERSE project","authors":[{"nameParsed":{"literal":"Clément Hardy, PhD.","given":"PhD.","family":"Clément Hardy"},"name":"Clément Hardy, PhD.","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/Klemet/Calibration_PnET_DIVERSE","toc":[{"file":"intro.md"},{"children":[{"file":"StartingCalibrationTest/1.Loading_functions.ipynb"},{"file":"StartingCalibrationTest/2.Test_sim_functions.ipynb"},{"file":"StartingCalibrationTest/3.Initial_Species_Parameters.ipynb"},{"file":"StartingCalibrationTest/4.Setting_up_calibration_Landscape.ipynb"},{"file":"StartingCalibrationTest/5.Other_important_data_before_starting.ipynb"},{"file":"StartingCalibrationTest/6.Monoculture_ideal_conditions.ipynb"}],"file":"StartingCalibrationTest/Intro_CalibrationTest.ipynb"}],"index":"index","pages":[{"slug":"startingcalibrationtest.intro-calibrationtest","title":"Calibration test","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"startingcalibrationtest.loading-functions","title":"Loading functions and packages","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.test-sim-functions","title":"Making a test simulation to get used to the functions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.initial-species-parameters","title":"Initial species parameters","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.setting-up-calibration-landscape","title":"Setting up the calibration landscape (ecoregions, initial communities, climate etc.)","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/88c4f87a42ed43465897c61d30462b63.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.other-important-data-before-starting","title":"Other data needed for the calibration process","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/Algorithm_GrowthCurv-1fc0881c4e6f16c0991a3c4f2866d3c5.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.monoculture-ideal-conditions","title":"Phase 1 🌳 : Calibration of species in optimal conditions (monoculture + mesic soil + average and unchanging climate)","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/14232857c4e474f60fe4aad7bf85497d.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"https://klemet.github.io/Calibration_PnET_DIVERSE"},"routes/$":{"config":{"version":2,"myst":"1.5.1","options":{"logo":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/DIVERSE_PnET_Calibra-5bdc855d1747cacb3d11076efd7a4094.png","folders":true},"nav":[],"actions":[],"projects":[{"bibliography":["/calibrationFolder/calibrationJupyterBook_JupyterBookv2/references.bib"],"exports":[],"title":"Calibration of PnET Succession for the DIVERSE project","authors":[{"nameParsed":{"literal":"Clément Hardy, PhD.","given":"PhD.","family":"Clément Hardy"},"name":"Clément Hardy, PhD.","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/Klemet/Calibration_PnET_DIVERSE","toc":[{"file":"intro.md"},{"children":[{"file":"StartingCalibrationTest/1.Loading_functions.ipynb"},{"file":"StartingCalibrationTest/2.Test_sim_functions.ipynb"},{"file":"StartingCalibrationTest/3.Initial_Species_Parameters.ipynb"},{"file":"StartingCalibrationTest/4.Setting_up_calibration_Landscape.ipynb"},{"file":"StartingCalibrationTest/5.Other_important_data_before_starting.ipynb"},{"file":"StartingCalibrationTest/6.Monoculture_ideal_conditions.ipynb"}],"file":"StartingCalibrationTest/Intro_CalibrationTest.ipynb"}],"index":"index","pages":[{"slug":"startingcalibrationtest.intro-calibrationtest","title":"Calibration test","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"startingcalibrationtest.loading-functions","title":"Loading functions and packages","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.test-sim-functions","title":"Making a test simulation to get used to the functions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.initial-species-parameters","title":"Initial species parameters","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.setting-up-calibration-landscape","title":"Setting up the calibration landscape (ecoregions, initial communities, climate etc.)","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/88c4f87a42ed43465897c61d30462b63.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.other-important-data-before-starting","title":"Other data needed for the calibration process","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/Algorithm_GrowthCurv-1fc0881c4e6f16c0991a3c4f2866d3c5.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.monoculture-ideal-conditions","title":"Phase 1 🌳 : Calibration of species in optimal conditions (monoculture + mesic soil + average and unchanging climate)","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/14232857c4e474f60fe4aad7bf85497d.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":2,"kind":"Notebook","sha256":"3d366d850c5149f6420c6637baf99a8881bd9e093ed3d6eef1ea77e084411056","slug":"startingcalibrationtest.setting-up-calibration-landscape","location":"/StartingCalibrationTest/4.Setting_up_calibration_Landscape.ipynb","dependencies":[],"frontmatter":{"title":"Setting up the calibration landscape (ecoregions, initial communities, climate etc.)","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Clément Hardy, PhD.","given":"PhD.","family":"Clément Hardy"},"name":"Clément Hardy, PhD.","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/Klemet/Calibration_PnET_DIVERSE","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/Klemet/Calibration_PnET_DIVERSE/blob/main/calibrationJupyterBook_JupyterBookv2/StartingCalibrationTest/4.Setting_up_calibration_Landscape.ipynb","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/88c4f87a42ed43465897c61d30462b63.png","exports":[{"format":"ipynb","filename":"4.Setting_up_calibration_Landscape.ipynb","url":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/4.Setting_up_calibra-47a3a532c0e61bf128221ca357b87a8b.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now that we have initial parameters for our species, we need to define the landscape in which the calibration will take place.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YADIa4aiqE"}],"key":"mR3bJny3EA"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To adapt to the Python functions I’ve made for these Jupyter Notebooks (see ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NeGEgZmQty"},{"type":"link","url":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/functionsForCalibrat-a190472a056d25729f0d91b00d14f170.py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ldTkQ2mrNo"}],"urlSource":"./functionsForCalibration.py","static":true,"protocol":"file","key":"S8B8xGfuv4"},{"type":"text","value":"), simulations will take place on a single cell.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mGk2MKLRrx"}],"key":"Dk0FjfSCWj"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"What we need is :","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uaGy1dsU4M"}],"key":"Sl6P8svsra"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The climate file","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mZXQb5t2bQ"}],"key":"diwFNTvq4h"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"The ecoregion file and PnET ecoregion parameters","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"uDN6XFccFs"}],"key":"ts4744wxn1"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Initial communities files","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"WcjEoc4D4a"}],"key":"A1dmjQM1aa"}],"key":"N5wDXRgE1Y"}],"visibility":"show","key":"TBLlF4V9TI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The climate file","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q5eAe0Dp94"}],"identifier":"the-climate-file","label":"The climate file","html_id":"the-climate-file","implicit":true,"key":"ddfU5z3FCF"}],"key":"BIi5gloYsD"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"See ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"w85XFReJOn"},{"type":"link","url":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/Gustafson2024PnETUse-7c7e00ce7aeac2200bc2ccf640766abf.pdf","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Gustafson and Miranda (2023)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"godkzvvhh3"}],"urlSource":"./ReferencesAndData/Documentation/Gustafson2024PnETUserGuide.pdf","static":true,"protocol":"file","key":"s5Ok1CKuQM"},{"type":"text","value":" for detailed information about what the climate file used in PnET simulations must contain.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"e4PVrsafE5"}],"key":"tq5b2mFdwx"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"link","url":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/Gustafson2024PnETUse-7c7e00ce7aeac2200bc2ccf640766abf.pdf","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Gustafson and Miranda (2023)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JLeuiD8end"}],"urlSource":"./ReferencesAndData/Documentation/Gustafson2024PnETUserGuide.pdf","static":true,"protocol":"file","key":"hGEiObLwhX"},{"type":"text","value":" recommends using a constant climate for calibrating (p. 69). Gustafson also recommends using an “ideal” climate at some points, but deciding what is an ideal climate for a given species is a difficult proposition. As we are going to compare the growth curves generated by PnET Succession with the growth curves estimated from data of the National Forest Inventory (NFI) of Canada (see ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TspIDe4UD2"},{"type":"link","url":"/startingcalibrationtest/other-important-data-before-starting","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Other data needed for the calibration process","key":"fph8xDG38z"}],"urlSource":"./5.Other_important_data_before_starting.ipynb","dataUrl":"/startingcalibrationtest.other-important-data-before-starting.json","internal":true,"protocol":"file","key":"PhDtp8wpPi"},{"type":"text","value":"), the idea will be rather to get long-term monthly averages (as recommanded by ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EOSKuuCH6K"},{"type":"link","url":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/Gustafson2024PnETUse-7c7e00ce7aeac2200bc2ccf640766abf.pdf","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Gustafson and Miranda (2023)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Osmy0kWIHn"}],"urlSource":"./ReferencesAndData/Documentation/Gustafson2024PnETUserGuide.pdf","static":true,"protocol":"file","key":"Kfnavubbj6"},{"type":"text","value":" p. 73) ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LsRKQo9jQt"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"in the region of the FVS variant that we are going to use","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Zr74YyY27I"}],"key":"UIsr1idiVg"},{"type":"text","value":" (or, if something else than FVS is used, long-term averages for the region where the empirical data comes from).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VJs8jjXWkI"}],"key":"wlOUMn0ILr"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We have 5 variables that we need to gather :","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KrRgkbCNJ5"}],"key":"o7qiEvQCls"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Maximum Monthly temperature (°C)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FeJIWrKE8y"}],"key":"UlgIdavfdZ"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Minimum Monthly temperature (°C)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"gsqTzu9Cju"}],"key":"FsbAhoEXvw"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Photosynthetically Active Radiation (umol/m2/s)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"XF1ErDkPQm"}],"key":"LcWyztlhhK"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Sum of precipitations during the month (mm)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"zJCGg1kUlo"}],"key":"tq1Cmzh0VU"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Mean monthly atmospheric CO2 concentration (ppm)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Yq8XcQSctE"}],"key":"pbsp5HD5lv"}],"key":"gAK8kA2IgH"}],"key":"jOduuOEtp5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Climate data location for the calibration","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"al28nUcNr6"}],"identifier":"climate-data-location-for-the-calibration","label":"Climate data location for the calibration","html_id":"climate-data-location-for-the-calibration","implicit":true,"key":"HeP8v38aXw"}],"key":"qnOJnTuEm9"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Since we’re doing calibration simulation here, we don’t have a particular place where our simulation take place. It’s up to us to choose where the climate data comes from, and there is not a “best” way to do things.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A6G52EEn72"}],"key":"p0SM26Toi2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"It’s surely most likely better to use climate conditions that are closer to the average of the conditions we want to simulate in other LANDIS-II simulation rather than to extremes (especially for this first step of calibration). We also want to make sure that the location we use ca be inputted in FVSon.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kamXI0Va21"}],"key":"tz2Pcz0GHK"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"I propose that we use an area near the border between the boral and temperate forest, and near the center of Ontario. It will be arbitrary.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FduVRGicM9"}],"key":"Ufl5iWdjXC"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Here is a map from of the forests of Ontario from the 2016 forest report of Ontario :","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VF149IsFpZ"}],"key":"A2kVwxeFnU"},{"type":"image","url":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/88c4f87a42ed43465897c61d30462b63.png","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ZJzXTTtR04","urlSource":"https://files.ontario.ca/1a-forestregion-map_e_1.png"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The city of ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"yvzVKqsJFH"},{"type":"link","url":"https://www.openstreetmap.org/#map=12/47.8416/-83.4106","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Chapleau","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"SE4XTvbNkW"}],"urlSource":"https://www.openstreetmap.org/#map=12/47.8416/-83.4106","key":"aUr9o64ZAE"},{"type":"text","value":" seems to be located near the limit between the boreal and temperate forest. I created a simple shapefile polygon around the city that will serve to clip the climate data we want. See the next cell for a map.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"OJSTHc64hI"}],"key":"kKsvgckkPq"}],"visibility":"show","key":"s72OA5YN01"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":["hide_input"]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Displays a map where the shapefile that defines the boundaries of the climate data we wanna use is\nimport geopandas as gpd\nimport folium\nfrom folium.features import GeoJsonPopup, GeoJsonTooltip\n\n# Load the shapefile\n# Replace 'path_to_shapefile.shp' with your actual shapefile path\ngdf = gpd.read_file(\"./ReferencesAndData/SpatialBoundaries/ChapleauBoundariesClimate.shp\")\n\n# Check the CRS (Coordinate Reference System) of the shapefile\n# If not in WGS84 (EPSG:4326), reproject it\nif gdf.crs != 'EPSG:4326':\n    gdf = gdf.to_crs('EPSG:4326')\n\n# Create a map centered on the mean of the shapefile bounds\ncenter_lat = gdf.unary_union.centroid.y\ncenter_lon = gdf.unary_union.centroid.x\nm = folium.Map(location=[center_lat, center_lon], zoom_start=10)\n\n# Add the GeoJSON data to the map with some styling\nfolium.GeoJson(\n    gdf,\n    name='Polygons',\n    style_function=lambda x: {\n        'fillColor': '#ebcb8b',\n        'color': '#2e3440',\n        'weight': 1,\n        'fillOpacity': 0.4\n    }\n).add_to(m)\n\n# Add layer control\nfolium.LayerControl().add_to(m)\n\n# Alternatively, you can use this simpler approach which works in newer versions of JupyterLab\ndisplay(m)","visibility":"hide","key":"IEmAXmpsez"},{"type":"output","id":"ipvdJVUh8u0h3ymf-LnTK","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"\u003cdiv style=\"width:100%;\"\u003e\u003cdiv style=\"position:relative;width:100%;height:0;padding-bottom:60%;\"\u003e\u003cspan style=\"color:#565656\"\u003eMake this Notebook Trusted to load map: File -\u003e Trust Notebook\u003c/span\u003e\u003ciframe srcdoc=\"\u0026lt;!DOCTYPE html\u0026gt;\n\u0026lt;html\u0026gt;\n\u0026lt;head\u0026gt;\n    \n    \u0026lt;meta http-equiv=\u0026quot;content-type\u0026quot; content=\u0026quot;text/html; charset=UTF-8\u0026quot; /\u0026gt;\n    \n        \u0026lt;script\u0026gt;\n            L_NO_TOUCH = false;\n            L_DISABLE_3D = false;\n        \u0026lt;/script\u0026gt;\n    \n    \u0026lt;style\u0026gt;html, body {width: 100%;height: 100%;margin: 0;padding: 0;}\u0026lt;/style\u0026gt;\n    \u0026lt;style\u0026gt;#map {position:absolute;top:0;bottom:0;right:0;left:0;}\u0026lt;/style\u0026gt;\n    \u0026lt;script src=\u0026quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;\n    \u0026lt;script src=\u0026quot;https://code.jquery.com/jquery-3.7.1.min.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;\n    \u0026lt;script src=\u0026quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;\n    \u0026lt;script src=\u0026quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;\n    \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css\u0026quot;/\u0026gt;\n    \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css\u0026quot;/\u0026gt;\n    \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css\u0026quot;/\u0026gt;\n    \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css\u0026quot;/\u0026gt;\n    \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css\u0026quot;/\u0026gt;\n    \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css\u0026quot;/\u0026gt;\n    \n            \u0026lt;meta name=\u0026quot;viewport\u0026quot; content=\u0026quot;width=device-width,\n                initial-scale=1.0, maximum-scale=1.0, user-scalable=no\u0026quot; /\u0026gt;\n            \u0026lt;style\u0026gt;\n                #map_b93358a66b96a86acd1e316a37adee0f {\n                    position: relative;\n                    width: 100.0%;\n                    height: 100.0%;\n                    left: 0.0%;\n                    top: 0.0%;\n                }\n                .leaflet-container { font-size: 1rem; }\n            \u0026lt;/style\u0026gt;\n        \n\u0026lt;/head\u0026gt;\n\u0026lt;body\u0026gt;\n    \n    \n            \u0026lt;div class=\u0026quot;folium-map\u0026quot; id=\u0026quot;map_b93358a66b96a86acd1e316a37adee0f\u0026quot; \u0026gt;\u0026lt;/div\u0026gt;\n        \n\u0026lt;/body\u0026gt;\n\u0026lt;script\u0026gt;\n    \n    \n            var map_b93358a66b96a86acd1e316a37adee0f = L.map(\n                \u0026quot;map_b93358a66b96a86acd1e316a37adee0f\u0026quot;,\n                {\n                    center: [47.824934688075345, -83.36832547778936],\n                    crs: L.CRS.EPSG3857,\n                    ...{\n  \u0026quot;zoom\u0026quot;: 10,\n  \u0026quot;zoomControl\u0026quot;: true,\n  \u0026quot;preferCanvas\u0026quot;: false,\n}\n\n                }\n            );\n\n            \n\n        \n    \n            var tile_layer_2792db0de01d479094d79b1d42220a3f = L.tileLayer(\n                \u0026quot;https://tile.openstreetmap.org/{z}/{x}/{y}.png\u0026quot;,\n                {\n  \u0026quot;minZoom\u0026quot;: 0,\n  \u0026quot;maxZoom\u0026quot;: 19,\n  \u0026quot;maxNativeZoom\u0026quot;: 19,\n  \u0026quot;noWrap\u0026quot;: false,\n  \u0026quot;attribution\u0026quot;: \u0026quot;\\u0026copy; \\u003ca href=\\\u0026quot;https://www.openstreetmap.org/copyright\\\u0026quot;\\u003eOpenStreetMap\\u003c/a\\u003e contributors\u0026quot;,\n  \u0026quot;subdomains\u0026quot;: \u0026quot;abc\u0026quot;,\n  \u0026quot;detectRetina\u0026quot;: false,\n  \u0026quot;tms\u0026quot;: false,\n  \u0026quot;opacity\u0026quot;: 1,\n}\n\n            );\n        \n    \n            tile_layer_2792db0de01d479094d79b1d42220a3f.addTo(map_b93358a66b96a86acd1e316a37adee0f);\n        \n    \n        function geo_json_f7d9ce08bc740695be45fdb31bdf01e5_styler(feature) {\n            switch(feature.id) {\n                default:\n                    return {\u0026quot;color\u0026quot;: \u0026quot;#2e3440\u0026quot;, \u0026quot;fillColor\u0026quot;: \u0026quot;#ebcb8b\u0026quot;, \u0026quot;fillOpacity\u0026quot;: 0.4, \u0026quot;weight\u0026quot;: 1};\n            }\n        }\n\n        function geo_json_f7d9ce08bc740695be45fdb31bdf01e5_onEachFeature(feature, layer) {\n            layer.on({\n            });\n        };\n        var geo_json_f7d9ce08bc740695be45fdb31bdf01e5 = L.geoJson(null, {\n                onEachFeature: geo_json_f7d9ce08bc740695be45fdb31bdf01e5_onEachFeature,\n            \n                style: geo_json_f7d9ce08bc740695be45fdb31bdf01e5_styler,\n            ...{\n}\n        });\n\n        function geo_json_f7d9ce08bc740695be45fdb31bdf01e5_add (data) {\n            geo_json_f7d9ce08bc740695be45fdb31bdf01e5\n                .addData(data);\n        }\n            geo_json_f7d9ce08bc740695be45fdb31bdf01e5_add({\u0026quot;bbox\u0026quot;: [-83.51730371900837, 47.738566201858305, -83.21934723657034, 47.91130317429239], \u0026quot;features\u0026quot;: [{\u0026quot;bbox\u0026quot;: [-83.51730371900837, 47.738566201858305, -83.21934723657034, 47.91130317429239], \u0026quot;geometry\u0026quot;: {\u0026quot;coordinates\u0026quot;: [[[-83.51730371900837, 47.738566201858305], [-83.51730371900837, 47.91130317429239], [-83.21934723657034, 47.91130317429239], [-83.21934723657034, 47.738566201858305], [-83.51730371900837, 47.738566201858305]]], \u0026quot;type\u0026quot;: \u0026quot;Polygon\u0026quot;}, \u0026quot;id\u0026quot;: \u0026quot;0\u0026quot;, \u0026quot;properties\u0026quot;: {\u0026quot;AREA\u0026quot;: 0.051468100693455, \u0026quot;CNTX\u0026quot;: -83.36832547778936, \u0026quot;CNTY\u0026quot;: 47.824934688075345, \u0026quot;HEIGHT\u0026quot;: 0.172736972434087, \u0026quot;MAXX\u0026quot;: -83.21934723657034, \u0026quot;MAXY\u0026quot;: 47.91130317429239, \u0026quot;MINX\u0026quot;: -83.51730371900837, \u0026quot;MINY\u0026quot;: 47.738566201858305, \u0026quot;PERIM\u0026quot;: 0.941386909744224, \u0026quot;WIDTH\u0026quot;: 0.297956482438025}, \u0026quot;type\u0026quot;: \u0026quot;Feature\u0026quot;}], \u0026quot;type\u0026quot;: \u0026quot;FeatureCollection\u0026quot;});\n\n        \n    \n            geo_json_f7d9ce08bc740695be45fdb31bdf01e5.addTo(map_b93358a66b96a86acd1e316a37adee0f);\n        \n    \n            var layer_control_cb8fa9d8884d268f34f9b1196002686f_layers = {\n                base_layers : {\n                    \u0026quot;openstreetmap\u0026quot; : tile_layer_2792db0de01d479094d79b1d42220a3f,\n                },\n                overlays :  {\n                    \u0026quot;Polygons\u0026quot; : geo_json_f7d9ce08bc740695be45fdb31bdf01e5,\n                },\n            };\n            let layer_control_cb8fa9d8884d268f34f9b1196002686f = L.control.layers(\n                layer_control_cb8fa9d8884d268f34f9b1196002686f_layers.base_layers,\n                layer_control_cb8fa9d8884d268f34f9b1196002686f_layers.overlays,\n                {\n  \u0026quot;position\u0026quot;: \u0026quot;topright\u0026quot;,\n  \u0026quot;collapsed\u0026quot;: true,\n  \u0026quot;autoZIndex\u0026quot;: true,\n}\n            ).addTo(map_b93358a66b96a86acd1e316a37adee0f);\n\n        \n\u0026lt;/script\u0026gt;\n\u0026lt;/html\u0026gt;\" style=\"position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;\" allowfullscreen webkitallowfullscreen mozallowfullscreen\u003e\u003c/iframe\u003e\u003c/div\u003e\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"\u003cfolium.folium.Map at 0x7f153b782500\u003e","content_type":"text/plain"}}}],"visibility":"show","key":"ok1vBQWlqt"}],"visibility":"show","key":"Ou7KKwj1w9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Climate data source for 🌡️ temperature, 🌧️ precipitation and ☀ solar radiation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LcSUIbjzNj"}],"identifier":"climate-data-source-for-temperature-precipitation-and-solar-radiation","label":"Climate data source for 🌡️ temperature, 🌧️ precipitation and ☀ solar radiation","html_id":"climate-data-source-for-temperature-precipitation-and-solar-radiation","implicit":true,"key":"CmfeVwGYQy"}],"key":"CzipRYVSS0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Choosing the right source - going with ESGF data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YJDz8Ab3FO"}],"identifier":"choosing-the-right-source-going-with-esgf-data","label":"Choosing the right source - going with ESGF data","html_id":"choosing-the-right-source-going-with-esgf-data","implicit":true,"key":"Z0A8q4cHuC"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"There are many potential sources of climate data. I’ve had to juggle with many of them before finding something that fitted our objective here, but also looking more at the long term of the DIVERSE project.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zPW9SIciqx"}],"key":"zViByHftI9"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"I first wanted to use data from Climate Canada, as they produce outputs of several Global Climate models from CMIP6 at a very small resolution (downscaled), and accessible through the OpenDAP protocol (which allow us to only download the chunks of the data we need). However, their model lacked some of the variables needed for PnET-Succession, especially the solar radiation. This required to use statistical models to predict this variable based on other datasets, which was really not ideal. In addition, their data was monthly, and we were going to require daily data to accomodate some LANDIS-II extensions we were going to use with PnET-Succession further down the road (e.g. BFOLDS Fire).","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DIvZg1YNp7"}],"key":"l4xOn0uT23"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"I then went on to use data from the ESGF (Earth System Grid Federation); first manually from their “","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CnKhAjFEFl"},{"type":"link","url":"https://esgf.github.io/nodes.html","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Metagrid","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FJXutktde7"}],"urlSource":"https://esgf.github.io/nodes.html","key":"NSCWTM61ND"},{"type":"text","value":"” online interface, and then via scripts using their ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"taHdxp9yP7"},{"type":"link","url":"https://github.com/esgf2-us/intake-esgf","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"intake-esgf","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mERLF1mrll"}],"urlSource":"https://github.com/esgf2-us/intake-esgf","error":true,"key":"CI47XhqOZ0"},{"type":"text","value":" python package. This allowed us to access outputs from a very large array of GCMs, different variables, etc, at a daily scale, and with the OpenDAP protocol. However, the gridded data here is 100 x 100km of resolution, which is pretty coarse.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"gZK9fVSHQ3"}],"key":"F3CAQfu0mI"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"I will keep on going with this data from the ESGF in this notebook, so that it is easily re-usable for research teams in other parts of the world (since data from the ESGF covers all of the world). However, for the DIVERSE project, we will most likely use the BioSIM canadian model to downscale climate data, and specially get different climate data for areas with a slope/aspect that can affect local temperature and solar radiation that is received by trees.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"sCcKh0MBQe"}],"key":"Iu4wkkJtWC"},{"type":"heading","depth":4,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Climate model that we are using here","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"MFLSfZHpm9"}],"identifier":"climate-model-that-we-are-using-here","label":"Climate model that we are using here","html_id":"climate-model-that-we-are-using-here","implicit":true,"key":"IEGiviulGZ"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"There are many Global Climate Models (GCMs), and it’s sometimes difficult to choose the right one. Here, I’ve choosen to go with TaiESM1, which was the closest to the median accross models from CMIP6 for the temperature and precipitations for our first tests with the CanDCS-M6 dataset (see above). According to the litterature, TaiESM1 also seems to have a pretty good performance overall when compared in GCM ensembles (see ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"cDB8uSdX1c"},{"type":"cite","url":"https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2020MS002353","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"VYzzUvgz2M"}],"kind":"narrative","label":"Wang_2021","identifier":"https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2020MS002353","enumerator":"1","key":"l8vzT9Xi1p"},{"type":"text","value":"). TaiESM1 also have a lot of data for different SSPs scenarios on the ESGF data repositories, which will be useful for the later steps of the calibration, but also for the DIVERSE project.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"d2X81mCu7B"}],"key":"dXp2KVAMmr"}],"key":"C4ZHeww7tU"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Why we are using a single climate model (instead of several together) here","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p7mfU6GDMO"}],"key":"nhGUcR6a0Y"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Climate scientists often recommand to use the results from several climate models (GCMs) at once so as to explore the influence of the variability in results that exists between models, and the incertainty that results from it.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Dv9fR5pDLg"}],"key":"kQFRcSrBHV"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Here, I choose to use the results from a single climate model for several reasons :","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"wLccrWAvzk"}],"key":"zkJ3dCpwOV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The goal of this calibration is not to explore climate change predictions, but simply to calibrate the growth and dynamic of our tree species. For that, we will use historical data simulated by the model we chose (TaiESM1).","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"oaxjtkH9Co"}],"key":"QGv8ILkqYL"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"This calibration is already quite complex, and I’d like to keep it as simple as possible.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"znEPrZN0kk"}],"key":"catgA73KaJ"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Using several models at once requires one of two things : either using a single climate file whose values are averaged along the values simulated by the different GCMs, which results in very, very “mild” climate conditions (since all extreme variations are not synchronized between models); or to use several climate files and create several PnET-Succession growth curves at each point (which makes things quite complicated).","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"tZSlnmNrLe"}],"key":"tIO9zbG5Ua"}],"key":"b07WF3XVJY"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"However, once you have calibrated PnET and will use it in your simulation, it might be good to generate different climate files based on different climate models in order to create “climate replicates” for your LANDIS-II simulation that will allow you to generate an envellope of variability/uncertainty on your LANDIS-II results. To that end, you can use the scripts of this page to generate several climate files for different climate models available in ESGF (be warned that not all models have all of the variables you will need for all of the climate scenario you will want to explore). You can also use the functions from the Xclim python package that will allow you to select a smaller number of models that will represent your climate data properly (see ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Lgva0lJEUQ"},{"type":"link","url":"https://xclim.readthedocs.io/en/stable/apidoc/xclim.ensembles.html#xclim.ensembles._reduce.kmeans_reduce_ensemble","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"DnVvvVVHcR"}],"urlSource":"https://xclim.readthedocs.io/en/stable/apidoc/xclim.ensembles.html#xclim.ensembles._reduce.kmeans_reduce_ensemble","key":"ALhf9U7v53"},{"type":"text","value":"; you will need to create a large ensemble of climate data to use these functions).","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"erWQECUAXF"}],"key":"x2H09PRrhT"}],"key":"wHf5QOdeZd"}],"key":"mjFQW1ea27"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Extraction of 🌡️ temperature, 🌧️ precipitation and ☀ solar radiation data for Ontario, 1950-2100 from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JJzo229nYq"},{"type":"link","url":"https://esgf.github.io/nodes.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"ESGF","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"drN1YHEhBr"}],"urlSource":"https://esgf.github.io/nodes.html","key":"ieeP8f2BBN"}],"identifier":"extraction-of-temperature-precipitation-and-solar-radiation-data-for-ontario-1950-2100-from-esgf","label":"Extraction of 🌡️ temperature, 🌧️ precipitation and ☀ solar radiation data for Ontario, 1950-2100 from ESGF","html_id":"extraction-of-temperature-precipitation-and-solar-radiation-data-for-ontario-1950-2100-from-esgf","implicit":true,"key":"CNyJ184Ayl"}],"key":"t9ilzHIJvm"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The goal here is to extract the data for :","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fd7IAlt7EI"}],"key":"M8JoJTpUma"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The TaiESM1 model","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NFLTS9rKI9"}],"key":"zUBQt3imJ9"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"4 variables (Tmax, Tmin, precip, PAR)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"VrhbVi85wB"}],"key":"XVhqbV5Dtg"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Historical range (1950-2100)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mZ96LKcWNW"}],"key":"W8betSqmtm"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"At a daily frequency","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"SHZRlX11kE"}],"key":"YNRCg9UM3F"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"At a 100x100km resolution, but only inside our polygon (see above), and only for a single cell that is closest to the polygon centroid in the end (since we will only simulate one cell at a time during the calibration, we don’t need more than one climate stream for one ecoregion)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Kdi0qPzpJC"}],"key":"OMjZWxyDNG"}],"key":"kEe16cxZrG"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"We extract the raw variables first for each, who each have particular names for CMIP6 data like this one :","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Wvwgy2CbTQ"}],"key":"O3P1RbNcBy"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"tasmax = maximum daily temperature in kelvin","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"arwJQbb23f"}],"key":"R9AWXkECLR"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"tasmin = minimum daily temperature in kelvin","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"f91qqWlfcB"}],"key":"cuMvMfqQFc"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"prc = daily precipitations in kg m-2 s-1","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"L6LLlcujgH"}],"key":"xWlRlrzswJ"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"rsds = average daily downwelling shortwave solar radiation in W/m2","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"jOguUW6tYq"}],"key":"yLs5ZP8Rvw"}],"key":"XkJdOi7EGO"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"To be certain of these units, we can check the metadata/attributes of the objects manipulated during this script, or on the ESGF metagrid.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"LeHYNCqpp0"}],"key":"qc6dj2ssLO"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Other variables are available at a daily frequency that can be used for other LANDIS-II extensions if you need them. For example, the variables necessary for BFOLDS fire :","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"h8HeGHKQyY"}],"key":"AO59Bc4B57"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":19,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"hur, the relative humidty in percentage","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"xJmNUxD5Hm"}],"key":"YZo2RJr3YQ"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"ua, the eastward wind speed in m/s","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"X1rA28QOD9"}],"key":"X3c4GTYiQP"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"va, the northward wind speed in m/s","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"XBU4dYpoyl"}],"key":"csGl1r6PdV"}],"key":"yRpni4hox2"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"For other variables codes, see sites such as ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"bD4xwlVNOD"},{"type":"link","url":"https://pcmdi.llnl.gov/mips/cmip3/variableList.html","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"this one","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"fhWm2B0F9q"}],"urlSource":"https://pcmdi.llnl.gov/mips/cmip3/variableList.html","key":"wkKZiln4WT"},{"type":"text","value":".","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"ViaK6LXWFe"}],"key":"yApReOepVD"}],"key":"vuC82ZCGI0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Here, we get the URLs to download the data we need through the OpenDAP protocol,\n# by looking at the datasets available in the ESGF nodes\n# WARNING : if you have a VPN on, this might result in error as nodes might refuse the connection.\n# Simply disable the VPN and try again.\n\nfrom functionsForCalibration import *\nfrom intake_esgf import ESGFCatalog\nimport intake_esgf\n\n# Initialize catalog\ncat = ESGFCatalog()\n\n# Search for the variables we need for TaiESM1, historical data, and daily frequency\n# See cell above for infos about the variables\ncat.search(\n    experiment_id=\"historical\",\n    source_id=\"TaiESM1\",\n    frequency=\"day\",\n    # variable_id=[\"rsds\", \"prc\", \"tasmin\", \"tasmax\", \"hur\", \"ua\", \"va\"], # Variables for BFOLDS added\n    variable_id=[\"rsds\", \"prc\", \"tasmin\", \"tasmax\"]\n)\n\n# Making a dictionnary with the path to then access the data in xarray with OpenDAP,\n# we can see that the function only return one single .nc file per dataset, for a single\n# time period. The time period for each variable seems to be pretty random.\npaths = cat.to_path_dict(prefer_streaming=True)\n# print(paths)","key":"SXp06oFOC0"},{"type":"output","id":"YVMUz0bNOft69G83BGJsw","data":[{"output_type":"display_data","metadata":{},"data":{"application/vnd.jupyter.widget-view+json":{"content":"{\"model_id\":\"02afc94fcaed46e6907e874e755be25d\",\"version_major\":2,\"version_minor\":0}","content_type":"application/vnd.jupyter.widget-view+json"},"text/plain":{"content":"   Searching indices:   0%|          |0/2 [       ?index/s]","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"application/vnd.jupyter.widget-view+json":{"content":"{\"model_id\":\"63de39baf8674e55a02bae7b861c7517\",\"version_major\":2,\"version_minor\":0}","content_type":"application/vnd.jupyter.widget-view+json"},"text/plain":{"content":"Get file information:   0%|          |0/2 [       ?index/s]","content_type":"text/plain"}}}],"key":"SfwYHx03AT"}],"key":"hb0lNbnk5Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Now, we're going to loop around the OpenDAP paths and extract the data for the years we want and in\n# the polygon we defined earlier, thanks to a custom function.\n# WARNING : you might get errors if there are paths in the \"paths\" object that we created just before that\n# are not OpenDAP URL paths. It might happen since the to_path_dict function of intake_esgf is still experimental.\n# If this happens, you need to clean the dictionnary to only have the OpenDAP URLs you need.\nfrom functionsForCalibration import *\n\n# We initialize the dictionnary that are going to fill\n# A key = one variable. The value will be a dataframe filled with the data from the variable.\ndictOfDataFrames = dict()\n\nfor variable in paths.keys():\n    # Since the data is often fragmented accross several .nc files that correspond to different ranges of year\n    # for the data, we need to first initialize a panda dataframe, and then add rows to it.\n    # That's what we do here.\n    variableInitialized = False\n    for path in paths[variable]:\n        if not variableInitialized:\n            dictOfDataFrames[variable] = GetDataFromESGFdataset(path,\n                                            yearStart = 1950,\n                                            yearStop = 2010,\n                                            pathOfShapefileForSubsetting = \"./ReferencesAndData/SpatialBoundaries/ChapleauBoundariesClimate.shp\",\n                                            nameOfVariable = variable,\n                                            verbose = False,\n                                            enableWarnings = False)\n            if not dictOfDataFrames[variable].empty:\n                variableInitialized = True\n        else:\n            additionalData = GetDataFromESGFdataset(path,\n                                            yearStart = 1950,\n                                            yearStop = 2010,\n                                            pathOfShapefileForSubsetting = \"./ReferencesAndData/SpatialBoundaries/ChapleauBoundariesClimate.shp\",\n                                            nameOfVariable = variable,\n                                            verbose = False,\n                                            enableWarnings = False)\n            # The complex thing in pd.concat is used to deal with cases when GetDataFromESGFdataset returned an empty dataframe,\n            # which happens when the .nc file didn't corresponded to the years we wanted.\n            dictOfDataFrames[variable] = pd.concat([dictOfDataFrames[variable], additionalData if not additionalData.empty else None], ignore_index=True)\n        # We sort the values by day, because they might be out of order.\n        dictOfDataFrames[variable] = dictOfDataFrames[variable].sort_values(['year', 'month', 'day'])\n        # print(dictOfDataFrames[variable])","key":"ddfQ4ui8HT"},{"type":"output","id":"VlODf_Bb4sg1tZGxZ_Vvt","data":[],"key":"g0IfrmpQzU"}],"key":"xmJts2nMqw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Now that we have the raw data accross several 100x100km grid cells for all variables necessary for PnET,\n# we simply have to transform the measures if needed (e.g. PAR into umol/m2.s for the right radiation range instead of rsds which is W/m2)\n# and then put everything in the right format for the LANDIS-II v8 climate library, and finally output things as .csv\n# for latter use\nimport copy\n\n##################################\n# Restricting data to only one grid cell\n# (since we will only simulate on cell in our monocultures)\n##################################\n\n# We get the unique coordinates in the dataframe\nuniqueCoordinatesInDataFrames = extract_unique_coordinates(dictOfDataFrames[\"rsds\"])\n# Then, we choose the cell that is closest to the centroid of our chapleau region we've been using\nbestCoordinatePair = find_closest_coordinate_to_polygon_center(\"./ReferencesAndData/SpatialBoundaries/ChapleauBoundariesClimate.shp\",\n                                                                uniqueCoordinatesInDataFrames)\n# Then, we remove all references to other coordinate pairs\n# Extract the latitude and longitude from the target coordinate\ntarget_lat, target_lon = bestCoordinatePair\ndictOfDataFramesSubset = copy.deepcopy(dictOfDataFrames)\nfor variable in dictOfDataFramesSubset.keys():\n    # Create a mask for rows matching the target coordinate\n    mask = (dictOfDataFramesSubset[variable]['lat'] == target_lat) \u0026 (dictOfDataFramesSubset[variable]['lon'] == target_lon)\n    dictOfDataFramesSubset[variable] = dictOfDataFramesSubset[variable][mask]\n\n# Now, we put all dataframes together in a single dataframe\nmergedDataframe = pd.merge(dictOfDataFramesSubset[\"rsds\"], dictOfDataFramesSubset[\"prc\"], on = [\"lat\", \"lon\", \"year\", \"month\", \"day\"], how='left')\nmergedDataframe = pd.merge(mergedDataframe, dictOfDataFramesSubset[\"tasmax\"], on = [\"lat\", \"lon\", \"year\", \"month\", \"day\"], how='left')\nmergedDataframe = pd.merge(mergedDataframe, dictOfDataFramesSubset[\"tasmin\"], on = [\"lat\", \"lon\", \"year\", \"month\", \"day\"], how='left')\n\n# WARNING : prc values are often 0. It's because it's daily precipitation data, it's normal !\n# print(mergedDataframe)\n\n##################################\n# Transforming units (important !)\n# And also variable names, to fit what is needed for the\n# LANDIS-II v8 climate library\n##################################\n\n# tasmin and tasmax are in kelvin. We put then in celcius.\nmergedDataframe['Tmin'] = mergedDataframe['tasmin'].apply(kelvin_to_celsius)\nmergedDataframe['Tmax'] = mergedDataframe['tasmax'].apply(kelvin_to_celsius)\n\n# Precipitations are in kg m-2 s-1 (see ESGF metagrid metadata for validation : https://esgf.nci.org.au/search?project=CMIP6\u0026activeFacets=%7B%22nominal_resolution%22%3A%22100+km%22%2C%22frequency%22%3A%22day%22%2C%22experiment_id%22%3A%22historical%22%2C%22source_id%22%3A%22TaiESM1%22%2C%22variable_id%22%3A%22prc%22%7D)\n# Transforming precipitations from their original unit - kg m-2 s-1 - into cm per day\nmergedDataframe['precip'] = mergedDataframe['prc']*8640 # Going from seconds to days (86400 seconds in a day) and from mm (kg m-2) into cm (/10)\n\n# For solar radiation : we first need to transform it from daily average to daytime average.\n# Daily is on 24h (includes night); daily is average from sunrise to sunset.\n# The data pulled from ESGF is daily; it has been validated to me in an email exchange by \n# Gary Strand, data maintener of the dataset i used at first : http://doi.org/10.22033/ESGF/CMIP6.10071\n# We do that through a function that will calculate daytime hours based on the day of the year and the latitude/longitude.\nmergedDataframe[\"rsds_daytimeAverage\"] = [daylight_hour_average(row[\"rsds\"], row[\"lat\"], row[\"lon\"], row[\"year\"], row[\"month\"], row[\"day\"]) for index, row in mergedDataframe.iterrows()]\n\n# Transforming downwelling shortwave radiation from W/m2 to umol.m2/s-1\n# Based on the PnET User Guide's instructions\n# Downwelling shortwave radiation (rsds which we have here) is often refered as global solar radiation.\n# See https://library.wmo.int/viewer/68695/?offset=3#page=298\u0026viewer=picture\u0026o=search\u0026n=0\u0026q=shortwave . But other references exist.\n# So, Downwelling shortave radiation is for wavelengths of 0.2–4.0 μm; PAR is for 0.4–0.7 μm.\n# As such, to convert our Downwelling Shortwave Radiation in W/m2 to PAR in umol.m2/s-1, \n# we must multiply it by 2.02 as indicated in the user guide of PnET Succession.\nmergedDataframe['PAR'] = mergedDataframe['rsds']*2.02 # Going from seconds to days (86400 seconds in a day)\n\n# We remove the old columns\nmergedDataframe.drop('tasmin', axis=1, inplace=True)\nmergedDataframe.drop('tasmax', axis=1, inplace=True)\nmergedDataframe.drop('prc', axis=1, inplace=True)\nmergedDataframe.drop('rsds', axis=1, inplace=True)\nmergedDataframe.drop('rsds_daytimeAverage', axis=1, inplace=True)\n\n# We print the result\n# print(mergedDataframe)\n\n##################################\n# Giving the dataframe the right columns\n# for the LANDIS-II v8 climate library\n##################################\n\n# Create a unique identifier for each lat/lon pair\nmergedDataframe['lat_lon'] = mergedDataframe['lat'].astype(str) + '_' + mergedDataframe['lon'].astype(str)\n\n# Melt the dataframe to convert variables into rows\nmelted_df = pd.melt(\n    mergedDataframe, \n    id_vars=['year', 'month', 'day', 'lat_lon'],\n    value_vars=['Tmin', 'Tmax', \"PAR\", \"precip\"],\n    var_name='Variable',\n    value_name='value'\n)\n\n# Pivot the table to get lat_lon as columns (which can then be used as ecoregions)\nresult_df = melted_df.pivot_table(\n    index=['year', 'month', 'day', 'Variable'],\n    columns='lat_lon',\n    values='value'\n).reset_index()\n\n# Convert the column index from MultiIndex to regular Index\nresult_df.columns.name = None\nresult_df = result_df.sort_values(by=['Variable', 'year', 'month', 'day'])\n\n# We replace the name of the column that has the lat_lon pairing into an \n# ecoregion name (the one used in our PnET one cell scenario, eco1)\nresult_df = result_df.rename(columns={result_df.columns[-1]: 'eco1'})\n# print(result_df)\n\n# We print as .csv\nresult_df.to_csv(\"./ReferencesAndData/Climate Data/dataFrameClimate_historicalDaily.csv\", sep=',', index=False, encoding='utf-8')","key":"yd0Z7eBet9"},{"type":"output","id":"SEIexFiHMtLC7TWKoLAgq","data":[],"key":"Ptnpuoenv4"}],"key":"db4qYa5SCh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# We finish by averaging the values (which is recommanded by the PnET User to use in the first steps of the calibration,\n# to have a very mild and stable climate with no extremes.\n# As a result, we will still have a climate stream with daily data from 1950 to 2010,\n# but every january 1st data for a given variable will the same, and will be the average of all january 1st in the original\n# non-averaged data, etc.\nfrom functionsForCalibration import *\n\ndataFrameClimate_historicalDaily = pd.read_csv(\"./ReferencesAndData/Climate Data/dataFrameClimate_historicalDaily.csv\")\n\ndataFrameClimate_historicalAveraged = transform_to_historical_averages_vectorized(dataFrameClimate_historicalDaily)\n\n# print(dataFrameClimate_historicalDaily)\n# print(dataFrameClimate_historicalAveraged)\n\ndataFrameClimate_historicalAveraged.to_csv(\"./ReferencesAndData/Climate Data/dataFrameClimate_historicalAveraged.csv\", sep=',', index=False, encoding='utf-8')","key":"V1QfGRIFZq"},{"type":"output","id":"bDsP1i1VMyJxID8Jpd_ly","data":[],"key":"odh25WMqdC"}],"key":"QWj4J90XMO"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Climate source for ☁️ CO2 concentrations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"leASKH7BPr"}],"identifier":"climate-source-for-co2-concentrations","label":"Climate source for ☁️ CO2 concentrations","html_id":"climate-source-for-co2-concentrations","implicit":true,"key":"QTI55KfPBc"}],"key":"UaKiZSIaZy"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"PnET-Succession needs CO2 concentrations in the air to simulation vegetation dynamic. However, it doesn’t seem to be a variable that is generated by the GCMs of the CMIP6. It looks like it’s because CO2 concentration are often assumed homogeneous on earth since it’s a well-mixed gas, because it’s an intrant/restriction to the models rather than an output, etc.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bnQB3k3T4i"}],"key":"XswogKo613"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Still, there are local variations around the atmosphere in CO2 concentrations (see ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DO3krlyrgZ"},{"type":"link","url":"https://earthobservatory.nasa.gov/images/82142/global-patterns-of-carbon-dioxide","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"q1Pqo9gIEd"}],"urlSource":"https://earthobservatory.nasa.gov/images/82142/global-patterns-of-carbon-dioxide","key":"HAF2n5jl9X"},{"type":"text","value":"). The differences are small, and it seems like global values can be used (see ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DqomCx17HW"},{"type":"link","url":"https://earthobservatory.nasa.gov/blogs/earthmatters/2016/12/05/reader-question-does-co2-disperse-evenly-around-the-earth/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vzYNKux6WT"}],"urlSource":"https://earthobservatory.nasa.gov/blogs/earthmatters/2016/12/05/reader-question-does-co2-disperse-evenly-around-the-earth/","key":"r0ZQrxr1vJ"},{"type":"text","value":"). But I’m choosing here to try to get more nuanced data.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NTRw5CcsAe"}],"key":"YIogQd5ya7"}],"key":"aDM7kMPELL"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KCYLjCynAZ"},{"type":"link","url":"https://www.nature.com/articles/s41597-022-01196-7#Sec5","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://​www​.nature​.com​/articles​/s41597​-022​-01196​-7​#Sec5","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WytcE0MIEi"}],"urlSource":"https://www.nature.com/articles/s41597-022-01196-7#Sec5","key":"Xp1DUNpYbR"},{"type":"text","value":" seems very promising : available at ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KWAwXopEjO"},{"type":"link","url":"https://zenodo.org/records/5021361","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://​zenodo​.org​/records​/5021361","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EJbuCbw4jd"}],"urlSource":"https://zenodo.org/records/5021361","key":"i0zyFAdKpm"},{"type":"text","value":", not too big, allows for local variations in CO2 concentration. Would need to script the download and treatment of the files here. Timestep is monthly, but we can downscale it to daily and still at least have some monthly variation. Goes to 2150, so perfect for our uses.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FGXeCNimBR"}],"key":"Xhhv33gjC4"}],"key":"CTHeXB8Y9E"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Justification for using the dataset :","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wGPvcQDD1B"}],"key":"evaDV5CZco"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We know that this CO2 dataset does not come from the same GCM that generated our climate data, and there could be variability between the variability of climate variables in one dataset versus the climate variables in the models that generated these CO2 estimates at each given timestep.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WNW96UyRLH"}],"key":"gC4ug1dhvq"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"However, We thought it better to use this dataset to approximate CO2 spatial and temporal variations in our simulations rather than using latitudinal or global averages.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Qly9s2l3HH"}],"key":"y3JoImFP4e"}],"key":"CsoMTX5RK1"}],"key":"D80Wqp4ury"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# First, we download the CO2 data from https://zenodo.org/records/5021361 \n\nfrom functionsForCalibration import *\nimport pandas as pd\nimport urllib.request\nimport subprocess\nimport os\n\n# We use the zenodo_get library to download files from Zenodo very fast; other methods tend to be slow.\n# See https://github.com/dvolgyes/zenodo_get . It is installed in the Docker image.\n# WARNING : will take around 1.5GB of space for the data from 1950 to 2150 for a full climate scenario.\n\n# We download the file with historical data\nos.system(\"cd ReferencesAndData \u0026\u0026 zenodo_get 5021361 -g CO2_1deg_month_1850-2013.nc\")\n\n# We can also download data for future conditions, like this :\n# os.system(\"cd ReferencesAndData \u0026\u0026 zenodo_get 5021361 -g CO2_SSP126_2015_2150.nc\")","key":"Tu8TirDjRP"},{"type":"output","id":"MOceX4HKjdQbYABKBAiF4","data":[{"name":"stderr","output_type":"stream","text":"Title: Global monthly distributions of atmospheric CO2 concentrations under the historical and future scenarios\nKeywords: Atmospheric chemistry, Atmospheric dynamics, Climate and Earth system modelling\nPublication date: 2021-06-23\nDOI: 10.5281/zenodo.5021361\nTotal size: 1.0 GB\n\nLink: https://zenodo.org/records/5021361/files/CO2_1deg_month_1850-2013.nc   size: 1.0 GB\n\nChecksum is correct. (b11db6cc374ce23fd41b3b078cc8ebdd)\nAll files have been downloaded.\n"},{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"0","content_type":"text/plain"}}}],"key":"j7LKqHMXQp"}],"key":"PNArEyE9or"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from functionsForCalibration import *\n\nhistorical_ds = xr.open_dataset(\"./ReferencesAndData/CO2_1deg_month_1850-2013.nc\")\n# future_ds = xr.open_dataset(\"./ReferencesAndData/CO2_SSP126_2015_2150.nc\")\n\n# Shapefile to select where we take our values; if several climate cells are in the shapefile,\n# then the CO2 values in all cells will be averaged (see function process_co2_data)\nshapefile = \"./ReferencesAndData/SpatialBoundaries/ChapleauBoundariesClimate.shp\"\n\n# We load the dataframe\n# We prepare the dataframe in a format that matches the older function I made\n# When I was using monthly data and LANDIS-II v7.\n# We load the file created previously\ndf_climate = pd.read_csv(\"./ReferencesAndData/Climate Data/dataFrameClimate_historicalDaily.csv\")\n# Convert to year month day to string\ndf_climate['date_string'] = (df_climate['year'].astype(str) + '-' + \n                     df_climate['month'].astype(str) + '-' + \n                     df_climate['day'].astype(str))\n# Get unique dates\nuniqueDates = df_climate['date_string'].unique()\n# Create the new dataframe\ndfToFill = pd.DataFrame(columns=[\"year\", \"month\", \"day\", \"Variable\"])\n# Put the dates in\ndfToFill[\"date_string\"] = uniqueDates\n# extract the dates correctly\ndfToFill['year'] = dfToFill[\"date_string\"].str.split('-').str[0].astype(int)\ndfToFill['month'] = dfToFill[\"date_string\"].str.split('-').str[1].astype(int)\ndfToFill['day'] = dfToFill[\"date_string\"].str.split('-').str[2].astype(int)\n# Add variable name\ndfToFill[\"Variable\"] = [\"CO2\"] * len(dfToFill)\n# Remove the date_string column\ndfToFill.drop('date_string', axis=1, inplace=True)\ndf_climate.drop('date_string', axis=1, inplace=True)\n# Now, the dataframe is ready to be filled with CO2 values with the old function !\n# print(dfToFill)\n\ndfToFill = process_co2_data(historical_ds, shapefile, dfToFill)\n\n# Display the updated dataframe\nprint(dfToFill.head())\nprint(dfToFill.tail())","key":"VyxG5Hn9Wi"},{"type":"output","id":"_trqKJgitZQwt1X0ubBlR","data":[{"name":"stdout","output_type":"stream","text":"No points found inside the polygon for historical data. Finding closest point...\nClosest point to polygon centroid for historical data: Lon=-83.5, Lat=47.5\n   year  month  day Variable  CO2_Concentration\n0  1950      1    1      CO2         317.369324\n1  1950      1    2      CO2         317.369324\n2  1950      1    3      CO2         317.369324\n3  1950      1    4      CO2         317.369324\n4  1950      1    5      CO2         317.369324\n       year  month  day Variable  CO2_Concentration\n22260  2010     12   27      CO2         399.926788\n22261  2010     12   28      CO2         399.926788\n22262  2010     12   29      CO2         399.926788\n22263  2010     12   30      CO2         399.926788\n22264  2010     12   31      CO2         399.926788\n"}],"key":"l9BF1gTHyx"}],"key":"WVNEWHpo4V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Finally, we add this CO2 data to the previous data, and re-average it if needed\n\n# First, we have to rename the CO2 column in the dataframe we just filled so that it corresponds to an ecoregion now\n# (this is due to the difference in the climate library formats with LANDIS-II v8 and the old functions I was using before switching)\n# The column name CO2_Concentration is created by the function process_co2_data\ndfToFill = dfToFill.rename(columns={'CO2_Concentration': 'eco1'})\n\n# We concatenate the dataframes\ndf_climate = pd.concat([df_climate, dfToFill], ignore_index=True)\n\n# We check if needed\nprint(df_climate)\n\n# We average\ndataFrameClimate_historicalAveraged = transform_to_historical_averages_vectorized(df_climate)\n# We save everything\ndataFrameClimate_historicalAveraged.to_csv(\"./ReferencesAndData/Climate Data/dataFrameClimate_historicalAveraged.csv\", sep=',', index=False, encoding='utf-8')\n\n# Now that everything is done, we can remove the CO2 files downloaded\nos.remove(\"./ReferencesAndData/CO2_1deg_month_1850-2013.nc\")\n# os.remove(\"./ReferencesAndData/CO2_SSP126_2015_2150.nc\")","key":"AwFy9hCYIN"},{"type":"output","id":"lI82JkEF0Ycoia5m0r62Z","data":[{"name":"stdout","output_type":"stream","text":"        year  month  day Variable        eco1\n0       1950      1    1      PAR   37.535774\n1       1950      1    2      PAR  108.757004\n2       1950      1    3      PAR   72.965851\n3       1950      1    4      PAR  110.865730\n4       1950      1    5      PAR   92.960808\n...      ...    ...  ...      ...         ...\n155850  2010     12   27      CO2  399.926788\n155851  2010     12   28      CO2  399.926788\n155852  2010     12   29      CO2  399.926788\n155853  2010     12   30      CO2  399.926788\n155854  2010     12   31      CO2  399.926788\n\n[155855 rows x 5 columns]\n"}],"key":"jp53Sbbpg0"}],"key":"Hn1KBMgVn8"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Soils","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Wqj2gg0LBx"}],"identifier":"soils","label":"Soils","html_id":"soils","implicit":true,"key":"P2E2ViTNif"}],"key":"eqI0R7832K"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Gustafon recommands SILO (Silty Loam/Silt Loam) soil from the default PnET Succession SaxtonAndRawls file (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G7LebaugwL"},{"type":"inlineCode","value":"C:\\Program Files\\LANDIS-II-v7\\extensions\\Defaults\\SaxtonAndRawlsParameters.txt","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wJOicACNIB"},{"type":"text","value":") as a soil that retains water well. This is because the first calibration step should use an “ideal soil” where water is well-retained so that lack of water (or watterlogging) does not influence growth at this calibration step.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fhLuBHTKGb"}],"key":"qMgX8yuaSc"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We can use the SILO soil type easily by modifying the SoilType of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aNVm1t3Ogz"},{"type":"inlineCode","value":"eco1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WdDXD3Dg3q"},{"type":"text","value":" in the PnET One Cell Scenario that we will use (see ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DhVtal3G2V"},{"type":"inlineCode","value":"SimulationFiles/PnETGitHub_OneCellSim_v8/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"S25PbAuRkK"},{"type":"text","value":"). So, nothing more to do here.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DxiZSOQLcW"}],"key":"auJWctrbWD"}],"key":"dHKSclOpEt"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"CLUES FOR FUTURE DATA","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nyEptRKkbJ"}],"identifier":"clues-for-future-data","label":"CLUES FOR FUTURE DATA","html_id":"clues-for-future-data","implicit":true,"key":"wfduaqqPDZ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Alex Chubaty might have scripts to generate initial data in BC and Alberta, and even other provinces ?","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QlM5sQQKQh"}],"key":"g3Vncjt6lE"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Caren Dymonc for initial data in BC ?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Iw6UN2wheB"}],"key":"jVJ3eb79Ds"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Yan Boulanger : BioSIM climate data for small scale/downscaled climate data for PnET + BFOLDS ? Needed so that we can have PnET Climate input that change according to slope and topography in particular. Will need to create many smaller ecoregions that are combo of soils + climate “zones” in the area + classes of slopes/aspect. BioSIM might help in generating those things.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HV4PYA4xf2"}],"key":"nAOrAQBgwp"}],"key":"i47oUVUIaY"}],"key":"GhHav7G6YD"}],"key":"db0UN2OuXj"},"references":{"cite":{"order":["Wang_2021"],"data":{"Wang_2021":{"label":"Wang_2021","enumerator":"1","doi":"10.1029/2020ms002353","html":"Wang, Y., Hsu, H., Chen, C., Tseng, W., Hsu, P., Lin, C., Chen, Y., Jiang, L., Lee, Y., Liang, H., Chang, W., Lee, W., \u0026 Shiu, C. (2021). Performance of the Taiwan Earth System Model in Simulating Climate Variability Compared With Observations and CMIP6 Model Simulations. \u003ci\u003eJournal of Advances in Modeling Earth Systems\u003c/i\u003e, \u003ci\u003e13\u003c/i\u003e(7). \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1029/2020ms002353\"\u003e10.1029/2020ms002353\u003c/a\u003e","url":"https://doi.org/10.1029/2020ms002353"}}}},"footer":{"navigation":{"prev":{"title":"Initial species parameters","url":"/startingcalibrationtest/initial-species-parameters","group":"Calibration of PnET Succession for the DIVERSE project"},"next":{"title":"Other data needed for the calibration process","url":"/startingcalibrationtest/other-important-data-before-starting","group":"Calibration of PnET Succession for the DIVERSE project"}}},"domain":"http://localhost:3000"},"project":{"bibliography":["/calibrationFolder/calibrationJupyterBook_JupyterBookv2/references.bib"],"exports":[],"title":"Calibration of PnET Succession for the DIVERSE project","authors":[{"nameParsed":{"literal":"Clément Hardy, PhD.","given":"PhD.","family":"Clément Hardy"},"name":"Clément Hardy, PhD.","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/Klemet/Calibration_PnET_DIVERSE","toc":[{"file":"intro.md"},{"children":[{"file":"StartingCalibrationTest/1.Loading_functions.ipynb"},{"file":"StartingCalibrationTest/2.Test_sim_functions.ipynb"},{"file":"StartingCalibrationTest/3.Initial_Species_Parameters.ipynb"},{"file":"StartingCalibrationTest/4.Setting_up_calibration_Landscape.ipynb"},{"file":"StartingCalibrationTest/5.Other_important_data_before_starting.ipynb"},{"file":"StartingCalibrationTest/6.Monoculture_ideal_conditions.ipynb"}],"file":"StartingCalibrationTest/Intro_CalibrationTest.ipynb"}],"index":"index","pages":[{"slug":"startingcalibrationtest.intro-calibrationtest","title":"Calibration test","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"startingcalibrationtest.loading-functions","title":"Loading functions and packages","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.test-sim-functions","title":"Making a test simulation to get used to the functions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.initial-species-parameters","title":"Initial species parameters","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.setting-up-calibration-landscape","title":"Setting up the calibration landscape (ecoregions, initial communities, climate etc.)","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/88c4f87a42ed43465897c61d30462b63.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.other-important-data-before-starting","title":"Other data needed for the calibration process","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/Algorithm_GrowthCurv-1fc0881c4e6f16c0991a3c4f2866d3c5.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"startingcalibrationtest.monoculture-ideal-conditions","title":"Phase 1 🌳 : Calibration of species in optimal conditions (monoculture + mesic soil + average and unchanging climate)","description":"","date":"","thumbnail":"https://klemet.github.io/Calibration_PnET_DIVERSE/build/14232857c4e474f60fe4aad7bf85497d.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "https://klemet.github.io/Calibration_PnET_DIVERSE/build/manifest-B2B2E6A5.js";
import * as route0 from "https://klemet.github.io/Calibration_PnET_DIVERSE/build/root-IB5726YR.js";
import * as route1 from "https://klemet.github.io/Calibration_PnET_DIVERSE/build/routes/$-LXLHKVOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("https://klemet.github.io/Calibration_PnET_DIVERSE/build/entry.client-UNPC4GT3.js");</script></body></html>